#VU - Updated by San Felipe for v1.36.2.*
#Victorum Universalis Note -
#There is no way to modify this carefully overriding parts of it.
#File has been documented well and organised to the best of our abilities. Any submods or addons desiring to add their own entries will need to manually update this entirely
#after every VU update. This is out of our hands and there are no suggestions for this.
#Furthermore, this file contains new entries throughout various sections and should not crash the game if said entries have been entered and linked correctly with respective files.
#Many thanks to you all - San Felipe.

# Do not change tags in here without changing every other reference to them.
# If adding new buildings, make sure they are uniquely named.

# cost = x #==> cost in $ to build (subject to other modifiers)
# time = x #==> number of months to build.
# modifier = m # a modifier on the province that the building gives
# trigger = t # an and trigger that needs to be fullfilled to build and keep the building
# one_per_country = yes/no # if yes, only one of these can exist in a country
# manufactory = { trade_good trade_good } # list of trade goods that get a production bonus
# onmap = yes/no # show as a sprite on the map

# FROM = owner
# ROOT = province

# Building AI is now mainly hard-coded. The AI will estimate how much it gains yearly from each building,
# convert the value to ducats, and take the building with biggest yearly return as a percentage of the build cost.
# If lower than 1%, the AI will not consider the yearly return worth it.
# It will also require higher yearly return if the economy in not in prime shape.
# Forts' value also get converted to a yearly return based on terrain and strategic position, as well as available budget for fort maintenance.

# AI can still be modded though; it will multiply the yearly return with the value of ai_will_do.
# If you don't want the AI to build a building at all, make ai_will_do become 0.
# AI will consider each building to be worth 0.01 ducats per year as a base, so making ai_will_do above cost will have them build it at some point.
# It will still check whether it can afford a building before doing so though, but may save up to it.


################################################

### PRODUCTION

#Tier 1 Production - Workshop
workshop = {
	cost = 200 #VU - Kept at 150 to 200 in v1.36.2.* by San Felipe
	time = 12
	#Returned price to 100 due to the production efficiency increase.
	modifier = {
		local_production_efficiency = 0.5 #VU - Lowered to 0.05 in v1.36.2.* by San Felipe
	}

	on_built = {
		add_development_from_building = {
			building = workshop
			type = production
			value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = workshop
			type = production
			value = 1
		}
	}
	on_obsolete = {
	}

	allow_in_gold_provinces = no
	ai_will_do = {
		factor = 10.0
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 200 } }
		}
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 3.0
			base_production = 4
		}
		modifier = {
			factor = 6.0
			base_production = 6
		}
		modifier = {
			factor = 9.0
			base_production = 8
		}
		#FROM TRADE GOODS
		#GENERAL
		#AI is strongly discouraged to build this where climate renders development difficult.
		modifier = {
			factor = 0.2
			OR = {
				has_climate = arctic
				has_climate = arid
				has_climate = tropical
			}
		}
		
		#AI is discouraged to build this where development isn't really feasible.
		modifier = {
			factor = 0.65
			OR = {
				has_terrain = steppe
				has_terrain = highlands
				has_terrain = jungle
				has_terrain = desert
				has_terrain = coastal_desert
				has_terrain = glacier
			}
		}
		
		#Drylands, forest, coastline, marsh, hills, mountains, and savannah receive neither penalty nor bonus.
		
		#AI is encouraged to build this where development is feasible.
		modifier = {
			factor = 1.5
			OR = {
				has_terrain = farmlands
				has_terrain = grasslands
				has_terrain = woods
			}
		}
		
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Economically minded governments are more likely to build workshops... that is rather their mandate, no?
		#		OR = {
		#			government = administrative_monarchy
		#			government = administrative_republic
		#			government = constitutional_republic
		#			government = peasants_republic
		#		}
		#	}
		#}
		
		#HRE was a production powerhouse of this period.
		modifier = {
			factor = 2.0
			is_part_of_hre = yes
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 2 Production - Counting House
counting_house = {
	cost = 400 #VU - Kept at 400 in v1.36.2.* by San Felipe
	time = 24
	#VU AddOn price changed from 400 to 200. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	#VU AddOn time changed from 12 to 24. Doubling upgraded buildings' build time.
	
	make_obsolete = workshop
	modifier = {
		#Modifier is now 75% instead of the EU4 100% or the VU 60%. It should be balanced for the extra provinces of VU while still being worth its price.
		local_production_efficiency = 0.75 #VU - Lowered to 0.075 in v1.36.2.* by San Felipe
	}
	
	on_built = {
		add_development_from_upgrading_or_building = {
			building = counting_house
			obsolete_building = workshop
			type = production
			value = 2
			upgrade_value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = counting_house
			type = production
			value = 2
		}
	}
	on_obsolete = {
	}

	allow_in_gold_provinces = no

	ai_will_do = {
		factor = 4
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_production = 3
		}
		modifier = {
			factor = 3.5
			base_production = 5
		}
		modifier = {
			factor = 6.5
			base_production = 7
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
		
		#GENERAL		
		#AI is strongly discouraged to build this where climate renders development difficult.
		modifier = {
			factor = 0.2
			OR = {
				has_climate = arctic
				has_climate = arid
				has_climate = tropical
			}
		}
		
		#AI is discouraged to build this where development isn't really feasible.
		modifier = {
			factor = 0.65
			OR = {
				has_terrain = steppe
				has_terrain = highlands
				has_terrain = jungle
				has_terrain = desert
				has_terrain = coastal_desert
				has_terrain = glacier
			}
		}
		
		#Drylands, forest, coastline, marsh, hills, mountains, and savannah receive neither penalty nor bonus.
		
		#AI is encouraged to build this where development is feasible.
		modifier = {
			factor = 1.5
			OR = {
				has_terrain = farmlands
				has_terrain = grasslands
				has_terrain = woods
			}
		}
		
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Economically minded governments are more likely to build workshops... that is rather their mandate, no?
		#		OR = {
		#			government = administrative_monarchy
		#			government = administrative_republic
		#			government = constitutional_republic
		#			government = peasants_republic
		#		}
		#	}
		#}
		
		#HRE was a production powerhouse of this period.
		modifier = {
			factor = 2.0
			is_part_of_hre = yes
		}
	}
}

#Tier 3 Production - Treasury
treasury = {
	cost = 600 #VU - Increased from 400 to 600 in v1.36.2.* by San Felipe
	time = 36
	#Same price as the EU4 Counting House.
	
	make_obsolete = counting_house
	modifier = {
		local_production_efficiency = 1.0 #VU - Kept to 0.05 in v1.36.2.* by San Felipe
		#Same modifier as the EU4 Counting House.
	}
	
	on_built = {
		add_development_from_upgrading_or_building = {
			building = treasury
			obsolete_building = counting_house
			type = production
			value = 2
			upgrade_value = 1
		}
	}
	
	on_destroyed = {
		remove_development_from_building = {
			building = treasury
			type = production
			value = 2
		}
	}
	on_obsolete = {
	}

	allow_in_gold_provinces = no

	ai_will_do = {
		factor = 6
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 800 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_production = 3
		}
		modifier = {
			factor = 3.5
			base_production = 5
		}
		modifier = {
			factor = 6.5
			base_production = 7
		}
		
		#GENERAL		
		#AI is strongly discouraged to build this where climate renders development difficult.
		modifier = {
			factor = 0.2
			OR = {
				has_climate = arctic
				has_climate = arid
				has_climate = tropical
			}
		}
		
		#AI is discouraged to build this where development isn't really feasible.
		modifier = {
			factor = 0.65
			OR = {
				has_terrain = steppe
				has_terrain = highlands
				has_terrain = jungle
				has_terrain = desert
				has_terrain = coastal_desert
				has_terrain = glacier
			}
		}
		
		#Drylands, forest, coastline, marsh, hills, mountains, and savannah receive neither penalty nor bonus.
		
		#AI is encouraged to build this where development is feasible.
		modifier = {
			factor = 1.5
			OR = {
				has_terrain = farmlands
				has_terrain = grasslands
				has_terrain = woods
			}
		}
		
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Economically minded governments are more likely to build workshops... that is rather their mandate, no?
		#		OR = {
		#			government = administrative_monarchy
		#			government = administrative_republic
		#			government = constitutional_republic
		#			government = peasants_republic
		#		}
		#	}
		#}
		
		#HRE was a production powerhouse of this period.
		modifier = {
			factor = 2.0
			is_part_of_hre = yes
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

#Tier 4 Production - Factory 
factory = {
	cost = 800 #VU - Kept at 800 in v1.36.2.* by San Felipe
	time = 48
	#Factories are expensive and take a long time to build because they're the last tier of the production category and are quite powerful (as they should be).
	
	make_obsolete = treasury
	modifier = {
		local_production_efficiency = 1.5
		#Factories had a massive impact on production (Industrial Revolution) so they're represented by having a huge modifier.
	}
	
	on_built = {
		add_development_from_upgrading_or_building = {
			building = factory
			obsolete_building = treasury
			type = production
			value = 2
			upgrade_value = 1
		}
	}
	
	on_destroyed = {
		remove_development_from_building = {
			building = factory
			type = production
			value = 2
		}
	}
	on_obsolete = {
	}

	allow_in_gold_provinces = no

	ai_will_do = {
		factor = 9
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 1600 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_production = 3
		}
		modifier = {
			factor = 3.5
			base_production = 5
		}
		modifier = {
			factor = 6.5
			base_production = 7
		}
		
		#GENERAL		
		#AI is strongly discouraged to build this where climate renders development difficult.
		modifier = {
			factor = 0.2
			OR = {
				has_climate = arctic
				has_climate = arid
				has_climate = tropical
			}
		}
		
		#AI is discouraged to build this where development isn't really feasible.
		modifier = {
			factor = 0.65
			OR = {
				has_terrain = steppe
				has_terrain = highlands
				has_terrain = jungle
				has_terrain = desert
				has_terrain = coastal_desert
				has_terrain = glacier
			}
		}
		
		#Drylands, forest, coastline, marsh, hills, mountains, and savannah receive neither penalty nor bonus.
		
		#AI is encouraged to build this where development is feasible.
		modifier = {
			factor = 1.5
			OR = {
				has_terrain = farmlands
				has_terrain = grasslands
				has_terrain = woods
			}
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
		
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Economically minded governments are more likely to build workshops... that is rather their mandate, no?
		#		OR = {
		#			government = administrative_monarchy
		#			government = administrative_republic
		#			government = constitutional_republic
		#			government = peasants_republic
		#		}
		#	}
		#}
		
		#Removed HRE factor since historically it was abolished in the start of the 19th century.
		#It could be replaced by a United Kingdom (2.0), Netherlands (1.75), Germany (1.75) and France (1.5) bonus since they became industrial powerhouses at the time.
		#modifier = {
		#	factor = 2.0
		#	is_part_of_hre = yes
		#}
	}
}

################################################

### TRADE

#Tier 1 Trade - Marketplace
marketplace = {
	cost = 200 #VU - Increased from 100 to 200 in v1.36.2.* by San Felipe
	time = 12
	
	modifier = {
		province_trade_power_modifier = 0.5
		#VU AddOn changed from 0.5. A 50% bonus available at practically day 1 was overpowered, and it snowballed for Centers of Trade.
		#While we still want CoTs strong, we don't want them x15 stronger than any other province this early
		#VU's 
		#lower avg dev but generally same dev for capitals and CoTs only made this worse, as well.
	}

	on_built = {
		add_development_from_building = {
			building = marketplace
			type = production
			value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = marketplace
			type = production
			value = 1
		}
	}

	on_construction_started = { } #Fires when you start the construction,  ROOT - Province FROM - Country that started
	on_construction_canceled = { } #Fires when you cancel the construction, ROOT - Province FROM - Country that canceled

	on_obsolete = {
	}

	ai_will_do = {
		factor = 1.5 # Because hard-coded AI only considers what it will gain, not what its enemies will lose.
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 200 } }
		}
		
		#SPECIFIC
		#AI less likely to build if there isn't a center of trade
		modifier = {
			factor = 0.5
			NOT = { province_has_center_of_trade_of_level = 1 }
		}
		
		#AI more likely to build if there is a center of trade
		modifier = {
			factor = 10
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30
			province_has_center_of_trade_of_level = 3
		}
		#AI more likely to build if there is a river estuary
		modifier = {
			factor = 5.0
			has_river_estuary_trigger = yes
		}
		#GENERAL
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note 25 is base for several mercantile nations like England, so some will start with this, and many more reach it later.
		modifier = {
			factor = 0.65
			NOT = { FROM = { mercantilism = 25 } }
		}
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note England can hit 40s by the late 1400s with some luck, so this isn't so high.
		modifier = {
			factor = 1.5
			FROM = { mercantilism = 40 }
		}
		#Trade leagues and merchant republics will get more trade buildings... that is rather their mandate, no?
		modifier = {
			factor = 2.0
			FROM = {
				OR = {
					is_in_trade_league = yes
					has_government_attribute = is_merchant_republic
					has_reform = trading_city
					has_reform = veche_republic
				}
			}
		}
		#Just to encourage a bit of English Channel node competition. Dutch society flourished on trade in this period.
		modifier = {
			factor = 2.0
			FROM = { primary_culture = dutch }
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

#Tier 2 Trade - Trade Depot
trade_depot = {
	cost = 400 #VU - Increased from 300 to 400 in v1.36.2.* by San Felipe
	time = 24
	#VU AddOn price changed from 300.
	#VU AddOn time changed from 12. Doubling upgraded buildings' build time.
	
	make_obsolete = marketplace

	modifier = {
		province_trade_power_modifier = 0.75
		#VU AddOn changed from 1.0, for reasons explained in market entry.
	}

	on_built = {
		add_development_from_upgrading_or_building = {
			building = trade_depot
			obsolete_building = marketplace
			type = production
			value = 2
			upgrade_value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = trade_depot
			type = production
			value = 2
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 1.5 # Because hard-coded AI only considers what it will gain, not what its enemies will lose.
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		#SPECIFIC
		#AI less likely to build if there isn't a center of trade
		modifier = {
			factor = 0.5
			NOT = { province_has_center_of_trade_of_level = 1 }
		}
		#AI more likely to build if there is a center of trade
		modifier = {
			factor = 10.0
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20.0
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30.0
			province_has_center_of_trade_of_level = 1
		}
		#AI more likely to build if there is a river estuary
		modifier = {
			factor = 5.0
			has_river_estuary_trigger = yes
		}
		#GENERAL		
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note 25 is base for several mercantile nations like England, so some will start with this, and many more reach it later.
		modifier = {
			factor = 0.65
			NOT = { FROM = { mercantilism = 25 } }
		}
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note England can hit 40s by the late 1400s with some luck, so this isn't so high.
		modifier = {
			factor = 1.5
			FROM = { mercantilism = 40 }
		}
		#Trade leagues and merchant republics will get more trade buildings... that is rather their mandate, no?
		modifier = {
			factor = 2.0
			FROM = {
				OR = {
					is_in_trade_league = yes
					has_government_attribute = is_merchant_republic
					has_reform = trading_city
					has_reform = veche_republic
				}
			}
		}
		#Just to encourage a bit of English Channel node competition. Dutch society flourished on trade in this period.
		modifier = {
			factor = 2.0
			FROM = { primary_culture = dutch }
		}
	}
}

#Tier 3 Trade - Stock Exchange
stock_exchange = {
	cost = 600 #VU - Increased from 400 to 600 in v1.36.2.* by San Felipe
	time = 36

	#VU AddOn time changed from 12. Tripling stock exchange build time, as a doubled upgraded building.
	make_obsolete = trade_depot

	modifier = {
		province_trade_power_modifier = 1.0
	}

	on_built = {
		if = {
			limit = {
				has_province_flag = built_dev_trade_depot
			}
			add_development_from_upgrading_or_building = {
				building = stock_exchange
				obsolete_building = trade_depot
				type = production
				value = 3
				upgrade_value = 1
			}
		}
		else_if = {
			limit = {
				has_province_flag = built_dev_marketplace
			}
			add_development_from_upgrading_or_building = {
				building = stock_exchange
				obsolete_building = marketplace
				type = production
				value = 3
				upgrade_value = 2
			}
		}
		else = {
			add_development_from_building = {
				building = stock_exchange
				type = production
				value = 3
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = stock_exchange
			type = production
			value = 3
		}
	}
	on_obsolete = {
	}
	ai_will_do = {
		factor = 6
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 800 } }
		}
		#SPECIFIC
		#AI less likely to build if there isn't a center of trade
		modifier = {
			factor = 0.5
			NOT = { province_has_center_of_trade_of_level = 1 }
		}
		#AI more likely to build if there is a center of trade
		modifier = {
			factor = 10.0
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20.0
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30.0
			province_has_center_of_trade_of_level = 1
		}
		#AI more likely to build if there is a river estuary
		modifier = {
			factor = 5.0
			has_river_estuary_trigger = yes
		}
		#GENERAL	
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note 25 is base for several mercantile nations like England, so some will start with this, and many more reach it later.
		modifier = {
			factor = 0.65
			NOT = { FROM = { mercantilism = 25 } }
		}
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note England can hit 40s by the late 1400s with some luck, so this isn't so high.
		modifier = {
			factor = 1.5
			FROM = { mercantilism = 40 }
		}
		#Trade leagues and merchant republics will get more trade buildings... that is rather their mandate, no?
		modifier = {
			factor = 2.0
			FROM = {
				OR = {
					is_in_trade_league = yes
					has_government_attribute = is_merchant_republic
					has_reform = trading_city
					has_reform = veche_republic
				}
			}
		}
		#Just to encourage a bit of English Channel node competition. Dutch society flourished on trade in this period.
		modifier = {
			factor = 2.0
			FROM = { primary_culture = dutch }
		}
	}
}

#Tier 4 Trade - Corporative Headquarters
corporative_headquarters = {
	cost = 800 #VU - Kept at 800 in v1.36.2.* by San Felipe
	time = 48
	make_obsolete = stock_exchange
	modifier = {
		province_trade_power_modifier = 1.5
		#VU AddOn changed from 1.25. While earlier levels were weaker than vanilla, I'm increasing the final level, because by this tech level, the centres of wealth should be pulling a massive slice of the wealth in a node, and the many new provinces will have had plenty chance to build up and compete with the capitals much more than in vanilla.
	}
	on_built = {
	    if = {
			limit = {
				has_province_flag = built_dev_stock_exchange
			}
			add_development_from_upgrading_or_building = {
				building = corporative_headquarters
				obsolete_building = stock_exchange
				type = production
				value = 4
				upgrade_value = 2
			}
		}
		if = {
			limit = {
				has_province_flag = built_dev_trade_depot
			}
			add_development_from_upgrading_or_building = {
				building = corporative_headquarters
				obsolete_building = trade_depot
				type = production
				value = 4
				upgrade_value = 2
			}
		}
		else_if = {
			limit = {
				has_province_flag = built_dev_marketplace
			}
			add_development_from_upgrading_or_building = {
				building = corporative_headquarters
				obsolete_building = marketplace
				type = production
				value = 4
				upgrade_value = 3
			}
		}
		else = {
			add_development_from_building = {
				building = corporative_headquarters
				type = production
				value = 4
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = corporative_headquarters
			type = production
			value = 4
		}
	}
	on_obsolete = {
	}
	ai_will_do = {
		factor = 9
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 1600 } }
		}
		#SPECIFIC
		#AI less likely to build if there isn't a center of trade
		modifier = {
			factor = 0.5
			NOT = { province_has_center_of_trade_of_level = 1 }
		}
		#AI more likely to build if there is a center of trade
		modifier = {
			factor = 10.0
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20.0
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30.0
			province_has_center_of_trade_of_level = 1
		}
		#AI more likely to build if there is a river estuary
		modifier = {
			factor = 5.0
			has_river_estuary_trigger = yes
		}
		#GENERAL		
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note 25 is base for several mercantile nations like England, so some will start with this, and many more reach it later.
		modifier = {
			factor = 0.65
			NOT = { FROM = { mercantilism = 25 } }
		}
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note England can hit 40s by the late 1400s with some luck, so this isn't so high.
		modifier = {
			factor = 1.5
			FROM = { mercantilism = 40 }
		}
		#Trade leagues and merchant republics will get more trade buildings... that is rather their mandate, no?
		modifier = {
			factor = 2.0
			FROM = {
				OR = {
					is_in_trade_league = yes
					has_government_attribute = is_merchant_republic
					has_reform = trading_city
					has_reform = veche_republic
				}
			}
		}
		#Just to encourage a bit of English Channel node competition. Dutch society flourished on trade in this period.
		modifier = {
			factor = 2.0
			FROM = { primary_culture = dutch }
		}
	}
}

################################################

### ARMY

#Tier 1 Army - Barracks
barracks = {
	cost = 150 #VU - Increased from 100 to 150 in v1.36.2.* by San Felipe
	time = 12
	modifier = {
		local_manpower_modifier = 0.25
		#VU AddOn changed from 0.5. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	}
	on_built = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_manpower = 1
			}
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = 0.001
			}
		}
		add_development_from_building = {
			building = barracks
			type = manpower
			value = 1
		}
		update_improved_military_buildings_modifier = {
			building = barracks				   
		}
	}
	on_destroyed = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_manpower = -1
			}
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = -0.001
			}
		}
		remove_development_from_building = {
			building = barracks
			type = manpower
			value = 1
		}
		update_improved_military_buildings_modifier = {
			building = barracks
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 4.5
        #ECONOMY 101
        #AI avoids building with loans
   		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 3.0
			base_manpower = 4
		}
		modifier = {
			factor = 6.0
			base_manpower = 6
		}
		modifier = {
			factor = 9.0
			base_manpower = 8
		}
		#FROM TRADE GOODS
		#GENERAL
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 0.5
			NOT = { FROM = { army_tradition = 20 } }
		}
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 40 } }
		}
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 1.2
			FROM = { army_tradition = 60 }
		}
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 1.5
			FROM = { army_tradition = 80 }
		}
		#Further encouraged if low on manpower
		modifier = {
			factor = 1.2
			NOT = { owner = { manpower_percentage = 0.35 } }
		}
		#Slightly discouraged if plenty of manpower
		modifier = {
			factor = 0.9
			owner = { manpower_percentage = 0.8 }
		}
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Military minded governments are more likely to build barracks... that is rather their mandate, no?
		#		OR = {
		#			government = feudal_monarchy
		#			government = enlightened_despotism
		#			government = revolutionary_empire
		#			government = steppe_horde
		#		}
		#	}
		#}
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		modifier = {
			factor = 0.65
			is_state = no
		}
		modifier = {
			factor = 10.0
			FROM = {
				treasury = 17500
			}
		}
	}
}

#Tier 2 Army - Training Fields
training_fields = {
	cost = 300 #VU - Kept at 300 in v1.36.2.* by San Felipe
	time = 24

	#VU AddOn price changed from 300. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	#VU AddOn time changed from 12. Doubling second level military buildings build time.
    make_obsolete = barracks

	modifier = {
		local_manpower_modifier = 0.5
		#VU AddOn changed from 1.0. Part of the comprehensive balance overhaul to adjust buildings to the VU  map (with all its new provinces).
	}
	
	on_built = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_manpower = 1
			}
		}
		add_development_from_upgrading_or_building = {
			building = training_fields
			obsolete_building = barracks
			type = manpower
			value = 2
			upgrade_value = 1
		}
		update_improved_military_buildings_modifier = {
			building = training_fields
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = 0.001
			}
		}
	} 
	on_destroyed = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_manpower = -1
			}
		}
		update_improved_military_buildings_modifier = {
			building = training_fields
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = -0.001
			}
		}
		remove_development_from_building = {
			building = training_fields
			type = manpower
			value = 2
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 160
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		modifier = {
			factor = 10.0
			FROM = {
				treasury = 17500
			}
		}
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 1.5
			base_manpower = 3
		}
		modifier = {
			factor = 3.5
			base_manpower = 5
		}
		modifier = {
			factor = 6.5
			base_manpower = 7
		}
		#GENERAL		
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 0.5
			NOT = { FROM = { army_tradition = 20 } }
		}
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 40 } }
		}
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 1.2
			FROM = { army_tradition = 60 }
		}
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 1.5
			FROM = { army_tradition = 80 }			
		}
		#Further encouraged if low on manpower
		modifier = {
			factor = 1.2
			NOT = { owner = { manpower_percentage = 0.35 } }
		}
		#Slightly discouraged if plenty of manpower
		modifier = {
			factor = 0.9
			owner = { manpower_percentage = 0.8 }
		}
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Military minded governments are more likely to build barracks... that is rather their mandate, no?
		#		OR = {
		#			government = feudal_monarchy
		#			government = enlightened_despotism
		#			government = revolutionary_empire
		#			government = steppe_horde
		#		}
		#	}
		#}
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		modifier = {
			factor = 0.65
			is_state = no
		}
	}
}

#Tier 1 Army - Regimental Camp
regimental_camp = {
	cost = 150 #VU - Decreased from 200 to 150 in v1.36.2.* by San Felipe
	time = 12
	modifier = {
		land_forcelimit = 0.5
		#VU AddOn changed from 1.0. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
		regiment_recruit_speed = -0.125
		#VU AddOn new. Adding this new feature to match the shipyard equivalents, which also speed recruit time.
	}
	#VU AddOn changed from 200. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces)
	on_built = {
		add_development_from_building = {
			building = regimental_camp
			type = manpower
			value = 1
		}
		update_improved_military_buildings_modifier = {
			building = regimental_camp
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = 0.001
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = regimental_camp
			type = manpower
			value = 1
		}
		update_improved_military_buildings_modifier = {
			building = regimental_camp
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = -0.001
			}
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 60

		#Better AI Economy
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		#GENERAL
		#Running total 72
		modifier = {
			factor = 1.2
			FROM = { army_size_percentage = 0.75 }
		}
		#Running total 93.6
		modifier = {
			factor = 1.5 # more likely if we have an army close to the force limit
			FROM = { army_size_percentage = 0.95 }
		}
		#Running total 131.04
		modifier = {
			factor = 1.4
			FROM = { army_size_percentage = 1.25 }
		}
		#Running total 196.56
		modifier = {
			factor = 1.5			
			FROM = { army_size_percentage = 1.5 }
		}
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 0.75
			NOT = { FROM = { army_tradition = 20 } }
		}
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 0.9
			NOT = { FROM = { army_tradition = 40 } }
		}
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 60 }			
		}
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 1.25
			FROM = { army_tradition = 80 }			
		}
		#Heavy handed attempt to encourage historical miltary powers
		modifier = {
			factor = 1.5
			FROM = {
				OR = {
					culture_group = french			#The great blue blob
					primary_culture = prussian			#Punched massively above its weight during this period
					primary_culture = saxon			#Punched massively above its weight during this period
					primary_culture = pommeranian			#Punched massively above its weight during this period
					primary_culture = austrian			#Somehow resisted the Ottomans and largely kept the empire together
					primary_culture = swedish			#Punched above its weight during this period
					primary_culture = turkish			#The great green blob
					#Other cultures around the world might deserve this as well, but this is -Europa- Universalis, so I'm only focusing on Europe and environs for now
				}
			}
		}
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		
		modifier = {
			factor = 0.65
			is_state = no
		}
		#AI army size (force limit) gets way too big in the late-game, so the AI should avoiding building these if they have a large army.
		modifier = {
			factor = 0.75
			owner = { land_forcelimit = 250 }
		}
		modifier = {
			factor = 0.5
			owner = { land_forcelimit = 375 }
		}
		modifier = {
			factor = 0.25
			owner = { land_forcelimit = 500 }
		}
		modifier = {
			factor = 0.125
			owner = { land_forcelimit = 625 }
		}
		modifier = {
			factor = 0.0
			owner = { land_forcelimit = 750 }
		}
		modifier = {
			factor = 1.1
			local_autonomy = 50
		}
		modifier = {
			factor = 10.0
			FROM = {
				treasury = 17500
			}
		}
	}
}

#Tier 2 Army - Conscription Center
conscription_center = {
	cost = 300 #VU - Decreased from 400 to 300 in v1.36.2.* by San Felipe
	time = 24

	#VU AddOn price changed from 400. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	#VU AddOn time changed from 12. Doubling second level military buildings build time.
	make_obsolete = regimental_camp

	modifier = {
		land_forcelimit = 1
		#VU AddOn changed from 2.0. Part of the comprehensive balance overhaul to adjust buildings to the VU  map (with all its new provinces).
		regiment_recruit_speed = -0.25
		#VU AddOn new. Adding this new feature to match the shipyard equivalents, which also speed recruit time.
	}
	#THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
	on_built = {
		add_development_from_upgrading_or_building = {
			building = conscription_center
			obsolete_building = regimental_camp
			type = manpower
			value = 2
			upgrade_value = 1
		}
		update_improved_military_buildings_modifier = {
			building = conscription_center
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = 0.001
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = conscription_center
			type = manpower
			value = 2
		}
		update_improved_military_buildings_modifier = {
			building = conscription_center
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = -0.001
			}
		}
	}
	on_obsolete = {
	}
	
	ai_will_do = {
		factor = 180
		#Better AI Economy
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
		modifier = {
			factor = 1.5 # more likely if we have an army close to the force limit
			FROM = { army_size_percentage = 0.95 }
		}
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		#GENERAL		
		#Running total 216
		modifier = {
			factor = 1.2			
			FROM = { army_size_percentage = 0.75 }
		}
		#Running total 280.8
		modifier = {
			factor = 1.3			
			FROM = { army_size_percentage = 1.0 }
		}
		#Running total 393.12
		modifier = {
			factor = 1.4			
			FROM = { army_size_percentage = 1.25 }
		}
		#Running total 589.68
		modifier = {
			factor = 1.5			
			FROM = { army_size_percentage = 1.5 }
		}
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 0.75
			NOT = { FROM = { army_tradition = 20 } }			
		}
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 0.9
			NOT = { FROM = { army_tradition = 40 } }			
		}
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 60 }			
		}
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 1.25
			FROM = { army_tradition = 80 }			
		}
		#Heavy handed attempt to encourage historical miltary powers
		modifier = {
			factor = 1.5
			FROM = {
				OR = {			
					culture_group = french			#The great blue blob
					primary_culture = prussian			#Punched massively above its weight during this period
					primary_culture = saxon			#Punched massively above its weight during this period
					primary_culture = pommeranian			#Punched massively above its weight during this period
					primary_culture = austrian			#Somehow resisted the Ottomans and largely kept the empire together
					primary_culture = swedish			#Punched above its weight during this period
					primary_culture = turkish			#The great green blob
					#Other cultures around the world might deserve this as well, but this is -Europa- Universalis, so I'm only focusing on Europe and environs for now
				}
			}
		}
		modifier = {
			factor = 0.65
			is_state = no
		}
		#AI army size (force limit) gets way too big in the late-game, so the AI should avoiding building these if they have a large army.
		modifier = {
			factor = 0.75
			owner = { land_forcelimit = 250 }
		}
		modifier = {
			factor = 0.5
			owner = { land_forcelimit = 375 }
		}
		modifier = {
			factor = 0.25
			owner = { land_forcelimit = 500 }
		}
		modifier = {
			factor = 0.125
			owner = { land_forcelimit = 625 }
		}
		modifier = {
			factor = 0.0
			owner = { land_forcelimit = 750 }
		}
		modifier = {
			factor = 10.0
			FROM = {
				treasury = 17500
			}
		}
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 1.1
			local_autonomy = 50
		}
	}
}
################################################

### Navy

#Tier 1 Navy - Shipyard
shipyard = {
	cost = 150 #VU - Increased from 100 to 150 in v1.36.2.* by San Felipe
	time = 12
	#VU AddOn notes - leaving cost here despite lowering most others. Dramtically improving naval capabilities was a bit overpowered, in my opinion.
	#Especially compared to the regimental camp with half effect at double the price.
	build_trigger = {
		has_port = yes
		if = {
			limit = { 
				FROM = { 
					ai = yes 
				} 
			}
			FROM = { 
				NOT = { 
					num_of_loans = 4 
				} 
			}
		}
	}

	modifier = {
		tax_income = 1
		ship_recruit_speed = -0.25
		local_ship_repair = 0.25
		local_has_man_of_war = yes
		local_has_galleass = yes
		#Moved naval_forcelimit to dock and drydock since faster build and repair speed already makes this building worthwhile.
	}
	on_built = {
		add_development_from_building = {
			building = shipyard
			type = production
			value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = shipyard
			type = production
			value = 1
		}
		if = {
			limit = { has_province_modifier = sca_swe_danish_shipyard }
			remove_province_modifier = sca_swe_danish_shipyard
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 60
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 400 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1000 }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0
			FROM = {
				NOT = { navy_size_percentage = 0.9 }
			}
		}
		#GENERAL
		#VU AddOn removed navy size modifier below, replaced with a more detailed version in new factors
		#modifier = {
		#	factor = 105 # Little above build cost
		#	FROM = { navy_size_percentage = 0.95 }
		#}
		#VU AddOn removed autonomy modifier below
		#modifier = {
		#	factor = 1.1
		#	local_autonomy = 50
		#}
		#VU Addon New factors, range 40 percent to 676 percent (replacing vanilla 100 percent to 11,550). I'm assuming from vanilla's high factor that the AI doesn't consider forcelimits as valuable, but if you start seeing too many or too few, please do report.
		#Running total 72
		modifier = {
			factor = 1.2			
			FROM = { navy_size_percentage = 0.75 }
		}
		#Running total 93.6
		modifier = {
			factor = 1.3			
			FROM = { navy_size_percentage = 1.0 }
		}
		#Running total 131.04
		modifier = {
			factor = 1.4			
			FROM = { navy_size_percentage = 1.25 }
		}
		#Running total 196.56
		modifier = {
			factor = 1.5			
			FROM = { navy_size_percentage = 1.5 }
		}
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 0.75
			NOT = { FROM = { navy_tradition = 20 } }			
		}
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 0.9
			NOT = { FROM = { navy_tradition = 40 } }			
		}
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 1.1
			FROM = { navy_tradition = 60 }			
		}
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 1.25
			FROM = { navy_tradition = 80 }			
		}
		#Heavy handed attempt to encourage historical naval powers
		modifier = {
			factor = 1.5
			FROM = {
				OR = {			
					culture_group = british			#The second empire on which the sun never sets
					culture_group = iberian			#The first empire on which the sun never sets
					primary_culture = dutch			#Punched massively above its weight on the sea during this period
					primary_culture = venetian			#Remnants of Mediterranean hegemonies and great naval traditions
					primary_culture = ligurian			#Remnants of Mediterranean hegemonies and great naval traditions
				}
			}
		}
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			FROM = { num_of_ports = 5 }
		}
		modifier = {
			factor = 6.0
			FROM = { num_of_ports = 10 }
		}
		modifier = {
			factor = 9.0
			FROM = { num_of_ports = 15 }
		}
		modifier = {
			factor = 10.0
			NOT = { development = 7 }
		}
		#BUILDINGS
		modifier = {
			factor = 0.65
			is_state = no
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 2 Navy - Training Fields
grand_shipyard = {
	cost = 300 #VU - Kept at 300 in v1.36.2.* by San Felipe
	time = 24
	
	make_obsolete = shipyard

	build_trigger = {
		has_port = yes
	}
	modifier = {
		tax_income = 2
		ship_recruit_speed = -0.50
		local_ship_repair = 0.50
		local_has_man_of_war = yes
		local_has_galleass = yes
		#Moved naval_forcelimit to dock and drydock since faster build and repair speed already makes this building worthwhile.		
	}
	
	on_built = {
		add_development_from_upgrading_or_building = {
			building = grand_shipyard
			obsolete_building = shipyard
			type = production
			value = 2
			upgrade_value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = grand_shipyard
			type = production
			value = 2
		}
		if = {
			limit = { has_province_modifier = sca_swe_danish_shipyard }
			remove_province_modifier = sca_swe_danish_shipyard
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 180
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1200 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 2000 }
		}
		#GENERAL
		#Running total 216
		modifier = {
			factor = 1.2			
			FROM = { navy_size_percentage = 0.75 }
		}
		#Running total 280.8
		modifier = {
			factor = 1.3			
			FROM = { navy_size_percentage = 1.0 }
		}
		#Running total 393.12
		modifier = {
			factor = 1.4			
			FROM = { navy_size_percentage = 1.25 }
		}
		#Running total 589.68
		modifier = {
			factor = 1.5			
			FROM = { navy_size_percentage = 1.5 }
		}
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 0.75
			NOT = { FROM = { navy_tradition = 20 } }			
		}
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 0.9
			NOT = { FROM = { navy_tradition = 40 } }			
		}
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 1.1
			FROM = { navy_tradition = 60 }			
		}
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 1.25
			FROM = { navy_tradition = 80 }			
		}
		#Heavy handed attempt to encourage historical naval powers
		modifier = {
			factor = 1.5
			FROM = {
				OR = {			
					culture_group = british			#The second empire on which the sun never sets
					culture_group = iberian			#The first empire on which the sun never sets
					primary_culture = dutch			#Punched massively above its weight on the sea during this period
					primary_culture = venetian			#Remnants of Mediterranean hegemonies and great naval traditions
					primary_culture = ligurian			#Remnants of Mediterranean hegemonies and great naval traditions
				}
			}
		}
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			is_state = no
		}
		modifier = {
			factor = 1.5 # bit more likely if close to the force limit
			FROM = { navy_size_percentage = 0.95 }
		}
		modifier = {
			factor = 1.1
			local_autonomy = 50
		}
	}
}

#Tier 1 Navy - Dock
dock = {
	cost = 150 #VU - Increased from 100 to 150 in v1.36.2.* by San Felipe
	time = 12
	#Increased cost back to 100 because of the additional naval_forcelimit modifier	
	build_trigger = {
		has_port = yes
	}
	modifier = {
		province_trade_power_modifier = 0.1
		trade_goods_size_modifier = 0.025
		naval_forcelimit = 0.5
		local_sailors_modifier = 0.5
		local_has_man_of_war = yes
		local_has_galleass = yes
	}
	
	on_built = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_sailors = 200
			}
		}
		add_development_from_building = {
			building = dock
			type = production
			value = 1
		}
	}

	on_destroyed = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_sailors = -200
			}
		}
		remove_development_from_building = {
			building = dock
			type = production
			value = 1
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
	    factor = 20
		modifier = {
			current_age = age_of_discovery 
			owner = { NOT = { navy_size = 25 } }
			factor = 0.25
		}
		modifier = {
			current_age = age_of_reformation
			owner = { NOT = { navy_size = 50 } }
			factor = 0.35
		}
		modifier = {
			current_age = age_of_absolutism
			owner = { NOT = { navy_size = 75 } }
			factor = 0.5
		}
		modifier = {
			current_age = age_of_revolutions 
			owner = { NOT = { navy_size = 100 } }
			factor = 0.75
		}
		modifier = {
			current_age = age_of_change 
			owner = { NOT = { navy_size = 200 } }
			factor = 1
		}
		modifier = {
			owner = {
				OR = {
					full_idea_group = naval_ideas
					has_idea_group = maritime_ideas
				}
			}
			factor = 1.25
		}
		modifier = {
			owner = {
				capital_scope = { 
					has_port = yes 
					is_island = yes 
				}
			}
			factor = 1.35
		}
		modifier = {
			owner = {
				sailors_percentage = 0.75 
			}
			factor = 0
		}
		#Better AI Economy
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		#GENERAL
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 0.5
			NOT = { FROM = { navy_tradition = 20 } }			
		}
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 0.8
			NOT = { FROM = { navy_tradition = 40 } }			
		}
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 1.2
			FROM = { navy_tradition = 60 }			
		}
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 1.5
			FROM = { navy_tradition = 80 }			
		}
		#Further encouraged if low on sailors
		modifier = {
			factor = 1.2
			NOT = { owner = { sailors_percentage = 0.35 } }			
		}
		#Slightly discouraged if plenty of sailors
		modifier = {
			factor = 0.9
			owner = { sailors_percentage = 0.8 }			
		}
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		modifier = {
			factor = 0.65
			is_state = no
		}
		modifier = {
			factor = 10.0
			FROM = {
				treasury = 17500
			}
		}
	}
}

#Tier 2 Navy - Drydock
drydock = {
	cost = 300 #VU - Kept at 300 in v1.36.2.* by San Felipe
	time = 24

	#VU AddOn cost changed from 300. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces)
	#VU AddOn time changed from 12. Doubling second level military buildings build time.
	make_obsolete = dock

	build_trigger = {
		has_port = yes
	}

	modifier = {
		province_trade_power_modifier = 0.2
		trade_goods_size_modifier = 0.05
	    naval_forcelimit = 1
		local_sailors_modifier = 1.0
		local_has_man_of_war = yes
		local_has_galleass = yes
	}
	
	on_built = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_sailors = 200
			}
		}
		add_development_from_upgrading_or_building = {
			building = drydock
			obsolete_building = dock
			type = production
			value = 2
			upgrade_value = 1
		}
	}
	
	on_destroyed = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_sailors = -200
			}
		}
		remove_development_from_building = {
			building = drydock
			type = production
			value = 2
		}
	}
	on_obsolete = {
	}


	ai_will_do = {
		factor = 80
		#Better AI Economy
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		#GENERAL		
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 0.5
			NOT = { FROM = { navy_tradition = 20 } }			
		}
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 0.8
			NOT = { FROM = { navy_tradition = 40 } }			
		}
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 1.2
			FROM = { navy_tradition = 60 }			
		}
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 1.5
			FROM = { navy_tradition = 80 }			
		}
		#Further encouraged if low on sailors
		modifier = {
			factor = 1.2
			NOT = { owner = { sailors_percentage = 0.35 } }			
		}
		#Slightly discouraged if plenty of sailors
		modifier = {
			factor = 0.9
			owner = { sailors_percentage = 0.8 }			
		}
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		modifier = {
			factor = 0.65
			is_state = no
		}
		modifier = {
			factor = 10.0
			FROM = {
				treasury = 17500
			}
		}
	}
}

################################################

### GOVERNMENT

#Tier 1 Government - Courthouse
courthouse = { 
	cost = 750 #VU - Increased to 750 in v1.36.2.* by San Felipe
	time = 12
	#Changed price back to 100 to avoid AI building this when it doesn't need to.
	#VU 13 added to balance states territories and tradecompanies.
	build_trigger = { 
		is_state = yes
	}
	modifier = {
		local_autonomy = -0.05
		local_governing_cost = -0.25
		allowed_num_of_buildings = 1
	}
	on_built = {
		add_development_from_building = {
			building = courthouse
			type = tax
			value = 1
		}
		if = { 
			limit = { 
				FROM = { has_country_flag = fra_courthouse_bonus_flag }
			}
			add_province_modifier = {
				name = fra_improved_court_houses_modifier
				duration = -1 
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = courthouse
			type = tax
			value = 1
		}
		remove_province_modifier = fra_improved_court_houses_modifier
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 15
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
        	modifier = {
			factor = 0
			area_for_scope_province = {
				is_capital_of = FROM
			}
		}
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		#SPECIFIC
		#AI less likely to build in provinces with low development
		modifier = {
			factor = 0.5
			NOT = { development = 6	}			
		}
        #AI more likely to build in provinces with high development
        modifier = {
            factor = 2.5
            development = 15
        }
        modifier = {
            factor = 2.5
            development = 21
        }
        modifier = {
            factor = 2.5
            development = 30
        }
		#AI less likely to build if autonomy is too low
		modifier = {
			factor = 0.75
			NOT = { local_autonomy = 10 }			
		}
		modifier = {
			factor = 0.25
			num_free_building_slots = 2
		}
		#FROM AUTONOMY
		modifier = {
			factor = 1.5
			local_autonomy = 25
		}
		modifier = {
			factor = 3.0
			local_autonomy = 50
		}
		modifier = {
			factor = 4.5
			local_autonomy = 75
		}
		modifier = {
			factor = 1.5
			local_autonomy = 85			
		}
		#AI less likely to build if it still has plenty of governing capacity
		modifier = {
			factor = 0.5
			owner = { NOT = { governing_capacity_percentage = 0.5 } }
		}
		modifier = {
			factor = 0.75
			owner = { NOT = { governing_capacity_percentage = 0.7 } }
		}
		#FROM GOV CAP
		#AI more likely to build if approaching or over governing capacity
		modifier = {
			factor = 5.0
			FROM = { governing_capacity_percentage = 0.9 }
		}
		modifier = {
			factor = 10.0
			FROM = { governing_capacity_percentage = 1.0 }
		}
		modifier = {
			factor = 15.0
			FROM = { governing_capacity_percentage = 1.1 }
		}
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 400 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1000 }
		}
		#AI more likely to build if it's a big nation
		modifier = {
			factor = 1.5
			owner = { total_development = 1000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 2000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 3000 }
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 1 Government - Hall
hall = {
	cost = 200 #VU - Increased from 150 to 200 in v1.36.2.* by San Felipe
	time = 12
	
	#VU AddOn changed from 12. Doubling upgraded buildings' build time.
	#VU 13 added to balance states territories and tradecompanies.
	build_trigger = {
		is_state = yes
	}

	modifier = {
		local_state_maintenance_modifier = -0.25
	 	local_tax_modifier = 0.1
		local_autonomy = -0.1
		allowed_num_of_buildings = 1
	}

	on_built = {
		add_development_from_upgrading_or_building = {
			building = hall
			type = tax
			value = 2
			upgrade_value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = hall
			type = tax
			value = 2
		}
	}
	on_obsolete = {
	}
	ai_will_do = {
		factor = 2
		
		#ECONOMY 101
        #AI avoids building with loans
		modifier = {
			factor = 2
			FROM = { governing_capacity_percentage = 0.8 }
		}
		modifier = {
			factor = 3
			FROM = { governing_capacity_percentage = 1 }
		}
		modifier = {
			factor = 5
			FROM = { governing_capacity_percentage = 1.1 }
		}
        modifier = {
			factor = 0.75
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 0.25
			FROM = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.5
			FROM = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		#SPECIFIC
		#AI less likely to build in provinces with low development
		modifier = {
			factor = 0.5
			NOT = { development = 6	}			
		}
        #AI more likely to build in provinces with high development
        modifier = {
			factor = 1.25
			development = 10
		}
		modifier = {
			factor = 1.25
			development = 20
		}
		modifier = {
			factor = 1.25
			development = 30
		}
		#AI less likely to build if autonomy is too low
		modifier = {
			factor = 0.75
			NOT = { local_autonomy = 10 }			
		}
		#AI more likely to build if autonomy is too high
		modifier = {
			factor = 1.5
			local_autonomy = 20
		}
		modifier = {
			factor = 1.5
			local_autonomy = 40
		}
		modifier = {
			factor = 1.5
			local_autonomy = 60
		}
		modifier = {
			factor = 1.5
			local_autonomy = 85			
		}
		#AI less likely to build if it still has plenty of governing capacity
		modifier = {
			factor = 0.5
			owner = { NOT = { governing_capacity_percentage = 0.5 } }
		}
		modifier = {
			factor = 0.75
			owner = { NOT = { governing_capacity_percentage = 0.7 } }
		}
		
		#AI more likely to build if approaching or over governing capacity
		modifier = {
			factor = 5.0
			owner = { governing_capacity_percentage = 0.8 }
		}
		modifier = {
			factor = 10.0
			owner = { governing_capacity_percentage = 1.0 }
		}
		modifier = {
			factor = 15.0
			owner = { governing_capacity_percentage = 1.1 }
		}
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1200 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 2000 }
		}
		
		#AI more likely to build if it's a big nation
		modifier = {
			factor = 1.5
			owner = { total_development = 1000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 2000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 3000 }
		}
		modifier = {
			factor = 0.5
			FROM = { NOT = { treasury = 300 } }
		}
		modifier = {
			factor = 1.25
			FROM = { treasury = 400 }
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
		#Provinces in the Capital Area don't need a courthouse
		modifier = {
			factor = 0
			area_for_scope_province = {
				is_capital_of = FROM
			}
		}
	}
}

#Tier 2 Government - Town Hall
town_hall = {
	cost = 400 #VU - Increased from 300 to 400 in v1.36.2.* by San Felipe
	time = 24
	
	#VU AddOn changed from 12. Doubling upgraded buildings' build time.
	#VU 13 added to balance states territories and tradecompanies.
	build_trigger = {
		is_state = yes
	}
	make_obsolete = hall

	modifier = {
		local_state_maintenance_modifier = -0.5
 		local_tax_modifier = 0.2
		local_autonomy = -0.2
		allowed_num_of_buildings = 1
	}

	on_built = {
		add_development_from_upgrading_or_building = {
			building = town_hall
			obsolete_building = hall
			type = tax
			value = 2
			upgrade_value = 1
		}
		if = { 
			limit = { 
				FROM = { has_country_flag = fra_hall_bonus_flag }
				NOT = { has_province_modifier = fra_improved_halls_modifier }
			}
			add_province_modifier = {
				name = fra_improved_halls_modifier
				duration = -1 
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = town_hall
			type = tax
			value = 2
		}
		remove_province_modifier = fra_improved_halls_modifier 
	}
	on_obsolete = {
		remove_development_from_building = {
			building = town_hall
			type = tax
			value = 2
		}
		remove_province_modifier = fra_improved_halls_modifier 
	}
	ai_will_do = {
		factor = 2
		
		#ECONOMY 101
        #AI avoids building with loans
		modifier = {
			factor = 10
			has_building = hall
		}
		modifier = {
			factor = 2
			FROM = { governing_capacity_percentage = 0.8 }
		}
		modifier = {
			factor = 3
			FROM = { governing_capacity_percentage = 1 }
		}
		modifier = {
			factor = 5
			FROM = { governing_capacity_percentage = 1.1 }
		}
        modifier = {
			factor = 0.75
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 0.25
			FROM = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.5
			FROM = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		#SPECIFIC
		#AI less likely to build in provinces with low development
		modifier = {
			factor = 0.5
			NOT = { development = 6	}			
		}
        #AI more likely to build in provinces with high development
        	modifier = {
			factor = 1.25
			development = 10
		}
		modifier = {
			factor = 1.25
			development = 20
		}
		modifier = {
			factor = 1.25
			development = 30
		}
		#AI less likely to build if autonomy is too low
		modifier = {
			factor = 0.75
			NOT = { local_autonomy = 10 }			
		}
		#AI more likely to build if autonomy is too high
		modifier = {
			factor = 1.5
			local_autonomy = 20
		}
		modifier = {
			factor = 1.5
			local_autonomy = 40
		}
		modifier = {
			factor = 1.5
			local_autonomy = 60
		}
		modifier = {
			factor = 1.5
			local_autonomy = 85			
		}
		#AI less likely to build if it still has plenty of governing capacity
		modifier = {
			factor = 0.5
			owner = { NOT = { governing_capacity_percentage = 0.5 } }
		}
		modifier = {
			factor = 0.75
			owner = { NOT = { governing_capacity_percentage = 0.7 } }
		}
		
		#AI more likely to build if approaching or over governing capacity
		modifier = {
			factor = 5.0
			owner = { governing_capacity_percentage = 0.8 }
		}
		modifier = {
			factor = 10.0
			owner = { governing_capacity_percentage = 1.0 }
		}
		modifier = {
			factor = 15.0
			owner = { governing_capacity_percentage = 1.1 }
		}
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1200 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 2000 }
		}
		
		#AI more likely to build if it's a big nation
		modifier = {
			factor = 1.5
			owner = { total_development = 1000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 2000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 3000 }
		}
		modifier = {
			factor = 0.5
			FROM = { NOT = { treasury = 300 } }
		}
		modifier = {
			factor = 1.25
			FROM = { treasury = 400 }
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
		#Provinces in the Capital Area don't need a courthouse
		modifier = {
			factor = 0
			area_for_scope_province = {
				is_capital_of = FROM
			}
		}
	}
}

#Tier 3 Government - City Hall
city_hall = {
	cost = 600 #VU - Increased from 450 to 600 in v1.36.2.* by San Felipe
	time = 36
	
	#VU AddOn changed from 12. Doubling upgraded buildings' build time.
	#VU 13 added to balance states territories and tradecompanies.
	build_trigger = {
		is_state = yes
	}
	make_obsolete = town_hall

	modifier = {
		local_state_maintenance_modifier = -0.75
 		local_tax_modifier = 0.3
		local_autonomy = -0.3
		allowed_num_of_buildings = 2
	}

	on_built = {
		add_development_from_upgrading_or_building = {
			building = city_hall
			obsolete_building = town_hall
			type = tax
			value = 2
			upgrade_value = 1
		}
		if = { 
			limit = { 
				FROM = { has_country_flag = fra_town_hall_bonus_flag }
				NOT = { has_province_modifier = fra_improved_town_hall_modifier }
			}
			add_province_modifier = {
				name = fra_improved_town_hall_modifier
				duration = -1 
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = city_hall
			type = tax
			value = 2
		}
		remove_province_modifier = fra_improved_town_hall_modifier 
	}
	on_obsolete = {
	}
	ai_will_do = {
		factor = 2
		
		#ECONOMY 101
        #AI avoids building with loans
		modifier = {
			factor = 10
			has_building = town_hall
		}
		modifier = {
			factor = 2
			FROM = { governing_capacity_percentage = 0.8 }
		}
		modifier = {
			factor = 3
			FROM = { governing_capacity_percentage = 1 }
		}
		modifier = {
			factor = 5
			FROM = { governing_capacity_percentage = 1.1 }
		}
        modifier = {
			factor = 0.75
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 0.25
			FROM = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.5
			FROM = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		#SPECIFIC
		#AI less likely to build in provinces with low development
		modifier = {
			factor = 0.5
			NOT = { development = 6	}			
		}
        #AI more likely to build in provinces with high development
        modifier = {
			factor = 1.25
			development = 10
		}
		modifier = {
			factor = 1.25
			development = 20
		}
		modifier = {
			factor = 1.25
			development = 30
		}
		#AI less likely to build if autonomy is too low
		modifier = {
			factor = 0.75
			NOT = { local_autonomy = 10 }			
		}
		#AI more likely to build if autonomy is too high
		modifier = {
			factor = 1.5
			local_autonomy = 20
		}
		modifier = {
			factor = 1.5
			local_autonomy = 40
		}
		modifier = {
			factor = 1.5
			local_autonomy = 60
		}
		modifier = {
			factor = 1.5
			local_autonomy = 85			
		}
		#AI less likely to build if it still has plenty of governing capacity
		modifier = {
			factor = 0.5
			owner = { NOT = { governing_capacity_percentage = 0.5 } }
		}
		modifier = {
			factor = 0.75
			owner = { NOT = { governing_capacity_percentage = 0.7 } }
		}
		
		#AI more likely to build if approaching or over governing capacity
		modifier = {
			factor = 5.0
			owner = { governing_capacity_percentage = 0.8 }
		}
		modifier = {
			factor = 10.0
			owner = { governing_capacity_percentage = 1.0 }
		}
		modifier = {
			factor = 15.0
			owner = { governing_capacity_percentage = 1.1 }
		}
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1200 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 2000 }
		}
		
		#AI more likely to build if it's a big nation
		modifier = {
			factor = 1.5
			owner = { total_development = 1000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 2000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 3000 }
		}
		modifier = {
			factor = 0.5
			FROM = { NOT = { treasury = 300 } }
		}
		modifier = {
			factor = 1.25
			FROM = { treasury = 400 }
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
		#Provinces in the Capital Area don't need a courthouse
		modifier = {
			factor = 0
			area_for_scope_province = {
				is_capital_of = FROM
			}
		}
	}
}

#Tier 1 Education - Library
library = {
	cost = 300 #VU - Kept at 300 in v1.36.2.* by San Felipe
	time = 12
    modifier = {
		local_development_cost = -0.10
		local_institution_spread = 0.5
		#Changed from 0.5 to better represent that universities were often the birthplace of scientific advancements and innovation.
		#Brought back local_development_cost and removed those tax and production modifier.
		#OP really said "Universities do encourage complex economic systems, advanced industry, and improved production methods" in the same line as "I wouldn't say universities aid development".
	}

	on_built = {
		add_development_from_building = {
			building = library
			type = tax
			value = 2
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = library
			type = tax
			value = 2
		}
	}
	on_obsolete = {
	}

	#Neart perfect copy because I'm not spending my time organising this. Economy 101 was shoved at the end.
	ai_will_do = {
		# Hard coded AI sees no value in this above the 0.01 ducats base. Let's multiply that
		factor = 12			#VU Addon changed from 1. Changing all base factors to price divided by 100.
		#VU Addon cut a bunch of... not horrible but not great AI code here encouraging unis to be built. Replacing it below. Vanilla range was 36 percent to 7,500 percent.
		#Note with this addon, universities are no longer economically worthless, and I am assuming the AI will pick up on that. I do not know, however, what the exact figures are and thus balancing it will be a challenge. For a start, it has roughly half the economic contribution of a cathedral, but x3 the cost,
		#assuming the new AI is not smart enough to pick up on institution spread modifiers, which do not exist in vanilla, without any other modifiers I'm assuming (notice a trend here?) that it will require a factor of 6 or so before the AI will choose this before a cathedral or a factor of 12 to pick before a temple.
		#VU Addon New factors, range (roughly) 0.0001 percent to over 50,000 percent. Note vanilla range was 36 percent to 7,500 percent.
		###############################################################################################
		###############		Using tech groups to establish base factors of 0.3 to 4		###############
		###############################################################################################
		modifier = {
			factor = 10
			development = 16
		}
		modifier = {
			factor = 1.4
			development = 21
		}
		modifier = {
			factor = 1.4
			development = 26
		}
		modifier = {
			factor = 1.4
			development = 30
		}
		modifier = {
			factor = 0
			is_state = no
		}
		modifier = {
			factor = 2
			is_capital = yes
		}
		modifier = {
			factor = 0.5
			OR = {
				has_climate = tropical
				has_climate = arid
			}
		}
		modifier = {
			factor = 0.2
			has_climate = arctic
		}
		modifier = {
			factor = 1.2
			OR = {
				has_terrain = grasslands
				has_terrain = drylands
			}
		}
		modifier = {
			factor = 1.3
			has_terrain = farmlands
		}
		modifier = {
			factor = 2
			is_year = 1690 # Enlightenment spawns in 1700
			not = {
				owner = {
					has_institution = enlightenment
				}
			}
			not = {
				provincial_institution_progress = {
					which = enlightenment
					value = 20
				}
			}
		}
		modifier = {
			factor = 0.3			#One 20th of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much as I love the concept of a bustling university discovering advanced scientific principles while speaking Maori or something equally absurd/obscure, the fact is some technology groups simply did not have the infrastructure, history, or circumstance to evolve in this way. Making it very unlikely
		modifier = {
			factor = 1			#One 6th of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 2			#One 3rd of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 3			#half of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = eastern
				    technology_group = bohemian_tech_group
				    technology_group = byzantine_tech_group
				    technology_group = hungarian_tech_group
				    technology_group = polish_tech_group
				    technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Medium range for eastern, and throwing in High American for fun as this is effectively the default level.
		modifier = {
			factor = 4			#Two 3rds of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = western
					technology_group = dutch_tech_group
					technology_group = english_tech_group
					technology_group = french_tech_group
					technology_group = german_tech_group
					technology_group = italian_tech_group
					technology_group = portuguese_tech_group
					technology_group = roman_tech_group
					technology_group = scandinavian_tech_group
					technology_group = spanish_tech_group
					technology_group = swiss_tech_group
				}
			}
		}	#The concept of a university may or may not be a uniquely western concept, but in this specific period, it was a western reality, less so elsewhere. Though as a point of interest, universities were a very different beast in this period than the BA most modern people think of.
		################################################################################
		###############		Various bonuses and penalties to make things dynamic		###############
		################################################################################
		#Note that IN THEORY, without any other modifiers, it would require....
		#About 4 of the 1.4 bonuses for Muslim or Ottoman tech to build a uni before a cathedral and all 6 to be a higher priority than a temple,
		#all 6 1.4 bonuses for other Old World techs to build a uni before a cathedral and they will never place it above a temple,
		#New World techs will effectively never build unis without player intervention,
		#eastern requires about 3 of the 1.4 bonuses to place them as a higher priority than cathedrals or 5 of the 1.4 bonuses to be a higher priority than a temple,
		#and western will place them at a higher priority than cathedrals with 2 1.4 bonuses. or a higher priority than temples with 4 1.4 bonuses.
		#Once 5 universities are built, the AI will be less likely to build more.
		modifier = {
			factor = 1.4
			FROM = { ruler_has_personality = scholar_personality }
		}
		modifier = {
			factor = 1.4
			FROM = { advisor = natural_scientist }
		}
		modifier = {
			factor = 1.4
			FROM = { advisor = philosopher }
		}
		modifier = {
			factor = 1.4
			FROM = { full_idea_group = innovativeness_ideas }
		}
		modifier = {
			factor = 1.4
			FROM = { is_great_power = yes }			#Primarily to keep Russia, Poland, and Ottomans in line with western, and the top western powers ahead of everyone else, as real history went, but also may potentially help China, India, or any ahistorical superpower in Asia or Africa as well.
		}
		modifier = {
			factor = 1.4
			province_has_center_of_trade_of_level = 1			#Cheap shortcut method to try to get unis in plausible rich centers, especially for alt history non-european unis.
		}
		modifier = {
			factor = 1.18			#Half strength
			num_of_times_improved = 10
		}	#A province which has been developed intensely is slightly more likely to get a uni
		modifier = {
			factor = 10
			is_institution_origin = enlightenment
		}
		modifier = {
			factor = 0.2
			any_neighbor_province = {
				has_building = library
			}
		}	#Hopefully this doesn't make the engine go too insane. From a gameplay perspective, this is huge at distributing enlightenment spreaders evenly. Could also try to do something area related, but with the other factors below this should suffice.
		####################################################################################################
		##########	Effectively disabling unis for fringes, harsh climates, minorities, and non western minors 	##########
		####################################################################################################
		modifier = {
			factor = 0.1
			FROM = {
				NOT = { 
					OR = {
				    	technology_group = western
				    	technology_group = dutch_tech_group
				    	technology_group = english_tech_group
				    	technology_group = french_tech_group
				    	technology_group = german_tech_group
				    	technology_group = italian_tech_group
				    	technology_group = portuguese_tech_group
				    	technology_group = roman_tech_group
				    	technology_group = scandinavian_tech_group
				    	technology_group = spanish_tech_group
				    	technology_group = swiss_tech_group
				    }
				}
				NOT = {
					OR = {
						technology_group = eastern
						technology_group = bohemian_tech_group
						technology_group = byzantine_tech_group
						technology_group = hungarian_tech_group
						technology_group = polish_tech_group
						technology_group = russian_tech_group
						technology_group = bulgarian_tech_group
					}
				}
				NOT = { total_development = 200 }
			}	#Small non European AI countries shouldn't build many unis, further penalty even beyond the tech group penalty above.
		}
		modifier = {
			factor = 0.5
			is_in_capital_area = no
		}			#AI should rarely build uni in a province which is not connected to the capital by land. This could cause some issues in the extremely rare cases of thalassocracies, but it fixes far more problems than it creates, so leaving it.
		modifier = {
			factor = 0.1
			is_state = no
		}			#AI should almost never build uni in a province which is not a state
		modifier = {
			factor = 0.1
			has_owner_culture = no
			has_owner_accepted_culture = no
		}			#AI should almost never build uni in a province with a different culture, even if that culure is accepted
		modifier = {
			factor = 0.33
			has_owner_culture = no
			has_owner_accepted_culture = yes
		}			#Though an accepted culture is still more likely than a non accepted culture
		modifier = {
			factor = 0.1
			has_owner_religion = no
		}			#AI should almost never build uni in a province with a different religion, even if there is positive tolerance.
		modifier = {
			factor = 0.1
			OR = {
				has_climate = tropical
				has_climate = arctic
				has_climate = arid
			}
		}	#AI should almost never build uni in a province with a hostile climate. This may hurt the chances of some small countries who only own land in these climate types, but well... they really shouldn't be building too many unis anyway, with very, very few exceptions. As in none I can think of
		################################################################################
		###############	Almost guaranteeing unis in provinces with real historical universities	###############
		################################################################################
		#modifier = {
		#	factor = 20
		#	OR = {
		#		province_id = 4730		#Bologna, 1088
		#		province_id = 237			#Oxford, 1096
		#		province_id = 183			#Paris (Sorbonne), 1160 (I thought it was older...)
		#		province_id = 3027		#Cambrige, 1209
		#		province_id = 216			#Salamanca, 1218
		#		province_id = 108			#Padua (actually Verona atm, might add some provinces to Italy in the future), 1222 or older
		#		province_id = 121			#Naples, 1224
		#		province_id = 196			#Toulouse, 1229
		#		province_id = 200			#Montpellier, 1289
		#		province_id = 119			#Macerata (Ancona), 1290
		#		province_id = 1851		#Coimbra (actually started in Lisbon and moved to Coimbra in 1537, but whatever), 1290
		#		province_id = 217			#Alcala (Madrid), 1293
		#		province_id = 118			#Rome, 1303
		#		province_id = 2976		#Perugia (Umbria), 1308
		#		province_id = 116			#Florence, 1321
		#		province_id = 115			#Pisa, 1343
		#		province_id = 266			#Prague, 1348
		#		province_id = 4728		#Pavia, 1361
		#		province_id = 262			#Jagiellonian (Krakow), 1364
		#		province_id = 134			#Vienna, 1365
		#		province_id = 77			#Ruprecht Karl University of Heidelberg, 1386
		#		province_id = 113			#Ferrara, 1391
		#		province_id = 103			#Turin, 1404
		#		province_id = 117			#Siena, 1408
		#		province_id = 62			#Leipzig, 1409
		#		province_id = 250			#St. Andrews (Fife), 1413
		#		province_id = 46			#Rostock, 1419
		#		province_id = 168			#Caen, 1432
		#		province_id = 124			#Catania (Mesina), 1434
		#	}
		#}			#Few little nudges to history to try to encourage the main historical universities (Which actually exisited prior to our start date) to be 'built' in the proper provinces first. For Unis founded after our 1444 start date, I'm not doing anything. There are several more which no longer exist, but for those I have to figure out when they closed, so not doing them now.
		################################################################################
		##########	End of the insanely overcomplicated uni AI controls by VU's Misc Addon	##########
		################################################################################
		#P.S. Sorry I got carried away, hopefully the engine doesn't blow up calculating all these.
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 800 } }
        }
		
		#AI less likely to build in provinces with low development
		modifier = {
			factor = 0.1
			NOT = { development = 9 }
		}
		
		#AI more likely to build in provinces with high development
        modifier = {
            factor = 1.18
            development = 21
        }
		
		#AI more likely to build when rich
		modifier = {
			factor = 1.1
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.2
			owner = { treasury = 2400 }
		}
		modifier = {
			factor = 1.3
			owner = { treasury = 3200 }
		}
		modifier = {
			factor = 1.4
			owner = { treasury = 4000 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1400 }
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

#Tier 2 Education - School
school = {
	cost = 600 #VU - Increased from 300 to 600 in v1.36.2.* by San Felipe
	time = 12
    modifier = {
		local_development_cost = -0.10
		local_institution_spread = 0.5
		#Changed from 0.5 to better represent that universities were often the birthplace of scientific advancements and innovation.
		#Brought back local_development_cost and removed those tax and production modifier.
		#OP really said "Universities do encourage complex economic systems, advanced industry, and improved production methods" in the same line as "I wouldn't say universities aid development".
	}

	on_built = {
		add_development_from_building = {
			building = school
			type = tax
			value = 2
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = school
			type = tax
			value = 2
		}
	}
	on_obsolete = {
	}

	#Neart perfect copy because I'm not spending my time organising this. Economy 101 was shoved at the end.
	ai_will_do = {
		# Hard coded AI sees no value in this above the 0.01 ducats base. Let's multiply that
		factor = 12			#VU Addon changed from 1. Changing all base factors to price divided by 100.
		#VU Addon cut a bunch of... not horrible but not great AI code here encouraging unis to be built. Replacing it below. Vanilla range was 36 percent to 7,500 percent.
		#Note with this addon, universities are no longer economically worthless, and I am assuming the AI will pick up on that. I do not know, however, what the exact figures are and thus balancing it will be a challenge. For a start, it has roughly half the economic contribution of a cathedral, but x3 the cost,
		#assuming the new AI is not smart enough to pick up on institution spread modifiers, which do not exist in vanilla, without any other modifiers I'm assuming (notice a trend here?) that it will require a factor of 6 or so before the AI will choose this before a cathedral or a factor of 12 to pick before a temple.
		#VU Addon New factors, range (roughly) 0.0001 percent to over 50,000 percent. Note vanilla range was 36 percent to 7,500 percent.
		###############################################################################################
		###############		Using tech groups to establish base factors of 0.3 to 4		###############
		###############################################################################################
		modifier = {
			factor = 10
			development = 16
		}
		modifier = {
			factor = 1.4
			development = 21
		}
		modifier = {
			factor = 1.4
			development = 26
		}
		modifier = {
			factor = 1.4
			development = 30
		}
		modifier = {
			factor = 0
			is_state = no
		}
		modifier = {
			factor = 2
			is_capital = yes
		}
		modifier = {
			factor = 0.5
			OR = {
				has_climate = tropical
				has_climate = arid
			}
		}
		modifier = {
			factor = 0.2
			has_climate = arctic
		}
		modifier = {
			factor = 1.2
			OR = {
				has_terrain = grasslands
				has_terrain = drylands
			}
		}
		modifier = {
			factor = 1.3
			has_terrain = farmlands
		}
		modifier = {
			factor = 2
			is_year = 1690 # Enlightenment spawns in 1700
			not = {
				owner = {
					has_institution = enlightenment
				}
			}
			not = {
				provincial_institution_progress = {
					which = enlightenment
					value = 20
				}
			}
		}
		modifier = {
			factor = 0.3			#One 20th of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much as I love the concept of a bustling university discovering advanced scientific principles while speaking Maori or something equally absurd/obscure, the fact is some technology groups simply did not have the infrastructure, history, or circumstance to evolve in this way. Making it very unlikely
		modifier = {
			factor = 1			#One 6th of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 2			#One 3rd of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 3			#half of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = eastern
				    technology_group = bohemian_tech_group
				    technology_group = byzantine_tech_group
				    technology_group = hungarian_tech_group
				    technology_group = polish_tech_group
				    technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Medium range for eastern, and throwing in High American for fun as this is effectively the default level.
		modifier = {
			factor = 4			#Two 3rds of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = western
					technology_group = dutch_tech_group
					technology_group = english_tech_group
					technology_group = french_tech_group
					technology_group = german_tech_group
					technology_group = italian_tech_group
					technology_group = portuguese_tech_group
					technology_group = roman_tech_group
					technology_group = scandinavian_tech_group
					technology_group = spanish_tech_group
					technology_group = swiss_tech_group
				}
			}
		}	#The concept of a university may or may not be a uniquely western concept, but in this specific period, it was a western reality, less so elsewhere. Though as a point of interest, universities were a very different beast in this period than the BA most modern people think of.
		################################################################################
		###############		Various bonuses and penalties to make things dynamic		###############
		################################################################################
		#Note that IN THEORY, without any other modifiers, it would require....
		#About 4 of the 1.4 bonuses for Muslim or Ottoman tech to build a uni before a cathedral and all 6 to be a higher priority than a temple,
		#all 6 1.4 bonuses for other Old World techs to build a uni before a cathedral and they will never place it above a temple,
		#New World techs will effectively never build unis without player intervention,
		#eastern requires about 3 of the 1.4 bonuses to place them as a higher priority than cathedrals or 5 of the 1.4 bonuses to be a higher priority than a temple,
		#and western will place them at a higher priority than cathedrals with 2 1.4 bonuses. or a higher priority than temples with 4 1.4 bonuses.
		#Once 5 universities are built, the AI will be less likely to build more.
		modifier = {
			factor = 1.4
			FROM = { ruler_has_personality = scholar_personality }
		}
		modifier = {
			factor = 1.4
			FROM = { advisor = natural_scientist }
		}
		modifier = {
			factor = 1.4
			FROM = { advisor = philosopher }
		}
		modifier = {
			factor = 1.4
			FROM = { full_idea_group = innovativeness_ideas }
		}
		modifier = {
			factor = 1.4
			FROM = { is_great_power = yes }			#Primarily to keep Russia, Poland, and Ottomans in line with western, and the top western powers ahead of everyone else, as real history went, but also may potentially help China, India, or any ahistorical superpower in Asia or Africa as well.
		}
		modifier = {
			factor = 1.4
			province_has_center_of_trade_of_level = 1			#Cheap shortcut method to try to get unis in plausible rich centers, especially for alt history non-european unis.
		}
		modifier = {
			factor = 1.18			#Half strength
			num_of_times_improved = 10
		}	#A province which has been developed intensely is slightly more likely to get a uni
		modifier = {
			factor = 10
			is_institution_origin = enlightenment
		}
		modifier = {
			factor = 0.2
			any_neighbor_province = {
				has_building = school
			}
		}	#Hopefully this doesn't make the engine go too insane. From a gameplay perspective, this is huge at distributing enlightenment spreaders evenly. Could also try to do something area related, but with the other factors below this should suffice.
		####################################################################################################
		##########	Effectively disabling unis for fringes, harsh climates, minorities, and non western minors 	##########
		####################################################################################################
		modifier = {
			factor = 0.1
			FROM = {
				NOT = { 
					OR = {
				    	technology_group = western
				    	technology_group = dutch_tech_group
				    	technology_group = english_tech_group
				    	technology_group = french_tech_group
				    	technology_group = german_tech_group
				    	technology_group = italian_tech_group
				    	technology_group = portuguese_tech_group
				    	technology_group = roman_tech_group
				    	technology_group = scandinavian_tech_group
				    	technology_group = spanish_tech_group
				    	technology_group = swiss_tech_group
				    }
				}
				NOT = {
					OR = {
						technology_group = eastern
						technology_group = bohemian_tech_group
						technology_group = byzantine_tech_group
						technology_group = hungarian_tech_group
						technology_group = polish_tech_group
						technology_group = russian_tech_group
						technology_group = bulgarian_tech_group
					}
				}
				NOT = { total_development = 200 }
			}	#Small non European AI countries shouldn't build many unis, further penalty even beyond the tech group penalty above.
		}
		modifier = {
			factor = 0.5
			is_in_capital_area = no
		}			#AI should rarely build uni in a province which is not connected to the capital by land. This could cause some issues in the extremely rare cases of thalassocracies, but it fixes far more problems than it creates, so leaving it.
		modifier = {
			factor = 0.1
			is_state = no
		}			#AI should almost never build uni in a province which is not a state
		modifier = {
			factor = 0.1
			has_owner_culture = no
			has_owner_accepted_culture = no
		}			#AI should almost never build uni in a province with a different culture, even if that culure is accepted
		modifier = {
			factor = 0.33
			has_owner_culture = no
			has_owner_accepted_culture = yes
		}			#Though an accepted culture is still more likely than a non accepted culture
		modifier = {
			factor = 0.1
			has_owner_religion = no
		}			#AI should almost never build uni in a province with a different religion, even if there is positive tolerance.
		modifier = {
			factor = 0.1
			OR = {
				has_climate = tropical
				has_climate = arctic
				has_climate = arid
			}
		}	#AI should almost never build uni in a province with a hostile climate. This may hurt the chances of some small countries who only own land in these climate types, but well... they really shouldn't be building too many unis anyway, with very, very few exceptions. As in none I can think of
		################################################################################
		###############	Almost guaranteeing unis in provinces with real historical universities	###############
		################################################################################
		#modifier = {
		#	factor = 20
		#	OR = {
		#		province_id = 4730		#Bologna, 1088
		#		province_id = 237			#Oxford, 1096
		#		province_id = 183			#Paris (Sorbonne), 1160 (I thought it was older...)
		#		province_id = 3027		#Cambrige, 1209
		#		province_id = 216			#Salamanca, 1218
		#		province_id = 108			#Padua (actually Verona atm, might add some provinces to Italy in the future), 1222 or older
		#		province_id = 121			#Naples, 1224
		#		province_id = 196			#Toulouse, 1229
		#		province_id = 200			#Montpellier, 1289
		#		province_id = 119			#Macerata (Ancona), 1290
		#		province_id = 1851		#Coimbra (actually started in Lisbon and moved to Coimbra in 1537, but whatever), 1290
		#		province_id = 217			#Alcala (Madrid), 1293
		#		province_id = 118			#Rome, 1303
		#		province_id = 2976		#Perugia (Umbria), 1308
		#		province_id = 116			#Florence, 1321
		#		province_id = 115			#Pisa, 1343
		#		province_id = 266			#Prague, 1348
		#		province_id = 4728		#Pavia, 1361
		#		province_id = 262			#Jagiellonian (Krakow), 1364
		#		province_id = 134			#Vienna, 1365
		#		province_id = 77			#Ruprecht Karl University of Heidelberg, 1386
		#		province_id = 113			#Ferrara, 1391
		#		province_id = 103			#Turin, 1404
		#		province_id = 117			#Siena, 1408
		#		province_id = 62			#Leipzig, 1409
		#		province_id = 250			#St. Andrews (Fife), 1413
		#		province_id = 46			#Rostock, 1419
		#		province_id = 168			#Caen, 1432
		#		province_id = 124			#Catania (Mesina), 1434
		#	}
		#}			#Few little nudges to history to try to encourage the main historical universities (Which actually exisited prior to our start date) to be 'built' in the proper provinces first. For Unis founded after our 1444 start date, I'm not doing anything. There are several more which no longer exist, but for those I have to figure out when they closed, so not doing them now.
		################################################################################
		##########	End of the insanely overcomplicated uni AI controls by VU's Misc Addon	##########
		################################################################################
		#P.S. Sorry I got carried away, hopefully the engine doesn't blow up calculating all these.
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 800 } }
        }
		
		#AI less likely to build in provinces with low development
		modifier = {
			factor = 0.1
			NOT = { development = 9 }
		}
		
		#AI more likely to build in provinces with high development
        modifier = {
            factor = 1.18
            development = 21
        }
		
		#AI more likely to build when rich
		modifier = {
			factor = 1.1
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.2
			owner = { treasury = 2400 }
		}
		modifier = {
			factor = 1.3
			owner = { treasury = 3200 }
		}
		modifier = {
			factor = 1.4
			owner = { treasury = 4000 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1400 }
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 47500
			}
		}
	}
}

#Tier 3 Education - University
university = {
	cost = 900 #VU - Increased from 600 to 900 in v1.36.2.* by San Felipe
	time = 36
	#VU AddOn price changed from 300. This is late game, vital to the spread of the enlightenment, and generally very important.
	#Furthermore the development of centres of learning and scholarship was more expensive and time consuming than one might think.
	#Changing cost and time to be closer to/higher than the earlier manufactories.
	#Note I'll also increase the enlightenment spread from a uni, so this becomes something to be built in key cities & let spread, not something to spam everywhere at tech 17 for tech spread and dev cost.
	#VU AddOn changed from 12. This is not meant to be spammed when the enlightenment hits to catch up, increased to 4y
	
	modifier = {
		local_development_cost = -0.20
		local_institution_spread = 1.0
		#Changed from 0.5 to better represent that universities were often the birthplace of scientific advancements and innovation.
		#Brought back local_development_cost and removed those tax and production modifier.
		#OP really said "Universities do encourage complex economic systems, advanced industry, and improved production methods" in the same line as "I wouldn't say universities aid development".
	}

	on_built = {
		add_development_from_building = {
			building = university
			type = tax
			value = 2
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = university
			type = tax
			value = 2
		}
	}
	on_obsolete = {
	}

	#Neart perfect copy because I'm not spending my time organising this. Economy 101 was shoved at the end.
	ai_will_do = {
		# Hard coded AI sees no value in this above the 0.01 ducats base. Let's multiply that
		factor = 12			#VU Addon changed from 1. Changing all base factors to price divided by 100.
		#VU Addon cut a bunch of... not horrible but not great AI code here encouraging unis to be built. Replacing it below. Vanilla range was 36 percent to 7,500 percent.
		#Note with this addon, universities are no longer economically worthless, and I am assuming the AI will pick up on that. I do not know, however, what the exact figures are and thus balancing it will be a challenge. For a start, it has roughly half the economic contribution of a cathedral, but x3 the cost,
		#assuming the new AI is not smart enough to pick up on institution spread modifiers, which do not exist in vanilla, without any other modifiers I'm assuming (notice a trend here?) that it will require a factor of 6 or so before the AI will choose this before a cathedral or a factor of 12 to pick before a temple.
		#VU Addon New factors, range (roughly) 0.0001 percent to over 50,000 percent. Note vanilla range was 36 percent to 7,500 percent.
		###############################################################################################
		###############		Using tech groups to establish base factors of 0.3 to 4		###############
		###############################################################################################
		modifier = {
			factor = 10
			development = 16
		}
		modifier = {
			factor = 1.4
			development = 21
		}
		modifier = {
			factor = 1.4
			development = 26
		}
		modifier = {
			factor = 1.4
			development = 30
		}
		modifier = {
			factor = 0
			is_state = no
		}
		modifier = {
			factor = 2
			is_capital = yes
		}
		modifier = {
			factor = 0.5
			OR = {
				has_climate = tropical
				has_climate = arid
			}
		}
		modifier = {
			factor = 0.2
			has_climate = arctic
		}
		modifier = {
			factor = 1.2
			OR = {
				has_terrain = grasslands
				has_terrain = drylands
			}
		}
		modifier = {
			factor = 1.3
			has_terrain = farmlands
		}
		modifier = {
			factor = 2
			is_year = 1690 # Enlightenment spawns in 1700
			not = {
				owner = {
					has_institution = enlightenment
				}
			}
			not = {
				provincial_institution_progress = {
					which = enlightenment
					value = 20
				}
			}
		}
		modifier = {
			factor = 0.3			#One 20th of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much as I love the concept of a bustling university discovering advanced scientific principles while speaking Maori or something equally absurd/obscure, the fact is some technology groups simply did not have the infrastructure, history, or circumstance to evolve in this way. Making it very unlikely
		modifier = {
			factor = 1			#One 6th of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 2			#One 3rd of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 3			#half of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = eastern
				    technology_group = bohemian_tech_group
				    technology_group = byzantine_tech_group
				    technology_group = hungarian_tech_group
				    technology_group = polish_tech_group
				    technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Medium range for eastern, and throwing in High American for fun as this is effectively the default level.
		modifier = {
			factor = 4			#Two 3rds of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = western
					technology_group = dutch_tech_group
					technology_group = english_tech_group
					technology_group = french_tech_group
					technology_group = german_tech_group
					technology_group = italian_tech_group
					technology_group = portuguese_tech_group
					technology_group = roman_tech_group
					technology_group = scandinavian_tech_group
					technology_group = spanish_tech_group
					technology_group = swiss_tech_group
				}
			}
		}	#The concept of a university may or may not be a uniquely western concept, but in this specific period, it was a western reality, less so elsewhere. Though as a point of interest, universities were a very different beast in this period than the BA most modern people think of.
		################################################################################
		###############		Various bonuses and penalties to make things dynamic		###############
		################################################################################
		#Note that IN THEORY, without any other modifiers, it would require....
		#About 4 of the 1.4 bonuses for Muslim or Ottoman tech to build a uni before a cathedral and all 6 to be a higher priority than a temple,
		#all 6 1.4 bonuses for other Old World techs to build a uni before a cathedral and they will never place it above a temple,
		#New World techs will effectively never build unis without player intervention,
		#eastern requires about 3 of the 1.4 bonuses to place them as a higher priority than cathedrals or 5 of the 1.4 bonuses to be a higher priority than a temple,
		#and western will place them at a higher priority than cathedrals with 2 1.4 bonuses. or a higher priority than temples with 4 1.4 bonuses.
		#Once 5 universities are built, the AI will be less likely to build more.
		modifier = {
			factor = 1.4
			FROM = { ruler_has_personality = scholar_personality }
		}
		modifier = {
			factor = 1.4
			FROM = { advisor = natural_scientist }
		}
		modifier = {
			factor = 1.4
			FROM = { advisor = philosopher }
		}
		modifier = {
			factor = 1.4
			FROM = { full_idea_group = innovativeness_ideas }
		}
		modifier = {
			factor = 1.4
			FROM = { is_great_power = yes }			#Primarily to keep Russia, Poland, and Ottomans in line with western, and the top western powers ahead of everyone else, as real history went, but also may potentially help China, India, or any ahistorical superpower in Asia or Africa as well.
		}
		modifier = {
			factor = 1.4
			province_has_center_of_trade_of_level = 1			#Cheap shortcut method to try to get unis in plausible rich centers, especially for alt history non-european unis.
		}
		modifier = {
			factor = 1.18			#Half strength
			num_of_times_improved = 10
		}	#A province which has been developed intensely is slightly more likely to get a uni
		modifier = {
			factor = 10
			is_institution_origin = enlightenment
		}
		modifier = {
			factor = 0.2
			owner = {
				num_of_owned_provinces_with = {
					value = 5
					OR = {
						has_building = university
						has_construction = university
					}
					is_core = PREV			#I'm useless with coding =p. Do I need PREV or ROOT here, or will either work?
				}
			}
		}	#If the owner has 5 cores with unis already, make it less likely to build more
		modifier = {
			factor = 0.2
			any_neighbor_province = {
				has_building = university
			}
		}	#Hopefully this doesn't make the engine go too insane. From a gameplay perspective, this is huge at distributing enlightenment spreaders evenly. Could also try to do something area related, but with the other factors below this should suffice.
		####################################################################################################
		##########	Effectively disabling unis for fringes, harsh climates, minorities, and non western minors 	##########
		####################################################################################################
		modifier = {
			factor = 0.1
			FROM = {
				NOT = { 
					OR = {
				    	technology_group = western
				    	technology_group = dutch_tech_group
				    	technology_group = english_tech_group
				    	technology_group = french_tech_group
				    	technology_group = german_tech_group
				    	technology_group = italian_tech_group
				    	technology_group = portuguese_tech_group
				    	technology_group = roman_tech_group
				    	technology_group = scandinavian_tech_group
				    	technology_group = spanish_tech_group
				    	technology_group = swiss_tech_group
				    }
				}
				NOT = {
					OR = {
						technology_group = eastern
						technology_group = bohemian_tech_group
						technology_group = byzantine_tech_group
						technology_group = hungarian_tech_group
						technology_group = polish_tech_group
						technology_group = russian_tech_group
						technology_group = bulgarian_tech_group
					}
				}
				NOT = { total_development = 200 }
			}	#Small non European AI countries shouldn't build many unis, further penalty even beyond the tech group penalty above.
		}
		modifier = {
			factor = 0.5
			is_in_capital_area = no
		}			#AI should rarely build uni in a province which is not connected to the capital by land. This could cause some issues in the extremely rare cases of thalassocracies, but it fixes far more problems than it creates, so leaving it.
		modifier = {
			factor = 0.1
			is_state = no
		}			#AI should almost never build uni in a province which is not a state
		modifier = {
			factor = 0.1
			has_owner_culture = no
			has_owner_accepted_culture = no
		}			#AI should almost never build uni in a province with a different culture, even if that culure is accepted
		modifier = {
			factor = 0.33
			has_owner_culture = no
			has_owner_accepted_culture = yes
		}			#Though an accepted culture is still more likely than a non accepted culture
		modifier = {
			factor = 0.1
			has_owner_religion = no
		}			#AI should almost never build uni in a province with a different religion, even if there is positive tolerance.
		modifier = {
			factor = 0.1
			OR = {
				has_climate = tropical
				has_climate = arctic
				has_climate = arid
			}
		}	#AI should almost never build uni in a province with a hostile climate. This may hurt the chances of some small countries who only own land in these climate types, but well... they really shouldn't be building too many unis anyway, with very, very few exceptions. As in none I can think of
		################################################################################
		###############	Almost guaranteeing unis in provinces with real historical universities	###############
		################################################################################
		modifier = {
			factor = 20
			OR = {
				province_id = 4730		#Bologna, 1088
				province_id = 237			#Oxford, 1096
				province_id = 183			#Paris (Sorbonne), 1160 (I thought it was older...)
				province_id = 3027		#Cambrige, 1209
				province_id = 216			#Salamanca, 1218
				province_id = 108			#Padua (actually Verona atm, might add some provinces to Italy in the future), 1222 or older
				province_id = 121			#Naples, 1224
				province_id = 196			#Toulouse, 1229
				province_id = 200			#Montpellier, 1289
				province_id = 119			#Macerata (Ancona), 1290
				province_id = 1851		#Coimbra (actually started in Lisbon and moved to Coimbra in 1537, but whatever), 1290
				province_id = 217			#Alcala (Madrid), 1293
				province_id = 118			#Rome, 1303
				province_id = 2976		#Perugia (Umbria), 1308
				province_id = 116			#Florence, 1321
				province_id = 115			#Pisa, 1343
				province_id = 266			#Prague, 1348
				province_id = 4728		#Pavia, 1361
				province_id = 262			#Jagiellonian (Krakow), 1364
				province_id = 134			#Vienna, 1365
				province_id = 77			#Ruprecht Karl University of Heidelberg, 1386
				province_id = 113			#Ferrara, 1391
				province_id = 103			#Turin, 1404
				province_id = 117			#Siena, 1408
				province_id = 62			#Leipzig, 1409
				province_id = 250			#St. Andrews (Fife), 1413
				province_id = 46			#Rostock, 1419
				province_id = 168			#Caen, 1432
				province_id = 124			#Catania (Mesina), 1434
			}
		}			#Few little nudges to history to try to encourage the main historical universities (Which actually exisited prior to our start date) to be 'built' in the proper provinces first. For Unis founded after our 1444 start date, I'm not doing anything. There are several more which no longer exist, but for those I have to figure out when they closed, so not doing them now.
		################################################################################
		##########	End of the insanely overcomplicated uni AI controls by VU's Misc Addon	##########
		################################################################################
		#P.S. Sorry I got carried away, hopefully the engine doesn't blow up calculating all these.
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 800 } }
        }
		
		#AI less likely to build in provinces with low development
		modifier = {
			factor = 0.1
			NOT = { development = 9 }
		}
		
		#AI more likely to build in provinces with high development
        modifier = {
            factor = 1.18
            development = 21
        }
		
		#AI more likely to build when rich
		modifier = {
			factor = 1.1
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.2
			owner = { treasury = 2400 }
		}
		modifier = {
			factor = 1.3
			owner = { treasury = 3200 }
		}
		modifier = {
			factor = 1.4
			owner = { treasury = 4000 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1400 }
		}
	}
}

################################################

### TAXATION

#Tier 1 Taxation - Temple
temple = {
	cost = 250 #VU - Increased from 100 to 250 in v1.36.2.* by San Felipe
	time = 12
	modifier = {
		local_missionary_strength = 0.01
		#VU AddOn new effect. Giving the temple the same bonus of this building's upgrade, simply weaker. Makes it more useful when it is too late in the game to make money back from building cost.
		
		local_tax_modifier = 0.5
		#Changed this from 0.3 to 0.5 since temples were really not worth it from an economic POV. Higher taxation should make it worthwhile in high dev provinces.
	}
	on_built = {
		on_built_tax_building_effect = yes
		on_province_tax_building_built_estate_privileges_effect = yes
		add_development_from_building = {
			building = temple
			type = tax
			value = 1
		}
		if = {
			limit = {
				FROM = { has_government_attribute = on_church_built_clergy_loyalty }
			}
			FROM = {
				add_estate_loyalty = {
					estate = estate_church
					loyalty = 2
				}
			}
		}
		if = {
			limit = {
				FROM = { has_government_attribute = temples_modifier }
				owned_by = FROM 
			}
			add_province_modifier = {
				name = gov_expanded_temple_rights_mod
				duration = -1
			}
		}
		if = {
			limit = {
				FROM = {
					has_country_flag = mosque_local_unrest_flag
				}
			}
			add_province_modifier = {
				name = turkoman_peaceful_worshipping
				duration = -1
			}
		}
		if = {
			limit = {
				FROM = { has_country_modifier = mam_mosque_great_mosque_generates_crown_land_modifier }
			}
			FROM = {
				change_estate_land_share = {
					estate = all
					share = -0.25
				}
			}
		}
		if = {
			limit = {
				FROM = { has_government_mechanic = blood_gathering_mechanic }
			}
			FROM = {
				add_government_power = {
					mechanic_type = blood_gathering_mechanic
					power_type = blood
					value = 0.5
				}
			}
		}
		if = {
			limit = {
				FROM = { has_country_flag = azt_temples_buffs_flag }
			}
			add_province_modifier = {
				name = azt_religious_classes
				duration = -1
				hidden = yes
			}
		}
	}
	on_destroyed = {
		on_province_tax_building_destroyed_estate_privileges_effect = yes
		remove_development_from_building = {
			building = temple
			type = tax
			value = 1
		}
		if = {
			limit = {
				FROM = {
					has_country_flag = mosque_local_unrest_flag
				}
			}
			remove_province_modifier = turkoman_peaceful_worshipping
		}
		if = {
			limit = {
				FROM = { has_government_attribute = on_church_built_clergy_loyalty }
			}
			FROM = {
				add_estate_loyalty = {
					estate = estate_church
					loyalty = -2
				}
			}
		}
		remove_province_modifier = gov_expanded_temple_rights_mod
		if = {
			limit = {
				FROM = { has_country_modifier = mam_mosque_great_mosque_generates_crown_land_modifier }
			}
			FROM = {
				change_estate_land_share = {
					estate = all
					share = 0.25
				}
			}
		}
		if = {
			limit = {
				FROM = { has_government_mechanic = blood_gathering_mechanic }
			}
			FROM = {
				add_government_power = {
					mechanic_type = blood_gathering_mechanic
					power_type = blood
					value = -1
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = azt_religious_classes
			}
			remove_province_modifier = azt_religious_classes
		}
	}
	on_obsolete = {
		if = {
			limit = {
				has_province_modifier = estate_nobles_development_of_castles_mod
			}
			remove_province_modifier = estate_nobles_development_of_castles_mod
		}
	}

	onmap = yes

	ai_will_do = {
		factor = 1 #Lots of logic in code instead, that multiplies with this value

		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 2 }
		}
		#FROM AUTONOMY
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 200 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			base_tax = 4
		}
		modifier = {
			factor = 6.0
			base_tax = 6
		}
		modifier = {
			factor = 9.0
			base_tax = 8
		}
		#FROM TRADE GOODS
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_tax = 3
		}
		modifier = {
			factor = 3.5
			base_tax = 5
		}
		modifier = {
			factor = 6.5
			base_tax = 7
		}
		
		#GENERAL
		#AI is encouraged to build this where they need to convert the local population
		modifier = {
			factor = 1.5
			has_owner_religion = no			
		}
		
		#Theocracies will build more temples.
		modifier = {
			factor = 2.0
			FROM = { government = theocracy }			
		}
		modifier = {
			factor = 100.0
			num_free_building_slots = 3
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 2 Taxation - Cathedral
cathedral = {
	make_obsolete = temple
	cost = 500 #VU - Increased from 300 to 500 in v1.36.2.* by San Felipe
	time = 24
	modifier = {
		local_missionary_strength = 0.03
		local_tax_modifier = 0.75
	}
	#VU AddOn changed price from 300. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	#VU AddOn changed from 12. Doubling upgraded buildings' build time.
	on_built = {
		on_built_tax_building_effect = yes
		on_province_tax_building_built_estate_privileges_effect = yes
		add_development_from_upgrading_or_building = {
			building = cathedral
			obsolete_building = temple
			type = tax
			value = 2
			upgrade_value = 1
		}
		if = {
			limit = {
				FROM = { has_government_attribute = on_church_built_clergy_loyalty }
			}
			FROM = {
				add_estate_loyalty = {
					estate = estate_church
					loyalty = 5
				}
			}
		}
		if = {
			limit = {
				FROM = { has_government_attribute = temples_modifier }
				owned_by = FROM 
			}
			add_province_modifier = {
				name = gov_expanded_temple_rights_mod
				duration = -1
			}
		}
		if = {
			limit = {
				FROM = {
					has_country_flag = mosque_local_unrest_flag
				}
			}
			add_province_modifier = {
				name = turkoman_peaceful_worshipping
				duration = -1
			}
		}
		if = {
			limit = {
				FROM = { has_country_modifier = mam_mosque_great_mosque_generates_crown_land_modifier }
			}
			FROM = {
				change_estate_land_share = {
					estate = all
					share = -0.25
				}
			}
		}
		if = {
			limit = {
				FROM = { has_government_mechanic = blood_gathering_mechanic }
			}
			FROM = {
				add_government_power = {
					mechanic_type = blood_gathering_mechanic
					power_type = blood
					value = 0.5
				}
			}
		}
	}
	on_destroyed = {
		on_province_tax_building_destroyed_estate_privileges_effect = yes
		remove_development_from_building = {
			building = cathedral
			type = tax
			value = 2
		}
		if = {
			limit = {
				FROM = {
					has_country_flag = mosque_local_unrest_flag
				}
			}
			remove_province_modifier = turkoman_peaceful_worshipping
		}
		if = {
			limit = {
				FROM = { has_government_attribute = on_church_built_clergy_loyalty }
			}
			FROM = {
				add_estate_loyalty = {
					estate = estate_church
					loyalty = -5
				}
			}
		}
		remove_province_modifier = gov_expanded_temple_rights_mod
		if = {
			limit = {
				FROM = { has_country_modifier = mam_mosque_great_mosque_generates_crown_land_modifier }
			}
			FROM = {
				change_estate_land_share = {
					estate = all
					share = 0.25
				}
			}
		}
		if = {
			limit = {
				FROM = { has_government_mechanic = blood_gathering_mechanic }
			}
			FROM = {
				add_government_power = {
					mechanic_type = blood_gathering_mechanic
					power_type = blood
					value = -1
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = azt_religious_classes
			}
			remove_province_modifier = azt_religious_classes
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 4
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_tax = 3
		}
		modifier = {
			factor = 3.5
			base_tax = 5
		}
		modifier = {
			factor = 6.5
			base_tax = 7
		}
		
		#GENERAL		
		#AI is encouraged to build this where they need to convert the local population
		modifier = {
			factor = 1.5
			has_owner_religion = no			
		}
		
		#Theocracies will build more temples.
		modifier = {
			factor = 2.0
			FROM = { government = theocracy }			
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

#Tier 3 Taxation - Grand Cathedral
grand_cathedral = {
    make_obsolete = cathedral
	cost = 750 #VU - Increased from 400 to 750 in v1.36.2.* by San Felipe
	time = 36
	modifier = {
		local_missionary_strength = 0.05
		local_tax_modifier = 1.0
	}

	on_built = {
		on_province_tax_building_built_estate_privileges_effect = yes
		add_development_from_upgrading_or_building = {
			building = grand_cathedral
			obsolete_building = cathedral
			type = tax
			value = 3
			upgrade_value = 1
		}
		if = {
			limit = {
				FROM = { has_government_attribute = on_church_built_clergy_loyalty }
			}
			FROM = {
				add_estate_loyalty = {
					estate = estate_church
					loyalty = 7
				}
			}
		}
		if = {
			limit = {
				FROM = { has_government_attribute = temples_modifier }
				owned_by = FROM 
			}
			add_province_modifier = {
				name = gov_expanded_temple_rights_mod
				duration = -1
			}
		}
	}
	on_destroyed = {
		on_province_tax_building_destroyed_estate_privileges_effect = yes
		remove_development_from_building = {
			building = grand_cathedral
			type = tax
			value = 3
		}
		if = {
			limit = {
				FROM = { has_government_attribute = on_church_built_clergy_loyalty }
			}
			FROM = {
				add_estate_loyalty = {
					estate = estate_church
					loyalty = -7
				}
			}
		}
		remove_province_modifier = gov_expanded_temple_rights_mod
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 6
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 800 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_tax = 3
		}
		modifier = {
			factor = 3.5
			base_tax = 5
		}
		modifier = {
			factor = 6.5
			base_tax = 7
		}
		
		#GENERAL		
		#AI is encouraged to build this where they need to convert the local population
		modifier = {
			factor = 1.5
			has_owner_religion = no			
		}
		
		#Theocracies will build more temples.
		modifier = {
			factor = 2.0
			FROM = { government = theocracy }			
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 47500
			}
		}
	}
}

################################################

### TRANSPORTATION

#Tier 1 Transportation - Road System
road_system = {
	cost = 100 #VU - Kept at 100 in v1.36.2.* by San Felipe
	time = 6
	
	modifier = {
		local_friendly_movement_speed = 0.15
		#Transportation infrastructure was made, first and foremost, to allow faster movement of armies across long distances.
		
		local_institution_spread = 0.1
		#Any infrastructure that allows for an easier flow of people and goods subsequently allows for an easier flow of information. This should represent that.
		
		local_development_cost = -0.1
		#Roads moderately improved the development of any cities it connected to by facilitating the transport of people and goods.
		
		trade_goods_size_modifier = 0.1
		#Roads were important in boosting the production of local goods.
		
		province_trade_power_modifier = 0.1
		#Roads played a crucial role in trade power as it allowed for the speedy transportation of local and domestic goods.
		
		allowed_num_of_buildings = 1
		#This allows for improved transportation between urban and rural areas, so buildings can be made when otherwise they would be too far to get to.
		#Also serves the gameplay function of tecnically not costing a building slot.
	}
	
	on_built = {
		add_development_from_building = {
			building = road_network
			type = production
			value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = road_network
			type = production
			value = 1
		}
	}

	ai_will_do = {
		factor = 50
		
		### ECONOMY
		
		#AI avoids building with loans.
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.2
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.4
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit.
		modifier = {
			factor = 0.5
			owner = { is_in_deficit = yes }
		}
		
		#AI avoids building when it doesn't have a lot of money.
		modifier = {
			factor = 0.5
			owner = { NOT = { treasury = 100 } }
		}
		
		### GENERAL
		
		#AI is VERY encouraged to build in its capital.
		modifier = {
			factor = 20
			is_capital = yes
		}
		
		#AI is VERY encouraged to build in capital area.
		modifier = {
			factor = 10
			is_in_capital_area = yes
		}
		
		#AI is encouraged to build in provinces with primary culture.
		modifier = {
			factor = 3
			has_owner_culture = yes
		}
		
		#AI is encouraged to build in provinces with high development.
		modifier = {
			factor = 2
			development = 15 #5/5/5
		}
		modifier = {
			factor = 4
			development = 30 #10/10/10
		}
		modifier = {
			factor = 6
			development = 45 #15/15/15
		}
		modifier = {
			factor = 8
			development = 60 #20/20/20
		}
		modifier = {
			factor = 10
			development = 75 #25/25/25
		}
		
		#AI is discouraged to build in provinces that are not accepted cultures.
		modifier = {
			factor = 0.75
			has_owner_accepted_culture = no
		}
		
		#AI is discouraged to build in provinces with different religion.
		modifier = {
			factor = 0.75
			has_owner_religion = no
		}
		
		### ADJACENT
		
		#AI is encouraged to build nearby other infrastructure buildings.
		modifier = {
			factor = 2
			any_neighbor_province = {
				has_building = road_system
			}
		}
		modifier = {
			factor = 4
			any_neighbor_province = {
				has_building = canal_system
			}
		}
		modifier = {
			factor = 6
			any_neighbor_province = {
				has_building = railway_system
			}
		}
		
		#AI is encouraged to build in provinces with forts.
		modifier = {
			factor = 3
			has_building = fort_15th
		}
		modifier = {
			factor = 6
			has_building = fort_16th
		}
		modifier = {
			factor = 9
			has_building = fort_17th
		}
		modifier = {
			factor = 12
			has_building = fort_18th
		}
		
		#AI is encouraged to build nearby forts.
		modifier = {
			factor = 2
			any_neighbor_province = {
				has_building = fort_15th
			}
		}
		modifier = {
			factor = 4
			any_neighbor_province = {
				has_building = fort_16th
			}
		}
		modifier = {
			factor = 6
			any_neighbor_province = {
				has_building = fort_17th
			}
		}
		modifier = {
			factor = 8
			any_neighbor_province = {
				has_building = fort_18th
			}
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
		#modifier = {
	    #	local_friendly_movement_speed = 0.2
	    #	province_trade_power_modifier = 0.2
	    #	allowed_num_of_buildings = 1
	    #}
	}
}

#Tier 2 Transportation - Canal System
canal_system = {
	cost = 150 #VU - Increased from 100 to 150 in v1.36.2.* by San Felipe
	time = 12
	
	make_obsolete = road_system
	
	modifier = {
		local_friendly_movement_speed = 0.25
		#Transportation infrastructure was made, first and foremost, to allow faster movement of armies across long distances.
		
		local_institution_spread = 0.2
		#Any infrastructure that allows for an easier flow of people and goods subsequently allows for an easier flow of information. This should represent that.
		
		local_development_cost = -0.15
		#Canals significantly improved the development of any cities it connected to by facilitating the transport of people and goods substantially.
		
		trade_goods_size_modifier = 0.20
		#Canals were significant in boosting the production of local goods.
		
		province_trade_power_modifier = 0.20
		#Canals played a crucial role in trade power, generating modest wealth for those lucky enough to invest in this alternative form of goods transportation.
		
		allowed_num_of_buildings = 1
		#This allows for improved transportation between urban and rural areas, so buildings can be made when otherwise they would be too far to get to.
		#Also serves the gameplay function of tecnically not costing a building slot.
	}
	
	build_trigger = {
		AND = {
			#Can only build if province is coastal or a neighbouring province has it
			OR = {
				has_port = yes
				any_neighbor_province = {
					has_building = canal_system
				}
			}
			
			#Can't build if province has a terrain not suitable for canals.
			NOT = {
				OR = {
					has_terrain = mountain
				    has_terrain = cold_mountains
				    has_terrain = desert_ranges
				    has_terrain = tundra_terrain
				    has_terrain = glacier
				}
			}
		}
	}
	ai_will_do = {
		factor = 100
		### ECONOMY
		#AI avoids building with loans.
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit.
		modifier = {
			factor = 0.5
			owner = { is_in_deficit = yes }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		#AI avoids building when it doesn't have a lot of money.
		modifier = {
			factor = 0.5
			owner = { NOT = { treasury = 200 } }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 10
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30
			province_has_center_of_trade_of_level = 3
		}
		### GENERAL
		#AI is VERY encouraged to build in its capital.
		modifier = {
			factor = 20
			is_capital = yes
		}
		#AI is VERY encouraged to build in capital area.
		modifier = {
			factor = 10
			is_in_capital_area = yes
		}
		
		#AI is encouraged to build in coastal provinces.
		modifier = {
			factor = 2
			has_port = yes
		}
		#AI is encouraged to build in provinces with primary culture.
		modifier = {
			factor = 3
			has_owner_culture = yes
		}
		#AI is encouraged to build in provinces with high development.
		modifier = {
			factor = 2
			development = 15 #5/5/5
		}
		modifier = {
			factor = 4
			development = 30 #10/10/10
		}
		modifier = {
			factor = 6
			development = 45 #15/15/15
		}
		modifier = {
			factor = 8
			development = 60 #20/20/20
		}
		modifier = {
			factor = 10
			development = 75 #25/25/25
		}
		#AI is discouraged to build in provinces that are not accepted cultures.
		modifier = {
			factor = 0.75
			has_owner_accepted_culture = no
		}
		#AI is discouraged to build in provinces with different religion.
		modifier = {
			factor = 0.75
			has_owner_religion = no
		}
		### ADJACENT
		#AI is encouraged to build nearby other infrastructure buildings.
		modifier = {
			factor = 2
			any_neighbor_province = {
				has_building = road_system
			}
		}
		modifier = {
			factor = 4
			any_neighbor_province = {
				has_building = canal_system
			}
		}
		modifier = {
			factor = 6
			any_neighbor_province = {
				has_building = railway_system
			}
		}
		#AI is encouraged to build in provinces with forts.
		modifier = {
			factor = 3
			has_building = fort_15th
		}
		modifier = {
			factor = 6
			has_building = fort_16th
		}
		modifier = {
			factor = 9
			has_building = fort_17th
		}
		modifier = {
			factor = 12
			has_building = fort_18th
		}
		#AI is encouraged to build nearby forts.
		modifier = {
			factor = 2
			any_neighbor_province = {
				has_building = fort_15th
			}
		}
		modifier = {
			factor = 4
			any_neighbor_province = {
				has_building = fort_16th
			}
		}
		modifier = {
			factor = 6
			any_neighbor_province = {
				has_building = fort_17th
			}
		}
		modifier = {
			factor = 8
			any_neighbor_province = {
				has_building = fort_18th
			}
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 47500
			}
		}
		### UPGRADE
		#AI is encouraged to build in coastal provinces.
		modifier = {
			factor = 2
			has_port = yes
		}
		#AI is encouraged to upgrade infrastructure buildings.
		modifier = {
			factor = 2
			has_building = road_system
		}
	}
}

#Tier 3 Transportation - Railway System
railway_system = {
	cost = 300 #VU - Increased from 250 to 300 in v1.36.2.* by San Felipe
	time = 18
	
	make_obsolete = canal_system
	
	#Changed cost from 400. While railways should be expensive, they shouldn't be as expensive as entire buildings.
	#Changed time from 12 because railways are significantly better than roads and canals.
	
	#Removed the DLC requirements so those that don't have them can still have railways.
	#Change the building triggers to favour terrain restrictions instead of coal production, railway adjacency or rail boom.
	
	build_trigger = {
		#Can't build if province has a terrain not suitable for railways.
		NOT = {
			OR = {
				#has_terrain = mountain       #VU - Hashed these out as it doesn't really make any sense that you can't build railroads in or on top mountains.
			    #has_terrain = cold_mountains
			    #has_terrain = desert_ranges
			    #has_terrain = tundra_terrain
			    has_terrain = glacier
			}
		}
	}
	
	modifier = {
		local_friendly_movement_speed = 0.5
		#Transportation infrastructure was made, first and foremost, to allow faster movement of armies across long distances.
		#Should go without saying that railways were the best infrastructure possible at the time, so they have the largest bonus to movement speed.
		
		local_institution_spread = 0.4
		#Any infrastructure that allows for an easier flow of people and goods subsequently allows for an easier flow of information. This should represent that.
		
		local_development_cost = -0.25
		#Railways drastically improved the development of any cities it connected to by facilitating the transport of people and goods substantially.
		
		trade_goods_size_modifier = 0.35
		#Railways were vital in boosting the production of local goods.
		
		province_trade_power_modifier = 0.5
		#Railways played a superior role in trade power, generating vast somes of wealth for those lucky enough to invest in this speedy form of goods transportation.
		
		allowed_num_of_buildings = 2
		#This allows for improved transportation between urban and rural areas, so buildings can be made when otherwise they would be too far to get to.
	}

	ai_will_do = {
		factor = 150
		
		### ECONOMY
		
		#AI avoids building with loans.
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.2
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.4
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit.
		modifier = {
			factor = 0.5
			owner = { is_in_deficit = yes }
		}
		
		#AI avoids building when it doesn't have a lot of money.
		modifier = {
			factor = 0.5
			owner = { NOT = { treasury = 400 } }
		}
		
		### GENERAL
		
		#AI is VERY encouraged to build in its capital.
		modifier = {
			factor = 20
			is_capital = yes
		}
		
		#AI is VERY encouraged to build in capital area.
		modifier = {
			factor = 10
			is_in_capital_area = yes
		}
		
		#AI is encouraged to build in provinces with primary culture.
		modifier = {
			factor = 3
			has_owner_culture = yes
		}
		
		#AI is encouraged to build in provinces with high development.
		modifier = {
			factor = 2
			development = 15 #5/5/5
		}
		modifier = {
			factor = 4
			development = 30 #10/10/10
		}
		modifier = {
			factor = 6
			development = 45 #15/15/15
		}
		modifier = {
			factor = 8
			development = 60 #20/20/20
		}
		modifier = {
			factor = 10
			development = 75 #25/25/25
		}
		
		#AI is discouraged to build in provinces that are not accepted cultures.
		modifier = {
			factor = 0.75
			has_owner_accepted_culture = no
		}
		
		#AI is discouraged to build in provinces with different religion.
		modifier = {
			factor = 0.75
			has_owner_religion = no
		}
		
		### ADJACENT
		
		#AI is encouraged to build nearby other infrastructure buildings.
		modifier = {
			factor = 2
			any_neighbor_province = {
				has_building = road_system
			}
		}
		modifier = {
			factor = 4
			any_neighbor_province = {
				has_building = canal_system
			}
		}
		modifier = {
			factor = 6
			any_neighbor_province = {
				has_building = railway_system
			}
		}
		
		#AI is encouraged to build in provinces with forts.
		modifier = {
			factor = 3
			has_building = fort_15th
		}
		modifier = {
			factor = 6
			has_building = fort_16th
		}
		modifier = {
			factor = 9
			has_building = fort_17th
		}
		modifier = {
			factor = 12
			has_building = fort_18th
		}
		
		#AI is encouraged to build nearby forts.
		modifier = {
			factor = 2
			any_neighbor_province = {
				has_building = fort_15th
			}
		}
		modifier = {
			factor = 4
			any_neighbor_province = {
				has_building = fort_16th
			}
		}
		modifier = {
			factor = 6
			any_neighbor_province = {
				has_building = fort_17th
			}
		}
		modifier = {
			factor = 8
			any_neighbor_province = {
				has_building = fort_18th
			}
		}
		
		### UPGRADE
		
		#AI is encouraged to build in coastal provinces.
		modifier = {
			factor = 2
			has_port = yes
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 97500
			}
		}
		#AI is encouraged to upgrade infrastructure buildings.
		modifier = {
			factor = 2
			has_building = road_system
		}
		modifier = {
			factor = 4
			has_building = canal_system
		}
	}
}

################################################

### COASTAL DEFENCE

#Tier 1 Coastal - Naval Base
naval_base = {
	cost = 250 #VU - Increased from 100 to 250 in v1.36.2.* by San Felipe
	time = 12
	
	build_trigger = {
		has_port = yes
	}
	
	modifier = {
		blockade_force_required = 0.5
		hostile_disembark_speed = 0.5
		
		hostile_fleet_attrition = 1
		#Added so, firstly, this building is worth it, and secondly, to add a way to counter blockades even if just a little.
		
		block_slave_raid = yes
	}

	ai_will_do = {
		factor = 1
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.25
            owner = { NOT = { treasury = 10000 } }
        }
		modifier = {
			factor = 1000.0
			is_capital = yes
		}
	}
}

#Tier 2 Coastal - Naval Arsenal
naval_arsenal = {
	cost = 500
	time = 24
	build_trigger = {
		has_port = yes
	}
	make_obsolete = naval_base
	modifier = {
		blockade_force_required = 1.0
		hostile_disembark_speed = 2.0
		hostile_fleet_attrition = 5
		#Added so, firstly, this building is worth it, and secondly, to add a way to counter blockades even if just a little.
		block_slave_raid = yes
	}

	ai_will_do = {
		factor = 1
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 15000 } }
        }
	}
}

#Tier 3 Coastal - Coastal Artillery
coastal_artillery = {
	cost = 750
	time = 36
	
	build_trigger = {
		has_port = yes
	}
	
	make_obsolete = naval_arsenal
	modifier = {
		blockade_force_required = 2.0
		hostile_disembark_speed = 2.0
		
		hostile_fleet_attrition = 5
		#By now provinces with this should be able to counter the late-game naval powers, but not cripple them.
		
		block_slave_raid = yes
	}

	ai_will_do = {
		factor = 2
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 18000 } }
        }
		modifier = {
			factor = 1000.0
			is_capital = yes
		}
	}
}

################################################

### DEFENSE

#Tier 1 Fortification - Castle
fort_15th = {
	cost = 250 #VU - Increased from 200 to 250 in v1.36.2.* by San Felipe
	time = 12
	#VU AddOn changed price from original 200. Castles were way too cheap to build but also too expensive to maintain in VU. Note upkeep is controlled in defines and is generated based on fort level, I believe with reduced fort levels the vanilla .5 per month per level is fine
	#Time changed from 30 to 24 so fort levels are 2y, 3y, 4y and 5y respectively.
	modifier = {
		fort_level = 1
		#VU AddOn changed from original 2. Fort levels are just ridiculous in vanilla and require far too many cannons, especially at later levels. After some testing, I'm content with my new 1-2-3-5 system.
		
		local_unrest = -0.5
		#VU AddOn new. The days of controling a region by building a castle there were largely over by the later EU4 period, but I really like the concept of forts establishing a permanent military presence, much like friendly troops in the province reduce unrest. Also want another bonus to justify cost
		
		local_defensiveness = 0.25
		#VU AddOn new. The point of weakening forts isn't to speed up the game, or make conquest easier or faster, but rather to reduce how mandatory cannons and obscenely large armies are for sieges. Local defensiveness slows things back down after reducing fort levels.
	}
	
	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
	on_built = {
		if = {
			limit = {
				FROM = { NOT = { mil_tech = 14 } has_government_attribute = on_fort_built_nobles_loyalty }
			}
			FROM = {
				if = {
					limit = {
						has_estate = estate_nobles
					}
					add_estate_loyalty = {
						estate = estate_nobles
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_maratha
					}
					add_estate_loyalty = {
						estate = estate_maratha
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_rajput
					}
					add_estate_loyalty = {
						estate = estate_rajput
						loyalty = 5
					}
				}
			}
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_development_of_castles
				}
				NOT = { has_province_modifier = estate_nobles_development_of_castles_mod }
			}
			add_province_modifier = {
				name = estate_nobles_development_of_castles_mod
				duration = -1
			}
		}
		if = {
			limit = {
				FROM = {
					has_country_flag = orm_forts_trade_power_buff_flag
				}
			}
			add_province_modifier = {
				name = orm_forts_buff
				duration = -1
				hidden = yes
			}
		}
		if = {
			limit = {
				owner = {
					has_country_flag = ned_buffed_forts_flag
					NOT = {
						full_idea_group = defensive_ideas
					}
				}
				region = low_countries_region
			}
			add_province_modifier = {
				name = ned_low_countries_fort_buff
				duration = -1
				hidden = yes
			}
		}
		else_if = {
			limit = {
				owner = {
					has_country_flag = ned_buffed_forts_flag
					full_idea_group = defensive_ideas
				}
				region = low_countries_region
			}
			add_province_modifier = {
				name = ned_low_countries_fort_buff_buffed
				duration = -1
				hidden = yes
			}
		}
		if = {
			limit = { 
				owner = { has_country_flag = ven_defensive_reward_flag }
				NOT = { has_province_modifier = ven_defensive_stance_modifier } 
			}
			add_province_modifier = {
				name = ven_defensive_stance_modifier
				duration = -1
				hidden = yes
			}
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_vegvar_system
				}
				any_neighbor_province = {
					NOT = { owned_by = ROOT }
				}
			}
			add_province_modifier = {
				name = estate_nobles_vegvar_system_modifier
				duration = -1
			}
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
	on_destroyed = {
		if = {
			limit = {
				has_province_modifier = estate_nobles_vegvar_system_modifier
			}
			remove_province_modifier = estate_nobles_vegvar_system_modifier
		}
		if = {
			limit = {
				has_province_modifier = estate_nobles_development_of_castles_mod
			}
			remove_province_modifier = estate_nobles_development_of_castles_mod
		}
		if = {
			limit = {
				has_province_modifier = ven_defensive_stance_modifier
			}
			remove_province_modifier = ven_defensive_stance_modifier
		}
		if = {
			limit = {
				has_province_modifier = orm_forts_buff
			}
			remove_province_modifier = orm_forts_buff
		}
		if = {
			limit = {
				has_province_modifier = ned_low_countries_fort_buff
			}
			remove_province_modifier = ned_low_countries_fort_buff
		}
		if = {
			limit = {
				has_province_modifier = ned_low_countries_fort_buff_buffed
			}
			remove_province_modifier = ned_low_countries_fort_buff_buffed
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
	on_obsolete = {
	}

	onmap = yes
	influencing_fort = yes

	ai_will_do = {
		factor = 1 #Lots of logic in code instead, that multiplies with this value - Hahahahaha! Very funny PDX, very funny. :P
        
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 400 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1000 }
		}
		
		#AI less likely to build forts right next to each other
		modifier = {
			factor = 0.1
			any_neighbor_province = {
				OR = {
					has_building = fort_15th
					has_building = fort_16th
					has_building = fort_17th
					has_building = fort_18th
				}
			}
		}
		
		#GENERAL
		#AI would want to fortify their home province.
		modifier = {
			factor = 2
			is_capital = yes			
		}
		
		#Being a march encourages building forts
		modifier = {
			factor = 1.5
			FROM = { is_march = yes }
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 20 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.95
			NOT = { FROM = { army_tradition = 40 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.05
			FROM = { army_tradition = 60 }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 80 }			
		}
		
		#Partly for gameplay, but Europe became insanely fortified during this period
		modifier = {
			factor = 1.25
			FROM = { 
				OR = {
					technology_group = western
					technology_group = dutch_tech_group
					technology_group = english_tech_group
					technology_group = french_tech_group
					technology_group = german_tech_group
					technology_group = italian_tech_group
					technology_group = portuguese_tech_group
					technology_group = roman_tech_group
					technology_group = scandinavian_tech_group
					technology_group = spanish_tech_group
					technology_group = swiss_tech_group
				}
		    }
		}
		
		#Note Eastern, Ottoman, Muslim, East African, Indian, and Chinese tech groups receive no penalty nor bonus
		
		#Partly for gameplay, but these techs didn't really have the castle-every-100-meters thing going on for the most part
		modifier = {
			factor = 0.75
			FROM = {			
				OR = {
					technology_group = central_african
					technology_group = nomad_group
					technology_group = sub_saharan
					technology_group = north_american
					technology_group = mesoamerican
					technology_group = south_american
					technology_group = andean
				}
			}
		}
	}
}

#Tier 2 Fortification - Bastion
fort_16th = {
	cost = 500 #VU - Increased from 400 to 500 in v1.36.2.* by San Felipe
	time = 24
	make_obsolete = fort_15th
	modifier = {
		#VU AddOn changed from 4
		fort_level = 2
		
		#VU AddOn new
		local_unrest = -1.0
		
		#VU AddOn new
		local_defensiveness = 0.5
	}

	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
	on_built = {
		if = {
			limit = {
				FROM = { NOT = { mil_tech = 19 } has_government_attribute = on_fort_built_nobles_loyalty }
			}
			FROM = {
				if = {
					limit = {
						has_estate = estate_nobles
					}
					add_estate_loyalty = {
						estate = estate_nobles
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_maratha
					}
					add_estate_loyalty = {
						estate = estate_maratha
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_rajput
					}
					add_estate_loyalty = {
						estate = estate_rajput
						loyalty = 5
					}
				}
			}
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_development_of_castles
				}
				NOT = { has_province_modifier = estate_nobles_development_of_castles_mod }
			}
			add_province_modifier = {
				name = estate_nobles_development_of_castles_mod
				duration = -1
			}
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
	on_destroyed = {
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
	on_obsolete = {
		if = {
			limit = {
				has_province_modifier = estate_nobles_development_of_castles_mod
			}
			remove_province_modifier = estate_nobles_development_of_castles_mod
		}
	}

	onmap = yes

	influencing_fort = yes

	ai_will_do = {
		factor = 1 #Lots of logic in code instead, that multiplies with this value
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1200 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 2000 }
		}
		
		#AI less likely to build forts right next to each other
		modifier = {
			factor = 0.1
			any_neighbor_province = {
				OR = {
					has_building = fort_15th
					has_building = fort_16th
					has_building = fort_17th
					has_building = fort_18th
				}
			}
		}
		
		#GENERAL
		#AI would want to fortify their home province.
		modifier = {
			factor = 2
			is_capital = yes			
		}
		
		#VU Addon New factors, range 51 percent to 216.5625 percent
		
		#Being a march encourages building forts
		modifier = {
			factor = 1.5
			FROM = { is_march = yes }
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 20 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.95
			NOT = { FROM = { army_tradition = 40 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.05
			FROM = { army_tradition = 60 }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 80 }			
		}
		
		#Partly for gameplay, but Europe became insanely fortified during this period
		modifier = {
			factor = 1.25
			FROM = { 
				OR = {
					technology_group = western
					technology_group = dutch_tech_group
					technology_group = english_tech_group
					technology_group = french_tech_group
					technology_group = german_tech_group
					technology_group = italian_tech_group
					technology_group = portuguese_tech_group
					technology_group = roman_tech_group
					technology_group = scandinavian_tech_group
					technology_group = spanish_tech_group
					technology_group = swiss_tech_group
				}
		    }			
		}
		
		#Note Eastern, Ottoman, Muslim, East African, Indian, and Chinese tech groups receive no penalty nor bonus
		
		#Partly for gameplay, but these techs didn't really have the castle-every-100-meters thing going on for the most part
		modifier = {
			factor = 0.67
			FROM = {			
				OR = {
					technology_group = central_african
					technology_group = nomad_group
					technology_group = sub_saharan
					technology_group = north_american
					technology_group = mesoamerican
					technology_group = south_american
					technology_group = andean
				}
			}
		}
	}
}

#Tier 3 Fortification - Star Fort
fort_17th = {
	cost = 750 #VU - Increased from 400 to 750 in v1.36.2.* by San Felipe
	time = 36

	make_obsolete = fort_16th

	modifier = {
		#VU AddOn changed from 6
		fort_level = 3
		#VU AddOn new
		local_unrest = -1.5
		#VU AddOn new
		local_defensiveness = 0.75
	}

	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
	on_built = {
		if = {
			limit = {
				FROM = { NOT = { mil_tech = 19 } has_government_attribute = on_fort_built_nobles_loyalty }
			}
			FROM = {
				if = {
					limit = {
						has_estate = estate_nobles
					}
					add_estate_loyalty = {
						estate = estate_nobles
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_maratha
					}
					add_estate_loyalty = {
						estate = estate_maratha
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_rajput
					}
					add_estate_loyalty = {
						estate = estate_rajput
						loyalty = 5
					}
				}
			}
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_development_of_castles
				}
				NOT = { has_province_modifier = estate_nobles_development_of_castles_mod }
			}
			add_province_modifier = {
				name = estate_nobles_development_of_castles_mod
				duration = -1
			}
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
	on_destroyed = {
		if = {
			limit = {
				has_province_modifier = estate_nobles_development_of_castles_mod
			}
			remove_province_modifier = estate_nobles_development_of_castles_mod
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
	on_obsolete = {
	}

	onmap = yes

	influencing_fort = yes

	ai_will_do = {
		factor = 1 #Lots of logic in code instead, that multiplies with this value
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 1200 } }
        }
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 2400 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 3600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 4800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 6000 }
		}
		#GENERAL
		#AI would want to fortify their home province.
		modifier = {
			factor = 2
			is_capital = yes			
		}
		#Being a march encourages building forts
		modifier = {
			factor = 1.5
			FROM = { is_march = yes }
		}
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 20 } }			
		}
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.95
			NOT = { FROM = { army_tradition = 40 } }			
		}
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.05
			FROM = { army_tradition = 60 }			
		}
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 80 }			
		}
		#Partly for gameplay, but Europe became insanely fortified during this period
		modifier = {
			factor = 1.25
			FROM = { 
				OR = {
					technology_group = western
					technology_group = dutch_tech_group
					technology_group = english_tech_group
					technology_group = french_tech_group
					technology_group = german_tech_group
					technology_group = italian_tech_group
					technology_group = portuguese_tech_group
					technology_group = roman_tech_group
					technology_group = scandinavian_tech_group
					technology_group = spanish_tech_group
					technology_group = swiss_tech_group
				}
		    }
		}
		#Note Eastern, Ottoman, Muslim, East African, Indian, and Chinese tech groups receive no penalty nor bonus
		#Partly for gameplay, but these techs didn't really have the castle-every-100-meters thing going on for the most part
		modifier = {
			factor = 0.5
			FROM = {			
				OR = {
					technology_group = central_african
					technology_group = nomad_group
					technology_group = sub_saharan
					technology_group = north_american
					technology_group = mesoamerican
					technology_group = south_american
					technology_group = andean
				}
			}
		}
	}
}

#Tier 4 Fortification - Fortress
fort_18th = {
	cost = 1000 #VU - Increased from 800 to 1000 in v1.36.2.* by San Felipe
	time = 48
	#VU AddOn cost changed from original 800
	#Time changed from 72 to 96 so fort levels are 1y, 2y, 3y and 4y respectively.
	make_obsolete = fort_17th

	modifier = {
		#VU - Changed from TGE's 8
		fort_level = 5
		
		#VU AddOn new
		local_unrest = -2.0
		
		#VU AddOn new
		local_defensiveness = 1.0
	}
	
	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
	on_built = {
		if = {
			limit = {
				FROM = { has_government_attribute = on_fort_built_nobles_loyalty }
			}
			FROM = {
				if = {
					limit = {
						has_estate = estate_nobles
					}
					add_estate_loyalty = {
						estate = estate_nobles
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_maratha
					}
					add_estate_loyalty = {
						estate = estate_maratha
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_rajput
					}
					add_estate_loyalty = {
						estate = estate_rajput
						loyalty = 5
					}
				}
			}
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_development_of_castles
				}
				NOT = { has_province_modifier = estate_nobles_development_of_castles_mod }
			}
			add_province_modifier = {
				name = estate_nobles_development_of_castles_mod
				duration = -1
			}
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
	on_destroyed = {
		if = {
			limit = {
				has_province_modifier = estate_nobles_development_of_castles_mod
			}
			remove_province_modifier = estate_nobles_development_of_castles_mod
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
	on_obsolete = {
	}

	onmap = yes

	influencing_fort = yes

	ai_will_do = {
		factor = 1 #Lots of logic in code instead, that multiplies with this value
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 1600 } }
        }
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 3200 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 4800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 6400 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 8000 }
		}
		#GENERAL
		#AI would want to fortify their home province.
		modifier = {
			factor = 2
			is_capital = yes			
		}
		#Being a march encourages building forts
		modifier = {
			factor = 1.5
			FROM = { is_march = yes }
		}
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 20 } }			
		}
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.95
			NOT = { FROM = { army_tradition = 40 } }			
		}
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.05
			FROM = { army_tradition = 60 }			
		}
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 80 }			
		}
		#Partly for gameplay, but Europe became insanely fortified during this period
		modifier = {
			factor = 1.25
			FROM = { 
				OR = {
					technology_group = western
					technology_group = dutch_tech_group
					technology_group = english_tech_group
					technology_group = french_tech_group
					technology_group = german_tech_group
					technology_group = italian_tech_group
					technology_group = portuguese_tech_group
					technology_group = roman_tech_group
					technology_group = scandinavian_tech_group
					technology_group = spanish_tech_group
					technology_group = swiss_tech_group
				}
		    }
		}
		#Note Eastern, Ottoman, Muslim, East African, Indian, and Chinese tech groups receive no penalty nor bonus
		#Partly for gameplay, but these techs didn't really have the castle-every-100-meters thing going on for the most part
		modifier = {
			factor = 0.33
			FROM = {			
				OR = {
					technology_group = central_african
					technology_group = nomad_group
					technology_group = sub_saharan
					technology_group = north_american
					technology_group = mesoamerican
					technology_group = south_american
					technology_group = andean
				}
			}
		}
	}
}

################################################

### FORTIFICATION

#Tier 1 Fortification - Trench
trench = {
	cost = 50
	time = 2
	
	#Not possible to build a trench if the province already has a fort.
	build_trigger = {
		NOT = {
			OR = {
				has_building = fort_15th
			    has_building = fort_16th
			    has_building = fort_17th
			    has_building = fort_18th
			}
		}
	}
	
	modifier = {
		#Trench is equal in defense to a Bastion (Tier 2 Fort) with the exception of not reducing unrest.
		fort_level = 2
		local_defensiveness = 0.5
		
		#Trenches weren't like buildings that took space near city centers, so costing building slots doesn't really suit them.
		allowed_num_of_buildings = 1
		
		#While many died in trenches due to warfare, deaths caused by their terrible conditions (disease) were just as common.
		attrition = 10
		max_attrition = 10
		
		#To avoid making a trench be just like a fort but cheaper and faster, they're devastating to the development of provinces.
		local_monthly_devastation = 0.5
		local_development_cost = 0.5
	}

	onmap = yes
	influencing_fort = yes

	ai_will_do = {
		factor = 1
		
		modifier = {
			factor = 0
			NOT = {
				any_neighbor_province = {
					NOT = {
						controller = { tag = ROOT }
					}
				}	
			}
		}
		
		#AI will only be build during a war
		modifier = {
			factor = 0
			owner = { is_at_war = no }
		}
		
		#AI will build in provinces that border enemy or occupied provinces
		modifier = {
			factor = 2
			any_neighbor_province = {
				controller = {
					war_with = ROOT
				}
			}
		}
	}
}

################################################

### MANUFACTORY

manufactory = {
	cost = 500
	time = 36			#VU AddOn changed from 60. 5 year construction times are way out of line with all other buildings, and quite unneccessary, I think. Reducing this to comparable with other buildings.
	modifier = {
		trade_goods_size = 1.0
	}
}

#If trade good assignment changes, also update scripted trigger "has_manufactory trigger"!

wharf = {
	manufactory = {
		salt
		fish
		naval_supplies
		tropical_wood
		seafood
		tar
	}
	modifier = {
		trade_goods_size = 0.4			#VU Addon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU AddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		naval_forcelimit = 1			#VU AddOn new - Just a fun little new bonus
	}
	keep_trigger = {
		OR = {
			trade_goods = fish
			trade_goods = naval_supplies
			trade_goods = salt
			trade_goods = seafood
			trade_goods = tar
			trade_goods = tropical_wood
		}
	}
	onmap = yes
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
		
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 12			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses. Note vanilla was 1750, but considering this building had the same effect as other manufacturies and they all have factors of 1, I assumed this was a vanilla oversight.
		#VU Addon removed a bunch of modifiers for the same reason as directly above.
		#VU Addon New factors, range 2 percent to about 425 percent
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.4
			NOT = { base_production = 6 }
		}
		modifier = {
			factor = 1.5
			base_production = 10
		}
		modifier = {
			factor = 1.5
			base_production = 15
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		modifier = {
			factor = 0.9
			FROM = { 
				OR = {
					technology_group = eastern
					technology_group = bohemian_tech_group
					technology_group = byzantine_tech_group
					technology_group = hungarian_tech_group
					technology_group = polish_tech_group
					technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 5
			OR = {
				has_province_modifier = skanemarket
				has_province_modifier = comet_ore_modifier
				has_province_modifier = paradise_modifier
			}
		}
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { 
				    	OR = {
				        	technology_group = western
				        	technology_group = dutch_tech_group
				        	technology_group = english_tech_group
				        	technology_group = french_tech_group
				        	technology_group = german_tech_group
				        	technology_group = italian_tech_group
				        	technology_group = portuguese_tech_group
				        	technology_group = roman_tech_group
				        	technology_group = scandinavian_tech_group
				        	technology_group = spanish_tech_group
				        	technology_group = swiss_tech_group
				        }
				    }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			FROM = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.5
			owner = { navy_size_percentage = 0.9 }
		}
		modifier = {
			factor = 1.5
			FROM = { navy_tradition = 50 }
		}
		modifier = {
			factor = 1.1
			base_production = 4
		}
		modifier = {
			factor = 1.2
			base_production = 8
		}
		modifier = {
			factor = 1.4
			base_production = 12
		}
		modifier = {
			NOT = { num_free_building_slots = 3 }
			factor = 1.5
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

weapons = {
	manufactory = {
		copper
		iron
		lead
		mercury
		tin
		metalworking
		munitions
		zinc
		cannon
	}
	modifier = {
		trade_goods_size = 0.4			#VU Addon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU AddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		land_forcelimit = 0.5			#VU AddOn new - Just a fun little new bonus
	}
	onmap = yes
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1
		}
	}
	on_obsolete = {
	}

	keep_trigger = {
		OR = {
			trade_goods = cannon
			trade_goods = copper
			trade_goods = iron
			trade_goods = lead
			trade_goods = mercury
			trade_goods = metalworking
			trade_goods = munitions
			trade_goods = tin
			trade_goods = zinc
		}
	}

	ai_will_do = {
		factor = 12			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		
		modifier = {
			factor = 0.9
			FROM = { 
				OR = {
					technology_group = eastern
					technology_group = bohemian_tech_group
					technology_group = byzantine_tech_group
					technology_group = hungarian_tech_group
					technology_group = polish_tech_group
					technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { 
				    	OR = {
				        	technology_group = western
				        	technology_group = dutch_tech_group
				        	technology_group = english_tech_group
				        	technology_group = french_tech_group
				        	technology_group = german_tech_group
				        	technology_group = italian_tech_group
				        	technology_group = portuguese_tech_group
				        	technology_group = roman_tech_group
				        	technology_group = scandinavian_tech_group
				        	technology_group = spanish_tech_group
				        	technology_group = swiss_tech_group
				        }
				    }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			FROM = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.5
			owner = { army_size_percentage = 0.9 }
		}
		modifier = {
			factor = 1.5
			FROM = { army_tradition = 50 }
		}
		modifier = {
			factor = 1.1
			base_production = 4
		}
		modifier = {
			factor = 1.2
			base_production = 8
		}
		modifier = {
			factor = 1.4
			base_production = 12
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

textile = {
	manufactory = {
		wool
		cloth
		silk
		books
		dyes
		indigo
		uniforms
		lace
	}
	modifier = {
		trade_goods_size = 0.4			#VU Addon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU AddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		local_tax_modifier = 0.25			#VU AddOn new - Just a fun little new bonus
	}
	onmap = yes
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}

	keep_trigger = {
		OR = {
			trade_goods = books
			trade_goods = cloth
			trade_goods = dyes
			trade_goods = indigo
			trade_goods = silk
			trade_goods = uniforms 
			trade_goods = wool
			trade_goods = lace
		}
	}

	ai_will_do = {
		factor = 8			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		
		modifier = {
			factor = 0.9
			FROM = { 
				OR = {
					technology_group = eastern
					technology_group = bohemian_tech_group
					technology_group = byzantine_tech_group
					technology_group = hungarian_tech_group
					technology_group = polish_tech_group
					technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { 
				    	OR = {
				        	technology_group = western
				        	technology_group = dutch_tech_group
				        	technology_group = english_tech_group
				        	technology_group = french_tech_group
				        	technology_group = german_tech_group
				        	technology_group = italian_tech_group
				        	technology_group = portuguese_tech_group
				        	technology_group = roman_tech_group
				        	technology_group = scandinavian_tech_group
				        	technology_group = spanish_tech_group
				        	technology_group = swiss_tech_group
				        }
				    }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			FROM = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.1
			base_tax = 4
		}
		modifier = {
			factor = 1.2
			base_tax = 8
		}
		modifier = {
			factor = 1.4
			base_tax = 12
		}
		modifier = {
			factor = 1.1
			base_production = 4
		}
		modifier = {
			factor = 1.2
			base_production = 8
		}
		modifier = {
			factor = 1.4
			base_production = 12
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

plantations = {
	manufactory = {
		coffee
		cotton
		sugar
        tobacco
		tea
		cocoa
		palm_oil
		saffron
		cinnamon
		cloves
		opium
		dates
		vanilla
		nutmeg
		chocolate
	}
	modifier = {
			#Changed for VU: With different effects of slaves/indentured servants the plantation gets better and better
			#As I don't know how it interacts if the same modifier is 2 times active, I have added them together within the if-clause -Lord_Bowser
		trade_goods_size = 0.4			#VU Addon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU AddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		local_production_efficiency = 0.25			#VU AddOn new - Just a fun little new bonus#
	}
	onmap = yes
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}
	keep_trigger = {
		OR = {
			trade_goods = chocolate
			trade_goods = cinnamon
			trade_goods = cloves
			trade_goods = cocoa
			trade_goods = coffee
			trade_goods = cotton
			trade_goods = dates
			trade_goods = nutmeg
			trade_goods = opium
			trade_goods = palm_oil
			trade_goods = saffron
			trade_goods = sugar
			trade_goods = tea
			trade_goods = tobacco
			trade_goods = vanilla
		}
	}

	ai_will_do = {
		factor = 8			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		modifier = {
			factor = 0.9
			FROM = { 
				OR = {
					technology_group = eastern
					technology_group = bohemian_tech_group
					technology_group = byzantine_tech_group
					technology_group = hungarian_tech_group
					technology_group = polish_tech_group
					technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { 
				    	OR = {
				        	technology_group = western
				        	technology_group = dutch_tech_group
				        	technology_group = english_tech_group
				        	technology_group = french_tech_group
				        	technology_group = german_tech_group
				        	technology_group = italian_tech_group
				        	technology_group = portuguese_tech_group
				        	technology_group = roman_tech_group
				        	technology_group = scandinavian_tech_group
				        	technology_group = spanish_tech_group
				        	technology_group = swiss_tech_group
				        }
				    }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			FROM = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.15
			base_production = 4
		}
		modifier = {
			factor = 1.3
			base_production = 8
		}
		modifier = {
			factor = 1.6
			base_production = 12
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

tradecompany = {
	manufactory = {
		ivory
		slaves
		spices
		fur
		canned_goods
		cider
		cloves
		incense
		whaling
		beer
		rum
		jade
		marble
		gunpowder
		cheese
		carpet
		exotic_animals
		sulfur
		leather
		woodworking
		jewellery
		maple_syrup
		sea_turtle
		cigars
		marble_sculpture
		jade_sculptures
		exotic_fur
		fur_clothing
		String_Instruments
		sweet_confectioneries
	}
	modifier = {
		trade_goods_size = 0.4			#VU Addon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU AddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		province_trade_power_modifier = 0.5			#VU AddOn new - Just a fun little new bonus

			#Changed for VU: With different effects of slaves/indentured servants more spices and cloves get produced
			#As I don't know how it interacts if the same modifier is 2 times active, I have added them together within the if-clause -Lord_Bowser
	}
	onmap = yes
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}
	keep_trigger = {
		OR = {
			trade_goods = beer
			trade_goods = canned_goods
			trade_goods = cider
			trade_goods = carpet
			trade_goods = cheese
			trade_goods = cigars
			trade_goods = cloves
			trade_goods = exotic_animals
			trade_goods = fur
			trade_goods = gunpowder
			trade_goods = incense
			trade_goods = ivory
			trade_goods = jade
			trade_goods = jewellery
			trade_goods = leather
			trade_goods = maple_syrup
			trade_goods = marble
			trade_goods = marble_sculpture
			trade_goods = rum
			trade_goods = sea_turtle
			trade_goods = slaves
			trade_goods = spices
			trade_goods = sulfur
			trade_goods = sweet_confectioneries
			trade_goods = whaling
			trade_goods = woodworking
		}
	}

	ai_will_do = {
		factor = 7			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		
		modifier = {
			factor = 0.9
			FROM = { 
				OR = {
					technology_group = eastern
					technology_group = bohemian_tech_group
					technology_group = byzantine_tech_group
					technology_group = hungarian_tech_group
					technology_group = polish_tech_group
					technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { 
				    	OR = {
				        	technology_group = western
				        	technology_group = dutch_tech_group
				        	technology_group = english_tech_group
				        	technology_group = french_tech_group
				        	technology_group = german_tech_group
				        	technology_group = italian_tech_group
				        	technology_group = portuguese_tech_group
				        	technology_group = roman_tech_group
				        	technology_group = scandinavian_tech_group
				        	technology_group = spanish_tech_group
				        	technology_group = swiss_tech_group
				        }
				    }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			FROM = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.3
			owner = { full_idea_group = trade_ideas }
		}
		modifier = {
			factor = 1.1
			province_trade_power = 5			#Note trade power 5 is 21 dev non coastal with 0 autonomy, starting mercantalism, and no estate. OR 9 dev coastal with 40 mercantalism, 0 autonomy, burgher estate, max tech, and trade national ideas, OR some combination of the two.
		}
		modifier = {
			factor = 1.2
			province_trade_power = 8			#Note 8 trade power is between 31 dev and 14 dev (or 3 dev for CoTs), depending on modifiers, estates, mercantalism, autonomy etc.
		}
		modifier = {
			factor = 1.4
			province_trade_power = 12			#Note 12 trade power is between
		}
		modifier = {
			factor = 1.1
			base_production = 4
		}
		modifier = {
			factor = 1.2
			base_production = 8
		}
		modifier = {
			factor = 1.4
			base_production = 12
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

farm_estate = {
	manufactory = {
		beer
		cider
		fruit
		grain
		livestock
		wine
		apiculture
		rice
		horses
		olive_oil
		camel
		elephants
		citrus
		potato
		maize
		tomato
		champagne
		llama
		millet
		vegetables #Makes sense to have vegetables in a farm doesn't it ?
		vodka
		whiskey
	}
	modifier = {
		trade_goods_size = 0.4			#VU Addon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU AddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		local_production_efficiency = 0.25			#VU AddOn new - Just a fun little new bonus
		
		#Changed for VU: With different effects of serfs farm estates can produce more
		#As I don't know how it interacts if the same modifier is 2 times active, I have added them together within the if-clause -Lord_Bowser
	}
	onmap = yes
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
		if = {
			limit = {
				FROM = {
					has_country_flag = geo_wine_manufactory_flag
				}
			}
			add_base_production = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory 
			type = production 
			value = 2 
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
		if = {
			limit = {
				FROM = {
					has_country_flag = geo_wine_manufactory_flag
				}
			}
			add_base_production = -1
		}
	}
	on_obsolete = {
	}
	keep_trigger = {
		OR = {
			trade_goods = apiculture
			trade_goods = beer
			trade_goods = cider
			trade_goods = camel
			trade_goods = champagne
			trade_goods = citrus
			trade_goods = elephants
			trade_goods = fruit
			trade_goods = grain
			trade_goods = horses
			trade_goods = livestock
			trade_goods = llama
			trade_goods = maize
			trade_goods = olive_oil
			trade_goods = potato
			trade_goods = rice
			trade_goods = tomato
			trade_goods = vegetables #Makes sense to have vegetables in a farm doesn't it ?
			trade_goods = vodka
			trade_goods = wine
			trade_goods = whiskey
		}
	}

	ai_will_do = {
		factor = 8			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		modifier = {
			factor = 0.9
			FROM = { 
				OR = {
					technology_group = eastern
					technology_group = bohemian_tech_group
					technology_group = byzantine_tech_group
					technology_group = hungarian_tech_group
					technology_group = polish_tech_group
					technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { 
				    	OR = {
				        	technology_group = western
				        	technology_group = dutch_tech_group
				        	technology_group = english_tech_group
				        	technology_group = french_tech_group
				        	technology_group = german_tech_group
				        	technology_group = italian_tech_group
				        	technology_group = portuguese_tech_group
				        	technology_group = roman_tech_group
				        	technology_group = scandinavian_tech_group
				        	technology_group = spanish_tech_group
				        	technology_group = swiss_tech_group
				        }
				    }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			FROM = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.15
			base_production = 4
		}
		modifier = {
			factor = 1.3
			base_production = 8
		}
		modifier = {
			factor = 1.6
			base_production = 12
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

mills = {
	manufactory = {
		paper
		amber
		lacquerware
		diamonds
		gems
		pearls
		tropical_wood
		glass
		chinaware
		lumber
		ebony
		amber
		steam_engine
		optics
		bamboo
		pottery
	}
	modifier = {
		trade_goods_size = 0.4			#VU Addon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU AddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		local_tax_modifier = 0.25			#VU AddOn new - Just a fun little new bonus
	}
	onmap = yes
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}

	keep_trigger = {
		OR = {
			trade_goods = amber
			trade_goods = chinaware
			trade_goods = diamonds
			trade_goods = ebony
			trade_goods = gems
			trade_goods = glass
			trade_goods = lumber
			trade_goods = optics
			trade_goods = paper
			trade_goods = pearls
			trade_goods = steam_engine
			trade_goods = tropical_wood
			trade_goods = bamboo
			trade_goods = pottery
		}
	}

	ai_will_do = {
		factor = 8			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		modifier = {
			factor = 0.9
			FROM = { 
				OR = {
					technology_group = eastern
					technology_group = bohemian_tech_group
					technology_group = byzantine_tech_group
					technology_group = hungarian_tech_group
					technology_group = polish_tech_group
					technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { 
				    	OR = {
				        	technology_group = western
				        	technology_group = dutch_tech_group
				        	technology_group = english_tech_group
				        	technology_group = french_tech_group
				        	technology_group = german_tech_group
				        	technology_group = italian_tech_group
				        	technology_group = portuguese_tech_group
				        	technology_group = roman_tech_group
				        	technology_group = scandinavian_tech_group
				        	technology_group = spanish_tech_group
				        	technology_group = swiss_tech_group
				        }
				    }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			FROM = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.1
			base_tax = 4
		}
		modifier = {
			factor = 1.2
			base_tax = 8
		}
		modifier = {
			factor = 1.4
			base_tax = 12
		}
		modifier = {
			factor = 1.1
			base_production = 4
		}
		modifier = {
			factor = 1.2
			base_production = 8
		}
		modifier = {
			factor = 1.4
			base_production = 12
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

furnace = {
	manufactory = {
		coal
	}

	potential = {
		has_dlc = "Rule Britannia"
	}

	modifier = {
		trade_goods_size = 0.4			#VU Addon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU AddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		global_trade_goods_size_modifier = 0.03			#VU AddOn changed from 0.05. This was just too huge, especially with all the new provinces.
	}
	onmap = yes
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
	}
	on_obsolete = {
	}
	keep_trigger = {
		trade_goods = coal
	}

	ai_will_do = {
		factor = 15			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		modifier = {
			factor = 0.9
			FROM = { 
				OR = {
					technology_group = eastern
					technology_group = bohemian_tech_group
					technology_group = byzantine_tech_group
					technology_group = hungarian_tech_group
					technology_group = polish_tech_group
					technology_group = russian_tech_group
					technology_group = bulgarian_tech_group
				}
			}
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = persian_tech_group
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { 
				    	OR = {
				        	technology_group = western
				        	technology_group = dutch_tech_group
				        	technology_group = english_tech_group
				        	technology_group = french_tech_group
				        	technology_group = german_tech_group
				        	technology_group = italian_tech_group
				        	technology_group = portuguese_tech_group
				        	technology_group = roman_tech_group
				        	technology_group = scandinavian_tech_group
				        	technology_group = spanish_tech_group
				        	technology_group = swiss_tech_group
				        }
				    }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			FROM = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.15
			base_production = 4
		}
		modifier = {
			factor = 1.3
			base_production = 8
		}
		modifier = {
			factor = 1.6
			base_production = 12
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}

ramparts = {
	manufactory = {
		all
	}

	#build_trigger = {
	#	is_flatland = yes
	#}
	modifier = {
		local_hostile_attrition = 1
		local_defensiveness = 0.15
		local_defender_dice_roll_bonus = 1
	}
	onmap = no
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	
	on_built = {
		add_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1 
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_development_of_castles
				}
				NOT = { has_province_modifier = estate_nobles_development_of_castles_ramparts_mod }
			}
			add_province_modifier = {
				name = estate_nobles_development_of_castles_ramparts_mod
				duration = -1
			}
		}
	}
	
	on_destroyed = {
		if = {
			limit = { has_province_modifier = per_reinforced_defenses }
			remove_province_modifier = per_reinforced_defenses
		}
		remove_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1
		}
		if = {
			limit = {
				has_province_modifier = estate_nobles_development_of_castles_ramparts_mod
			}
			remove_province_modifier = estate_nobles_development_of_castles_ramparts_mod
		}
	}
	
	ai_will_do = {
		factor = 1
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 14000 } }
		}
	}
}

soldier_households = {
	manufactory = {
		all
	}

	bonus_manufactory = { # Will apply an extra modifier if these goods
		beer
		cider
		grain
		fish
		livestock
		wine
		apiculture
		rice
		horses
		olive_oil
		camel
		elephants
		citrus
		potato
		maize
		llama
		champagne
		millet
		vodka
		whiskey
	}

	modifier = {
		local_manpower = 0.75
	}
	bonus_modifier = {
		local_manpower = 0.75
	}
	onmap = no
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1 
		}
		if = {
			limit = {
				FROM = {
					has_government_attribute = improved_military_buildings
				}
			}
			add_province_modifier = {
				name = wei_suo_system_reform_soldier_households_modifier
				duration = -1
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1
		}
		if = {
			limit = {
				has_province_modifier = wei_suo_system_reform_soldier_households_modifier
			}
			remove_province_modifier = wei_suo_system_reform_soldier_households_modifier
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 1
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 1400 } }
		}
	}
}

impressment_offices = {
	manufactory = {
		all
	}

	bonus_manufactory = { # Will apply an extra modifier if these goods
		salt
		beer
		cider
		fish
		lumber
		naval_supplies
		tropical_wood
		seafood
		tar
	}

	build_trigger = {
		has_port = yes
	}

	modifier = {
		local_sailors = 250
		ship_recruit_speed = -0.1
		local_ship_cost = -0.05
	}
	bonus_modifier = {
		local_sailors = 250
		ship_recruit_speed = -0.1
		local_ship_cost = -0.05
	}
	onmap = no
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	on_built = {
		add_development_from_building = {
			building = impressment_offices
			type = manpower
			value = 2
		}
		add_dev_from_building = {
			building = impressment_offices 
			type = manpower 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = impressment_offices
			type = manpower
			value = 2
		}
		remove_dev_from_building = {
			building = impressment_offices 
			type = manpower 
			value = 1 
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 1
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 1400 } }
		}
	}
}


state_house = {
	manufactory = {
		all
	}

	bonus_manufactory = { # Will apply an extra modifier if these goods
		paper
		gems
		tropical_wood
		glass
		chinaware
		diamonds
		marble
		gems
		jade
		jewellery
		lumber
		ebony
		amber
		steam_engine
		optics
	}

	build_trigger = {
		NOT = {
			area_for_scope_province = {
				owner = {
					tag = ROOT
				}
				OR = {
					has_building = state_house
					has_construction = state_house
				}
			}
		}
	}

	keep_trigger = {
		NOT = {
			area_for_scope_province = {
				NOT = { province_id = root }
				owner = {
					tag = ROOT
				}
				OR = {
					has_building = state_house
					has_construction = state_house
				}
			}
		}
	}

	modifier = {
		statewide_governing_cost = -0.2
		min_local_autonomy = -5
		local_governing_cost = -0.15
		local_governing_cost_increase = -10
		allowed_num_of_buildings = 1
	}
	bonus_modifier = {
		statewide_governing_cost = -0.2
		min_local_autonomy = -5
		local_governing_cost = -0.15
		local_governing_cost_increase = -10
	}
	onmap = no
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	on_built = {
		add_development_from_building = {
			building = state_house
			type = tax
			value = 2
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = state_house
			type = tax
			value = 2
		}
	}
	on_obsolete = {
	}
	
	ai_will_do = {
		factor = 1
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 1400 } }
		}
	}
}

oil_well = {

	manufactory = {
		oil
	}
	potential = {
		has_dlc = "Rule Britannia"
	}
	keep_trigger = {
		trade_goods = oil
	}
	modifier = {
		global_trade_goods_size_modifier = 0.05 #National Bonus
	}
	onmap = yes
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	ai_will_do = {
		factor = 1
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		modifier = {
			factor = 1.0
			FROM = {
				treasury = 27500
			}
		}
	}
}