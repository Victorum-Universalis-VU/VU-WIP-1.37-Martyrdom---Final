#subjects_expanded_diplomatic_actions_administrative_region
establish_administrative_region = {
	category = influence

	require_acceptance = no

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = administrative_region
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = administrative_region
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		NOT = { truce_with = FROM }
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = administrative_region
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
				NOT = { truce_with = FROM }
			}
			create_subject = {
				subject = FROM
				subject_type = administrative_region
			}
		}
	}

	ai_will_do = {
		calc_true_if = {
			all_subject_country = {
				is_vassal_or_similar_subject = yes
			}
			amount = 3
		}
		FROM = {
			NOT = { total_development = 100 }
		}
	}
}

administrative_region_remove_heir = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = administrative_region
			government = monarchy
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = administrative_region
				government = monarchy
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			has_regency = no
		}
		FROM = {
			has_heir = yes
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = administrative_region
					government = monarchy
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					has_regency = no
				}
				FROM = {
					has_heir = yes
				}
			}
			FROM = {
				set_ruler_flag = administrative_region_remove_heir
				country_event = { id = subjects_expanded_administrative_region_events.3 }
			}
		}
	}

	ai_will_do = {
		FROM = {
			NOT = { has_ruler_flag = administrative_region_remove_heir }
			NOT = { liberty_desire = 25 }
			OR = {
				AND = {
					NOT = { heir_adm = 3 }
					NOT = { heir_dip = 3 }
					NOT = { heir_mil = 3 }
				}
				AND = {
					NOT = { heir_adm = 1 }
					NOT = { heir_dip = 4 }
					NOT = { heir_mil = 4 }
				}
				AND = {
					NOT = { heir_adm = 4 }
					NOT = { heir_dip = 1 }
					NOT = { heir_mil = 4 }
				}
				AND = {
					NOT = { heir_adm = 4 }
					NOT = { heir_dip = 4 }
					NOT = { heir_mil = 1 }
				}
			}
		}
	}
}

administrative_region_enable_administrative_help = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = administrative_region
			NOT = { has_country_flag = administrative_region_enable_administrative_help }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = administrative_region
				NOT = { has_country_flag = administrative_region_enable_administrative_help }
			}
		}
		is_at_war = no
		NOT = { truce_with = FROM }
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			has_regency = no
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = administrative_region
					NOT = { has_country_flag = administrative_region_enable_administrative_help }
				}
				is_at_war = no
				NOT = { truce_with = FROM }
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					has_regency = no
				}
			}
			FROM = {
				set_country_flag = administrative_region_enable_administrative_help
				add_opinion = {
					who = ROOT
					modifier = administrative_region_enable_administrative_help_opinion
				}
			}
		}
	}

	ai_will_do = {
		has_regency = no
		OR = {
			NOT = { ADM = 1 }
			NOT = { DIP = 1 }
			NOT = { MIL = 1 }
		}
		FROM = {
			NOT = { liberty_desire = 5 }
		}
	}
}

administrative_region_disable_administrative_help = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = administrative_region
			has_country_flag = administrative_region_enable_administrative_help
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = administrative_region
				has_country_flag = administrative_region_enable_administrative_help
			}
		}
		has_regency = no
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = administrative_region
					has_country_flag = administrative_region_enable_administrative_help
				}
				has_regency = no
			}
			FROM = {
				clr_country_flag = administrative_region_enable_administrative_help
				add_liberty_desire = 40
			}
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 55
		}
	}
}

#subjects_expanded_diplomatic_actions_agricultural_march
establish_agricultural_march = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_subject = no
		can_create_subject_type = {
			subject = FROM
			subject_type = agricultural_march
		}
	}

	is_allowed = {
		is_subject = no
		can_create_subject_type = {
			subject = FROM
			subject_type = agricultural_march
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}

	on_accept = {
		if = {
			limit = {
				is_subject = no
				can_create_subject_type = {
					subject = FROM
					subject_type = agricultural_march
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			create_subject = {
				subject = FROM
				subject_type = agricultural_march
			}
		}
	}

	ai_will_do = {
		FROM = {
			NOT = { liberty_desire = 50 }
			NOT = { is_different_march_subject = yes }
			NOT = { development_of_overlord_fraction = 0.25 }
			is_subject_of_type = march
			any_neighbor_country = {
				OR = {
					is_rival = ROOT
					is_enemy = ROOT
				}
			}
			monthly_income = 20
			production_income_percentage = 0.35
			max_manpower = 20
			NOT = {
				num_of_owned_provinces_with = {
					value = 10
					is_permanent_claim = ROOT
				}
			}
		}
	}
}

ask_to_become_agricultural_march = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_to_become_agricultural_march_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			is_subject = no
			can_create_subject_type = {
				subject = ROOT
				subject_type = agricultural_march
			}
		}
	}

	is_allowed = {
		FROM = {
			is_subject = no
			can_create_subject_type = {
				subject = ROOT
				subject_type = agricultural_march
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					can_create_subject_type = {
						subject = ROOT
						subject_type = agricultural_march
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = agricultural_march
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					can_create_subject_type = {
						subject = ROOT
						subject_type = agricultural_march
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			FROM = {
				clr_country_flag = declined_become_agricultural_march_@ROOT
				set_country_flag = declined_become_agricultural_march_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_agricultural_march
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = ROOT_IS_VASSAL_FOR_AT_LEAST_10_YEARS
			limit = {
				years_in_vassalage_under = {
					who = FROM
					years = 10
					all_subject_country = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_NOT_A_NEIGHBOR_OF_FROMS_RIVALS
			limit = {
				NOT = {
					any_neighbor_country = {
						OR = {
							is_rival = FROM
							is_enemy = FROM
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_MORE_THAN_25_PERCENT_OF_OVERLORD_DEVELOPMENT
			limit = {
				development_of_overlord_fraction = 0.25
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_TOO_FEW_PRODUCTION_INCOME
			limit = {
				OR = {
					NOT = { monthly_income = 20 }
					NOT = { production_income_percentage = 0.35 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_TOO_FEW_MAX_MANPOWER
			limit = {
				NOT = { max_manpower = 20 }
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		NOT = { liberty_desire = 50 }
		NOT = { is_different_march_subject = yes }
		army_size = 20
		OR = {
			is_subject_of_type = march
			FROM = { ai = no }
		}
		production_income_percentage = 0.2
		any_neighbor_country = {
			OR = {
				is_rival = FROM
				is_enemy = FROM
			}
		}
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_become_agricultural_march_@ROOT }
				had_country_flag = { flag = declined_become_agricultural_march_@ROOT days = 1825 }
			}
		}
		NOT = {
			num_of_owned_provinces_with = {
				value = 10
				is_permanent_claim = FROM
			}
		}
	}
}

agricultural_march_enable_seize_production = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = agricultural_march
			NOT = { has_country_flag = agricultural_march_seize_production }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = agricultural_march
				NOT = { has_country_flag = agricultural_march_seize_production }
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = agricultural_march
					NOT = { has_country_flag = agricultural_march_seize_production }
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			FROM = {
				set_country_flag = agricultural_march_seize_production
			}
		}
	}

	ai_will_do = {
		FROM = {
			NOT = { liberty_desire = 35 }
		}
	}
}

agricultural_march_disable_seize_production = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = agricultural_march
			has_country_flag = agricultural_march_seize_production
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = agricultural_march
				has_country_flag = agricultural_march_seize_production
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = agricultural_march
					has_country_flag = agricultural_march_seize_production
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			add_prestige = -10
			FROM = {
				clr_country_flag = agricultural_march_seize_production
			}
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 55
		}
	}
}

#subjects_expanded_diplomatic_actions_annexable_colony
establish_annexable_colony = {
	category = influence

	require_acceptance = no

	is_visible = {
		ai = no
		can_create_subject_type = {
			subject = FROM
			subject_type = annexable_colony
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = annexable_colony
		}
		num_of_colonists = 2
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = annexable_colony
				}
				num_of_colonists = 2
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			create_subject = {
				subject = FROM
				subject_type = annexable_colony
			}
			FROM = {
				set_disabled_colonial_nation_spawning_for_region_for_overlord = yes
			}
			set_country_flag = has_had_annexable_colony
		}
	}

	ai_will_do = {
		always = no
	}
}

make_annexable_colony_to_colony_again = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = annexable_colony
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = annexable_colony
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = annexable_colony
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			FROM = {
				grant_independence = yes
			}
			if = {
				limit = {
					has_dlc = "Leviathan"
				}
				create_subject = {
					subject = FROM
					subject_type = crown_colony
				}
			}
			else = {
				create_subject = {
					subject = FROM
					subject_type = colony
				}
			}
			FROM = {
				unset_disabled_colonial_nation_spawning_for_region_for_overlord = yes
			}
		}
	}

	ai_will_do = {
		always = yes
	}
}

#subjects_expanded_diplomatic_actions_banking_family_subject
establish_banking_family_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_banking_family_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = banking_family_subject
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = banking_family_subject
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
				}
			}
			FROM = {
				NOT = { liberty_desire = 50 }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = banking_family_subject
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				if = {
					limit = {
						FROM = {
							is_subject_of = ROOT
						}
					}
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			create_subject = {
				subject = FROM
				subject_type = banking_family_subject
			}
			add_truce_with = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = banking_family_subject
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				if = {
					limit = {
						FROM = {
							is_subject_of = ROOT
						}
					}
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			FROM = {
				clr_country_flag = declined_establish_banking_family_subject_@ROOT
				set_country_flag = declined_establish_banking_family_subject_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_banking_family_subject_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_IS_VASSAL_OF_ROOT
			limit = {
				overlord_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				overlord_of = FROM
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPEROR
			limit = {
				FROM = {
					is_emperor = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_JUST_CANCELED_BANKING_FAMILY_SUBJECT
			limit = {
				FROM = {
					has_ruler_modifier = ruler_just_canceled_to_be_banking_family_subject
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_NUM_OF_PROVINCES
			export_to_variable = {
				which = ai_value
				value = trigger_value:num_of_cities
				who = FROM
			}
			multiply_variable = { which = ai_value value = -5 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = -49 }
					NOT = { check_variable = { which = eco_power value = 50 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					NOT = { check_variable = { which = eco_power value = -49 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				FROM = {
					has_reform = free_city
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_ACCEPT_VASSALIZATION_REASONS
			export_to_variable = {
				which = ai_value
				value = modifier:accept_vassalization_reasons
			}
		}
		add_entry = {
			name = ROOT_IS_NOT_A_REPUBLIC
			limit = {
				NOT = { government = republic }
				NOT = { has_government_attribute = can_create_banking_family_subject_rule }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
	}

	ai_will_do = {
		OR = {
			capital_scope = {
				region = italy_region
			}
			tag = ARA
			government_rank = 3
			AND = {
				NOT = { has_dlc = "Common Sense" }
				total_development = 1000
			}
			num_of_loans = 3
		}
		FROM = {
			is_emperor = no
			OR = {
				NOT = { has_country_flag = declined_establish_banking_family_subject_@ROOT }
				had_country_flag = { flag = declined_establish_banking_family_subject_@ROOT days = 1825 }
			}
			NOT = { is_subject_of = ROOT }
			capital_scope = {
				region = italy_region
			}
			NOT = {
				any_owned_province = {
					OR = {
						is_core = ROOT
						is_permanent_claim = ROOT
					}
				}
			}
		}
	}
}

ask_to_become_banking_family_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_to_become_banking_family_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = banking_family_subject
			}
		}
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = banking_family_subject
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		if = {
			limit = {
				is_subject_of = FROM
			}
			NOT = { liberty_desire = 50 }
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = banking_family_subject
					}
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				if = {
					limit = {
						is_subject_of = FROM
					}
					NOT = { liberty_desire = 50 }
				}
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = banking_family_subject
				}
				add_truce_with = ROOT
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = banking_family_subject
					}
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				if = {
					limit = {
						is_subject_of = FROM
					}
					NOT = { liberty_desire = 50 }
				}
			}
			clr_country_flag = declined_establish_banking_family_subject_@FROM
			set_country_flag = declined_establish_banking_family_subject_@FROM
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_banking_family_subject
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = ROOT_IS_VASSAL_OF_FROM
			limit = {
				is_subject_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				is_subject_of = FROM
				liberty_desire = 50
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
						who = FROM
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = -49 }
					NOT = { check_variable = { which = eco_power value = 50 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
				who = FROM
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
						who = FROM
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					NOT = { check_variable = { which = eco_power value = -49 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
						who = FROM
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = STRATEGIC_VALUE
			limit = {
				NOT = {
					AND = {
						FROM = {
							OR = {
								capital_scope = {
									region = italy_region
								}
								tag = ARA
								government_rank = 3
								AND = {
									NOT = { has_dlc = "Common Sense" }
									total_development = 1000
								}
								num_of_loans = 3
							}
						}
						is_emperor = no
						OR = {
							NOT = { has_country_flag = declined_establish_banking_family_subject_@FROM }
							had_country_flag = { flag = declined_establish_banking_family_subject_@FROM days = 1825 }
						}
						NOT = { is_subject_of = FROM }
						capital_scope = {
							region = italy_region
						}
						NOT = {
							any_owned_province = {
								OR = {
									is_core = FROM
									is_permanent_claim = FROM
								}
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_NUM_OF_LOANS
			export_to_variable = {
				which = ai_value
				value = trigger_value:num_of_loans
				who = FROM
			}
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = FROM_IS_NOT_A_REPUBLIC
			limit = {
				FROM = {
					NOT = { government = republic }
					NOT = { has_government_attribute = can_create_banking_family_subject_rule }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
	}

	ai_will_do = {
		is_subject = no
		NOT = { num_of_cities = 4 }
		alliance_with = FROM
		religion = FROM
		OR = {
			is_part_of_hre = no
			FROM = {
				is_part_of_hre = yes
			}
		}
		is_elector = no
		is_emperor = no
		NOT = { num_of_subjects = 1 }
		NOT = { has_ruler_modifier = ruler_just_canceled_to_be_banking_family_subject }
		NOT = { has_reform = free_city }
		FROM = {
			NOT = {
				any_owned_province = {
					is_core = ROOT
				}
			}
		}
	}
}

enable_banking_family_subject_demand_war_chest_contribution = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = banking_family_subject
			NOT = { has_country_flag = banking_family_subject_demand_war_chest_contribution }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = banking_family_subject
				NOT = { has_country_flag = banking_family_subject_demand_war_chest_contribution }
			}
		}
		FROM = {
			NOT = { liberty_desire = 50 }
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = banking_family_subject
					NOT = { has_country_flag = banking_family_subject_demand_war_chest_contribution }
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
			}
			FROM = {
				set_country_flag = banking_family_subject_demand_war_chest_contribution
			}
		}
	}

	ai_will_do = {
		is_at_war = yes
		FROM = {
			NOT = { liberty_desire = 35 }
		}
	}
}

disable_banking_family_subject_demand_war_chest_contribution = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = banking_family_subject
			has_country_flag = banking_family_subject_demand_war_chest_contribution
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = banking_family_subject
				has_country_flag = banking_family_subject_demand_war_chest_contribution
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = banking_family_subject
					has_country_flag = banking_family_subject_demand_war_chest_contribution
				}
			}
			FROM = {
				clr_country_flag = banking_family_subject_demand_war_chest_contribution
			}
		}
	}

	ai_will_do = {
		OR = {
			is_at_war = no
			FROM = {
				liberty_desire = 55
			}
		}
	}
}

banking_family_subject_extort_emergency_funds = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = banking_family_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = banking_family_subject
			}
		}
		custom_trigger_tooltip = {
			tooltip = NOT_USED_BANKING_FAMILY_SUBJECT_EXTORT_EMERGENCY_FUNDS_WITHIN_LAST_25_YEARS_TT
			OR = {
				NOT = { has_country_flag = banking_family_subject_extort_emergency_funds_used }
				had_country_flag = { flag = banking_family_subject_extort_emergency_funds_used days = 9125 }
			}
		}
		FROM = {
			has_opinion = {
				who = ROOT
				value = 190
			}
		}
		FROM = {
			NOT = { liberty_desire = 50 }
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = banking_family_subject
				}
				OR = {
					NOT = { has_country_flag = banking_family_subject_extort_emergency_funds_used }
					had_country_flag = { flag = banking_family_subject_extort_emergency_funds_used days = 9125 }
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 190
					}
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
			}
			clr_country_flag = banking_family_subject_extort_emergency_funds_used
			set_country_flag = banking_family_subject_extort_emergency_funds_used
			FROM = {
				country_event = { id = subjects_expanded_banking_family_subject_events.3 }
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

banking_family_subject_become_independent = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_subject_of = FROM
		is_subject_of_type = banking_family_subject
	}

	is_allowed = {
		hidden_trigger = {
			is_subject_of = FROM
			is_subject_of_type = banking_family_subject
		}
		NOT = { truce_with = FROM }
		liberty_desire = 50
	}

	on_accept = {
		if = {
			limit = {
				is_subject_of = FROM
				is_subject_of_type = banking_family_subject
				NOT = { truce_with = FROM }
				liberty_desire = 50
			}
			add_stability = -1
			add_ruler_modifier = {
				name = ruler_just_canceled_to_be_banking_family_subject
				duration = -1
				hidden = yes
			}
			FROM = {
				ROOT = {
					grant_independence = yes
				}
				add_casus_belli = {
					target = ROOT
					type = cb_disloyal_banking_family_subject
				}
			}
		}
	}

	ai_will_do = {
		stability = 1
		liberty_desire = 60
		is_at_war = no
	}
}

cancel_banking_family_subject = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = banking_family_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = banking_family_subject
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = banking_family_subject
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
				add_ruler_modifier = {
					name = ruler_just_canceled_to_be_banking_family_subject
					duration = -1
					hidden = yes
				}
			}
			add_truce_with = FROM
			add_prestige = -25
			remove_casus_belli = {
				target = FROM
				type = cb_disloyal_banking_family_subject
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

#subjects_expanded_diplomatic_actions_brother_kingdom
establish_brother_kingdom = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_brother_kingdom_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = brother_kingdom
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = brother_kingdom
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		is_female = no
		FROM = {
			is_female = no
		}
		months_of_ruling = 24
		FROM = {
			months_of_ruling = 24
		}
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
				}
			}
			FROM = {
				NOT = { liberty_desire = 50 }
			}
			if = {
				limit = {
					FROM = {
						is_subject_of_type = medieval_vassal
					}
				}
				FROM = {
					custom_trigger_tooltip = {
						tooltip = MEDIEVAL_VASSAL_AT_LEAST_SUBJECT_FOR_25_YEARS_TT
						years_in_vassalage_under = {
							who = ROOT
							years = 25
							all_subject_country = yes
						}
					}
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = brother_kingdom
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				is_female = no
				FROM = {
					is_female = no
				}
				if = {
					limit = {
						FROM = {
							is_subject_of = ROOT
						}
					}
					FROM = {
						NOT = { liberty_desire = 50 }
					}
					if = {
						limit = {
							FROM = {
								is_subject_of_type = medieval_vassal
							}
						}
						FROM = {
							years_in_vassalage_under = {
								who = ROOT
								years = 25
								all_subject_country = yes
							}
						}
					}
				}
			}
			create_subject = {
				subject = FROM
				subject_type = brother_kingdom
			}
			add_truce_with = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = brother_kingdom
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				is_female = no
				FROM = {
					is_female = no
				}
				if = {
					limit = {
						FROM = {
							is_subject_of = ROOT
						}
					}
					FROM = {
						NOT = { liberty_desire = 50 }
					}
					if = {
						limit = {
							FROM = {
								is_subject_of_type = medieval_vassal
							}
						}
						FROM = {
							years_in_vassalage_under = {
								who = ROOT
								years = 25
								all_subject_country = yes
							}
						}
					}
				}
			}
			FROM = {
				clr_country_flag = declined_establish_brother_kingdom_@ROOT
				set_country_flag = declined_establish_brother_kingdom_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_brother_kingdom_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_IS_VASSAL_OF_ROOT
			limit = {
				overlord_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				overlord_of = FROM
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				NOT = { government_rank = 3 }
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				government_rank = 3
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { overlord_of = FROM }
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPEROR
			limit = {
				FROM = {
					is_emperor = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_CURIA_CONTROLLER
			limit = {
				FROM = {
					is_papal_controller = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			limit = {
				FROM = {
					NOT = {
						is_subject_of_type_with_overlord = {
							who = ROOT
							type = medieval_vassal
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			limit = {
				FROM = {
					is_subject_of_type_with_overlord = {
						who = ROOT
						type = medieval_vassal
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -4 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = FROM_WAR_EXHAUSTION
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:war_exhaustion
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_FROM_RULER_STATS_COMPARED
			limit = {
				full_idea_group = diplomatic_ideas
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = their_ruler_adm
				value = ADM
				who = FROM
			}
			export_to_variable = {
				which = their_ruler_dip
				value = DIP
				who = FROM
			}
			export_to_variable = {
				which = their_ruler_mil
				value = MIL
				who = FROM
			}
			export_to_variable = {
				which = our_ruler_adm
				value = ADM
			}
			export_to_variable = {
				which = our_ruler_dip
				value = DIP
			}
			export_to_variable = {
				which = our_ruler_mil
				value = MIL
			}
			change_variable = { which = ai_value which = our_ruler_adm }
			change_variable = { which = ai_value which = our_ruler_dip }
			change_variable = { which = ai_value which = our_ruler_mil }
			subtract_variable = { which = ai_value which = their_ruler_adm }
			subtract_variable = { which = ai_value which = their_ruler_dip }
			subtract_variable = { which = ai_value which = their_ruler_mil }
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = ROOT_FROM_RULER_STATS_COMPARED
			limit = {
				NOT = { full_idea_group = diplomatic_ideas }
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = their_ruler_adm
				value = ADM
				who = FROM
			}
			export_to_variable = {
				which = their_ruler_dip
				value = DIP
				who = FROM
			}
			export_to_variable = {
				which = their_ruler_mil
				value = MIL
				who = FROM
			}
			export_to_variable = {
				which = our_ruler_adm
				value = ADM
			}
			export_to_variable = {
				which = our_ruler_dip
				value = DIP
			}
			export_to_variable = {
				which = our_ruler_mil
				value = MIL
			}
			change_variable = { which = ai_value which = our_ruler_adm }
			change_variable = { which = ai_value which = our_ruler_dip }
			change_variable = { which = ai_value which = our_ruler_mil }
			subtract_variable = { which = ai_value which = their_ruler_adm }
			subtract_variable = { which = ai_value which = their_ruler_dip }
			subtract_variable = { which = ai_value which = their_ruler_mil }
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_RULER_IS_OLDER
			limit = {
				NOT = { ruler_age = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_LEGITIMACY_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				NOT = { legitimacy = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:legitimacy
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:legitimacy
				who = FROM
			}
			subtract_variable = { which = ai_value which = ai_value_2 }
		}
		add_entry = {
			name = ROOT_FROM_LEGITIMACY_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				legitimacy = FROM
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:legitimacy
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:legitimacy
				who = FROM
			}
			subtract_variable = { which = ai_value which = ai_value_2 }
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_A_HEIR
			limit = {
				FROM = {
					has_heir = yes
					heir_has_ruler_dynasty = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_HEIR_FROM_HAS_NO_HEIR
			limit = {
				has_heir = yes
				heir_has_ruler_dynasty = yes
				FROM = {
					has_heir = no
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = FROM_JUST_CANCELED_BROTHER_KINGDOM
			limit = {
				FROM = {
					has_ruler_modifier = ruler_just_canceled_to_be_brother_kingdom
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_TOO_SMALL
			limit = {
				NOT = { total_development = 50 }
				NOT = { total_development = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		NOT = { personal_union = 2 }
		FROM = {
			is_emperor = no
			OR = {
				NOT = { has_country_flag = declined_establish_brother_kingdom_@ROOT }
				had_country_flag = { flag = declined_establish_brother_kingdom_@ROOT days = 1825 }
			}
			OR = {
				NOT = { is_subject_of = ROOT }
				AND = {
					is_subject_of_type = medieval_vassal
					total_development = 200
				}
			}
		}
		#OR = {
		#	marriage_with = FROM
		#	alliance_with = FROM
		#	AND = {
		#		num_of_free_diplomatic_relations = 1
		#		has_casus_belli = {
		#			target = FROM
		#			type = cb_salic_reunification
		#		}
		#	}
		#}
	}
}

make_brother_kingdom_to_personal_union = {
	category = influence

	alert_index = 2
	alert_tooltip = make_brother_kingdom_to_personal_union_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = brother_kingdom
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = brother_kingdom
			}
		}
		has_regency = no
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		months_of_ruling = 24
		FROM = {
			months_of_ruling = 24
		}
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = BROTHER_KINGDOM_AT_LEAST_SUBJECT_FOR_25_YEARS_TT
				years_in_vassalage_under = {
					who = ROOT
					years = 25
					all_subject_country = yes
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = brother_kingdom
				}
				has_regency = no
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				months_of_ruling = 24
				FROM = {
					months_of_ruling = 24
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 25
						all_subject_country = yes
					}
				}
			}
			create_subject = {
				subject = FROM
				subject_type = personal_union
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = brother_kingdom
				}
				has_regency = no
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				months_of_ruling = 24
				FROM = {
					months_of_ruling = 24
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 25
						all_subject_country = yes
					}
				}
			}
			add_prestige = -10
			FROM = {
				add_legitimacy = -5
				clr_country_flag = make_brother_kingdom_to_personal_union_@ROOT
				set_country_flag = make_brother_kingdom_to_personal_union_@ROOT
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				overlord_of = FROM
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			limit = {
				diplomatic_reputation = 0
			}
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			limit = {
				NOT = { diplomatic_reputation = 0 }
			}
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_CURIA_CONTROLLER
			limit = {
				FROM = {
					is_papal_controller = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -5 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_RULER_STATS_COMPARED
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = their_ruler_adm
				value = ADM
				who = FROM
			}
			export_to_variable = {
				which = their_ruler_dip
				value = DIP
				who = FROM
			}
			export_to_variable = {
				which = their_ruler_mil
				value = MIL
				who = FROM
			}
			export_to_variable = {
				which = our_ruler_adm
				value = ADM
			}
			export_to_variable = {
				which = our_ruler_dip
				value = DIP
			}
			export_to_variable = {
				which = our_ruler_mil
				value = MIL
			}
			change_variable = { which = ai_value which = our_ruler_adm }
			change_variable = { which = ai_value which = our_ruler_dip }
			change_variable = { which = ai_value which = our_ruler_mil }
			subtract_variable = { which = ai_value which = their_ruler_adm }
			subtract_variable = { which = ai_value which = their_ruler_dip }
			subtract_variable = { which = ai_value which = their_ruler_mil }
			multiply_variable = { which = ai_value value = 15 }
		}
		add_entry = {
			name = FROM_RULER_IS_OLDER
			limit = {
				NOT = { ruler_age = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_LEGITIMACY_COMPARED
			export_to_variable = {
				which = ai_value
				value = trigger_value:legitimacy
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:legitimacy
				who = FROM
			}
			subtract_variable = { which = ai_value which = ai_value_2 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = FROM_HAS_A_HEIR
			limit = {
				FROM = {
					has_heir = yes
					heir_has_ruler_dynasty = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_HEIR_FROM_HAS_NO_HEIR
			limit = {
				has_heir = yes
				heir_has_ruler_dynasty = yes
				FROM = {
					has_heir = no
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = FROM_HAS_REGENCY
			limit = {
				FROM = {
					OR = {
						has_regency = yes
						has_consort_regency = yes
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
	}

	ai_will_do = {
		prestige = 1
		FROM = {
			has_opinion = {
				who = ROOT
				value = 50
			}
		}
	}
}

make_personal_union_to_brother_kingdom = {
	category = influence

	require_acceptance = no

	is_visible = {
		can_be_overlord = brother_kingdom
		has_heir = yes
		FROM = {
			is_subject_of = ROOT
			OR = {
				is_subject_of_type = personal_union
				#is_subject_of_type = salic_personal_union
			}
			government = monarchy
			religion_group = christian
		}
	}

	is_allowed = {
		hidden_trigger = {
			can_be_overlord = brother_kingdom
			has_heir = yes
			FROM = {
				is_subject_of = ROOT
				OR = {
					is_subject_of_type = personal_union
					#is_subject_of_type = salic_personal_union
				}
				government = monarchy
				religion_group = christian
			}
		}
		has_regency = no
		months_of_ruling = 60
		legitimacy = 80
		heir_age = 15
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = {
			is_at_war = no
		}
	}

	on_accept = {
		if = {
			limit = {
				can_be_overlord = brother_kingdom
				has_heir = yes
				FROM = {
					is_subject_of = ROOT
					OR = {
						is_subject_of_type = personal_union
						#is_subject_of_type = salic_personal_union
					}
					government = monarchy
					religion_group = christian
				}
				has_regency = no
				months_of_ruling = 60
				legitimacy = 80
				heir_age = 15
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
			}
			create_subject = {
				subject = FROM
				subject_type = brother_kingdom
			}
			exile_heir_as = new_brother_kingdom_ruler_from_@ROOT
			FROM = {
				define_ruler = {
					dynasty = ROOT
					claim = 100
					age = 20
					male = yes
				}
				set_heir = new_brother_kingdom_ruler_from_@ROOT
				kill_ruler = yes
				add_stability = 1
				add_liberty_desire = -10
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

brother_kingdom_ask_overlord_to_join_war = {
	category = alliance

	alert_index = 6
	alert_tooltip = brother_kingdom_ask_overlord_to_join_war_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			is_subject = no
			overlord_of = ROOT
		}
		is_subject_of_type = brother_kingdom
		any_country = {
			is_subject = no
			is_in_war = {
				defender_leader = THIS
				attacker_leader = ROOT
			}
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject = no
				overlord_of = ROOT
			}
			is_subject_of_type = brother_kingdom
			any_country = {
				is_subject = no
				is_in_war = {
					defender_leader = THIS
					attacker_leader = ROOT
				}
			}
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_DECLINE_A_CALL_TO_ARMS_OF_A_SUBJECT_WITHIN_LAST_1_YEAR
				OR = {
					NOT = { has_country_flag = declined_brother_kingdom_offensive_call_to_arms_@ROOT }
					had_country_flag = { flag = declined_brother_kingdom_offensive_call_to_arms_@ROOT days = 365 }
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					overlord_of = ROOT
				}
				is_subject_of_type = brother_kingdom
				any_country = {
					is_subject = no
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
				}
				FROM = {
					OR = {
						NOT = { has_country_flag = declined_brother_kingdom_offensive_call_to_arms_@ROOT }
						had_country_flag = { flag = declined_brother_kingdom_offensive_call_to_arms_@ROOT days = 365 }
					}
				}
			}
			FROM = {
				join_all_offensive_wars_of = ROOT
				clr_country_flag = accepted_brother_kingdom_offensive_call_to_arms_@ROOT
				set_country_flag = accepted_brother_kingdom_offensive_call_to_arms_@ROOT
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					overlord_of = ROOT
				}
				is_subject_of_type = brother_kingdom
				any_country = {
					is_subject = no
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
				}
				FROM = {
					OR = {
						NOT = { has_country_flag = declined_brother_kingdom_offensive_call_to_arms_@ROOT }
						had_country_flag = { flag = declined_brother_kingdom_offensive_call_to_arms_@ROOT days = 365 }
					}
				}
			}
			FROM = {
				clr_country_flag = declined_brother_kingdom_offensive_call_to_arms_@ROOT
				set_country_flag = declined_brother_kingdom_offensive_call_to_arms_@ROOT
			}
			add_liberty_desire = 10
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_RULER_MIL_SKILL
			export_to_variable = {
				which = ai_value
				value = MIL
				who = FROM
			}
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_defensive }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_threatened }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 120
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_hostile }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 150
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_ATTITUDE_TOWARDS_FROM
			limit = {
				ai_attitude = { who = FROM attitude = attitude_loyal }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				liberty_desire = 50
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					FROM = {
						ai_attitude = { who = PREV attitude = atittude_rivalry }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					FROM = {
						ai_attitude = { who = PREV attitude = attitude_hostile }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					FROM = {
						ai_attitude = { who = PREV attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					FROM = {
						ai_attitude = { who = PREV attitude = attitude_friendly }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_ALREADY_FIGHTING_IN_A_WAR
			limit = {
				FROM = {
					is_at_war = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALREADY_PARTICIPANT_IN_WAR_WITH_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					is_in_war = {
						participants = FROM
						participants = THIS
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_TRUCE_WITH_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					truce_with = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALLIED_TO_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					alliance_with = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALREADY_JOINED_A_WAR_AGAINST_A_COALITION_TARGET_OF_ROOT_WITHIN_LAST_365_DAYS
			limit = {
				FROM = {
					has_country_flag = accepted_brother_kingdom_offensive_call_to_arms_@ROOT
					NOT = { had_country_flag = { flag = accepted_brother_kingdom_offensive_call_to_arms_@ROOT days = 365 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_WOULD_GET_STABILITY_HIT
			limit = {
				OR = {
					any_country = {
						is_in_war = {
							defender_leader = THIS
							attacker_leader = ROOT
						}
						OR = {
							marriage_with = FROM
							truce_with = FROM
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_IN_DEBT
			limit = {
				FROM = {
					num_of_loans = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:num_of_loans
				who = FROM
			}
			multiply_variable = { which = ai_value value = -10 }
		}
		add_entry = {
			name = FROM_WAR_EXHAUSTION
			export_to_variable = {
				which = ai_value
				value = trigger_value:war_exhaustion
				who = FROM
			}
			multiply_variable = { which = ai_value value = -10 }
		}
	}

	ai_will_do = {
		overlord = {
			is_at_war = no
		}
		any_country = {
			is_subject = no
			is_in_war = {
				defender_leader = THIS
				attacker_leader = ROOT
			}
			war_score_against = { who = ROOT value = 25 }
		}
		NOT = {
			calc_true_if = {
				all_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
				}
				amount = 3
			}
		}
	}
}

brother_kingdom_become_independent = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_subject_of = FROM
		is_subject_of_type = brother_kingdom
	}

	is_allowed = {
		hidden_trigger = {
			is_subject_of = FROM
			is_subject_of_type = brother_kingdom
		}
		NOT = { truce_with = FROM }
		liberty_desire = 50
	}

	on_accept = {
		if = {
			limit = {
				is_subject_of = FROM
				is_subject_of_type = brother_kingdom
				NOT = { truce_with = FROM }
				liberty_desire = 50
			}
			add_stability = -1
			add_ruler_modifier = {
				name = ruler_just_canceled_to_be_brother_kingdom
				duration = -1
				hidden = yes
			}
			FROM = {
				country_event = { id = subjects_expanded_brother_kingdom_events.2 }
			}
		}
	}

	ai_will_do = {
		stability = 1
		NOT = { war_exhaustion = 1 }
		manpower_percentage = 0.75
		OR = {
			num_of_allies = 2
			army_size = FROM
			calc_true_if = {
				all_country = {
					is_supporting_independence_of = ROOT
				}
				amount = 2
			}
		}
		OR = {
			liberty_desire = 60
			army_size = FROM
			total_development = FROM
		}
		OR = {
			is_at_war = no
			AND = {
				NOT = {
					is_in_war = {
						attacker_leader = ROOT
					}
				}
				NOT = {
					is_in_war = {
						defender_leader = ROOT
					}
				}
				all_owned_province = {
					OR = {
						controlled_by = ROOT
						controlled_by = REB
					}
				}
				NOT = { num_of_rebel_armies = 2 }
				NOT = { num_of_rebel_controlled_provinces = 3 }
			}
		}
	}
}

cancel_brother_kingdom = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = brother_kingdom
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = brother_kingdom
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = brother_kingdom
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
				add_ruler_modifier = {
					name = ruler_just_canceled_to_be_brother_kingdom
					duration = -1
					hidden = yes
				}
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 50
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_client_march
establish_client_march = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		is_subject = no
		primitives = no
		can_create_subject_type = {
			subject = FROM
			subject_type = client_march
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			is_subject = no
			primitives = no
			can_create_subject_type = {
				subject = FROM
				subject_type = client_march
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}
	
	on_accept = {
		if = {
			limit = {
				is_subject = no
				primitives = no
				can_create_subject_type = {
					subject = FROM
					subject_type = client_march
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			create_subject = {
				subject = FROM
				subject_type = client_march
			}
		}
	}
	
	ai_will_do = {
		always = no
	}
}

#subjects_expanded_diplomatic_actions_colonial_subjects
combine_colony_with_other_colony_in_same_colonial_region = {
	category = influence

	require_acceptance = no

	is_visible = {
		ai = no
		FROM = {
			is_subject_of = ROOT
			is_colonial_subject_type = yes
		}
		any_subject_country = {
			is_colonial_subject_type = yes
			NOT = { tag = FROM }
			ai = yes
			capital_scope = {
				FROM = {
					capital_scope = {
						colonial_region = PREV_PREV
					}
				}
			}
		}
	}

	is_allowed = {
		hidden_trigger = {
			ai = no
			FROM = {
				is_subject_of = ROOT
				is_colonial_subject_type = yes
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		custom_trigger_tooltip = {
			tooltip = COMBINE_COLONY_WITH_OTHER_COLONY_IN_SAME_COLONIAL_REGION_VALID_OTHER_COLONY_TT
			any_subject_country = {
				is_colonial_subject_type = yes
				NOT = { tag = FROM }
				ai = yes
				NOT = { liberty_desire = 50 }
				is_at_war = no
				capital_scope = {
					FROM = {
						capital_scope = {
							colonial_region = PREV_PREV
						}
					}
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				ai = no
				FROM = {
					is_subject_of = ROOT
					is_colonial_subject_type = yes
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				any_subject_country = {
					is_colonial_subject_type = yes
					NOT = { tag = FROM }
					ai = yes
					NOT = { liberty_desire = 50 }
					is_at_war = no
					capital_scope = {
						FROM = {
							capital_scope = {
								colonial_region = PREV_PREV
							}
						}
					}
				}
			}
			FROM = {
				add_liberty_desire = -10
			}
			every_subject_country = {
				limit = {
					is_colonial_subject_type = yes
					NOT = { tag = FROM }
					ai = yes
					NOT = { liberty_desire = 50 }
					is_at_war = no
					capital_scope = {
						FROM = {
							capital_scope = {
								colonial_region = PREV_PREV
							}
						}
					}
				}
				FROM = { inherit = PREV }
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

#subjects_expanded_diplomatic_actions_crusader_state_vassal
establish_crusader_state_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = crusader_state_vassal
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = crusader_state_vassal
		}
		if = {
			limit = {
				tag = PAP
			}
			OR = {
				any_country = {
					is_crusade_target = yes
				}
				is_papal_controller = yes
				religious_unity = 1
			}
		}
		else = {
			papal_influence = 20
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			variable_arithmetic_trigger = {
				custom_tooltip = HAS_LESS_THAN_HALF_OF_PREV_TOTAL_DEVELOPMENT
				export_to_variable = {
					which = our_total_dev
					value = trigger_value:total_development
				}
				#subtract_variable = { which = our_total_dev value = 1 }
				export_to_variable = {
					which = their_total_dev
					value = trigger_value:total_development
					who = PREV
				}
				#subtract_variable = { which = their_total_dev value = 1 }
				divide_variable = { which = their_total_dev value = 2 }
				NOT = { check_variable = { which = our_total_dev which = their_total_dev } }
			}
		}
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = crusader_state_vassal
				}
				if = {
					limit = {
						tag = PAP
					}
					OR = {
						any_country = {
							is_crusade_target = yes
						}
						is_papal_controller = yes
						religious_unity = 1
					}
				}
				else = {
					papal_influence = 20
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			if = {
				limit = {
					NOT = { tag = PAP }
				}
				add_papal_influence = -20
			}
			create_subject = {
				subject = FROM
				subject_type = crusader_state_vassal
			}
		}
	}
	
	ai_will_do = {
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
		any_country = {
			is_crusade_target = yes
		}
	}
}

send_crusader_knights_to_crusader_state_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		religion = catholic
		FROM = {
			religion = catholic
			is_subject_of = ROOT
			is_subject_of_type = crusader_state_vassal
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			religion = catholic
			FROM = {
				religion = catholic
				is_subject_of = ROOT
				is_subject_of_type = crusader_state_vassal
			}
		}
		manpower = 1
		treasury = 500
		FROM = {
			is_at_war = yes
		}
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			NOT = { has_country_modifier = send_crusader_knights_to_crusader_state_vassal }
		}
	}
	
	on_accept = {
		if = {
			limit = {
				religion = catholic
				FROM = {
					religion = catholic
					is_subject_of = ROOT
					is_subject_of_type = crusader_state_vassal
				}
				FROM = {
					is_at_war = yes
				}
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					NOT = { has_country_modifier = send_crusader_knights_to_crusader_state_vassal }
				}
			}
			add_manpower = -1
			add_treasury = -500
			FROM = {
				add_manpower = 1
				add_treasury = 500
				add_country_modifier = {
					name = send_crusader_knights_to_crusader_state_vassal
					duration = 1825
				}
			}
		}
	}
	
	ai_will_do = {
		crusade_target = {
			war_with = FROM
		}
		manpower = 10000
		treasury = 1500
	}
}

invite_missionars_from_crusader_state_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		religion = catholic
		FROM = {
			religion = catholic
			is_subject_of = ROOT
			is_subject_of_type = crusader_state_vassal
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			religion = catholic
			FROM = {
				religion = catholic
				is_subject_of = ROOT
				is_subject_of_type = crusader_state_vassal
			}
		}
		treasury = 1000
		is_at_war = no
		NOT = { num_of_missionaries = 4 }
		NOT = { has_country_modifier = invite_missionars_from_crusader_state_vassal }
		FROM = {
			is_at_war = no
		}
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				religion = catholic
				FROM = {
					religion = catholic
					is_subject_of = ROOT
					is_subject_of_type = crusader_state_vassal
				}
				treasury = 1000
				is_at_war = no
				NOT = { num_of_missionaries = 4 }
				NOT = { has_country_modifier = invite_missionars_from_crusader_state_vassal }
				FROM = {
					is_at_war = no
				}
				FROM = { NOT = { liberty_desire = 50 } }
			}
			add_treasury = -1000
			add_country_modifier = {
				name = invite_missionars_from_crusader_state_vassal
				duration = 1825
			}
			FROM = {
				add_treasury = 1000
				add_liberty_desire = 25
			}
		}
	}
	
	ai_will_do = {
		treasury = 2000
		NOT = { num_of_missionaries = 3 }
		FROM = {
			NOT = { liberty_desire = 25 }
		}
		NOT = { religious_unity = 0.5 }
	}
}

make_crusader_state_vassal_to_theocracy = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		religion = catholic
		government = theocracy
		FROM = {
			religion = catholic
			NOT = { government = theocracy }
			is_subject_of = ROOT
			is_subject_of_type = crusader_state_vassal
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			religion = catholic
			government = theocracy
			FROM = {
				religion = catholic
				NOT = { government = theocracy }
				is_subject_of = ROOT
				is_subject_of_type = crusader_state_vassal
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				religion = catholic
				government = theocracy
				FROM = {
					religion = catholic
					NOT = { government = theocracy }
					is_subject_of = ROOT
					is_subject_of_type = crusader_state_vassal
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = { NOT = { liberty_desire = 50 } }
			}
			FROM = {
				change_government = theocracy
				add_government_reform = leading_clergy_reform
				add_liberty_desire = 25
			}
		}
	}
	
	ai_will_do = {
		tag = PAP
		FROM = {
			NOT = { liberty_desire = 25 }
		}
	}
}

#subjects_expanded_diplomatic_actions_defensive_march
establish_defensive_march = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_subject = no
		can_create_subject_type = {
			subject = FROM
			subject_type = defensive_march
		}
	}

	is_allowed = {
		is_subject = no
		can_create_subject_type = {
			subject = FROM
			subject_type = defensive_march
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}

	on_accept = {
		if = {
			limit = {
				is_subject = no
				can_create_subject_type = {
					subject = FROM
					subject_type = defensive_march
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			create_subject = {
				subject = FROM
				subject_type = defensive_march
			}
		}
	}

	ai_will_do = {
		is_great_power = no
		NOT = { total_development = 500 }
		FROM = {
			NOT = { liberty_desire = 50 }
			NOT = { is_different_march_subject = yes }
			NOT = { development_of_overlord_fraction = 0.25 }
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
			num_of_owned_provinces_with = {
				value = 5
				fort_level = 2
			}
			any_neighbor_country = {
				OR = {
					is_rival = ROOT
					is_enemy = ROOT
				}
				army_strength = { who = ROOT value = 2.5 }
			}
			NOT = {
				num_of_owned_provinces_with = {
					value = 10
					is_permanent_claim = ROOT
				}
			}
		}
	}
}

ask_to_become_defensive_march = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_to_become_defensive_march_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			is_subject = no
			can_create_subject_type = {
				subject = ROOT
				subject_type = defensive_march
			}
		}
	}

	is_allowed = {
		FROM = {
			is_subject = no
			can_create_subject_type = {
				subject = ROOT
				subject_type = defensive_march
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					can_create_subject_type = {
						subject = ROOT
						subject_type = defensive_march
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = defensive_march
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					can_create_subject_type = {
						subject = ROOT
						subject_type = defensive_march
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			FROM = {
				clr_country_flag = declined_become_defensive_march_@ROOT
				set_country_flag = declined_become_defensive_march_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_defensive_march
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = ROOT_HAS_TOO_FEW_FORTS
			limit = {
				NOT = {
					num_of_owned_provinces_with = {
						value = 5
						fort_level = 2
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_VASSAL_FOR_AT_LEAST_10_YEARS
			limit = {
				years_in_vassalage_under = {
					who = FROM
					years = 10
					all_subject_country = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_NOT_A_NEIGHBOR_OF_FROMS_RIVALS
			limit = {
				NOT = {
					any_neighbor_country = {
						OR = {
							is_rival = FROM
							is_enemy = FROM
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_NOT_A_NEIGHBOR_OF_FROMS_STRONG_RIVALS
			limit = {
				any_neighbor_country = {
					OR = {
						is_rival = FROM
						is_enemy = FROM
					}
				}
				NOT = {
					any_neighbor_country = {
						OR = {
							is_rival = FROM
							is_enemy = FROM
						}
						army_strength = { who = FROM value = 2.5 }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_MORE_THAN_25_PERCENT_OF_OVERLORD_DEVELOPMENT
			limit = {
				development_of_overlord_fraction = 0.25
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_TOO_POWERFUL
			limit = {
				OR = {
					is_great_power = yes
					total_development = 500
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		NOT = { liberty_desire = 50 }
		NOT = { is_different_march_subject = yes }
		army_size = 20
		num_of_owned_provinces_with = {
			value = 10
			fort_level = 2
		}
		any_neighbor_country = {
			OR = {
				is_rival = FROM
				is_enemy = FROM
			}
		}
		FROM = {
			is_great_power = no
			NOT = { total_development = 500 }
			OR = {
				NOT = { has_country_flag = declined_become_defensive_march_@ROOT }
				had_country_flag = { flag = declined_become_defensive_march_@ROOT days = 1825 }
			}
		}
		NOT = {
			num_of_owned_provinces_with = {
				value = 10
				is_permanent_claim = FROM
			}
		}
	}
}

enable_offensive_wars_for_defensive_march = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = defensive_march
			NOT = { has_country_flag = call_defensive_march_to_offensive_war }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = defensive_march
				NOT = { has_country_flag = call_defensive_march_to_offensive_war }
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			custom_trigger_tooltip = {
				tooltip = HAS_NOT_DISABLED_OFFENSIVE_WARS_FOR_DEFENSIVE_MARCH_LAST_10_YEARS
				NOT = { has_country_modifier = switched_defensive_march_to_or_from_offensive_wars }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = defensive_march
					NOT = { has_country_flag = call_defensive_march_to_offensive_war }
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					NOT = { has_country_modifier = switched_defensive_march_to_or_from_offensive_wars }
				}
			}
			FROM = {
				set_country_flag = call_defensive_march_to_offensive_war
				country_event = { id = subjects_expanded_defensive_march_events.1 }
				add_country_modifier = {
					name = switched_defensive_march_to_or_from_offensive_wars
					duration = 3650
					hidden = yes
				}
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

disable_offensive_wars_for_defensive_march = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = defensive_march
			has_country_flag = call_defensive_march_to_offensive_war
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = defensive_march
				has_country_flag = call_defensive_march_to_offensive_war
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = {
			custom_trigger_tooltip = {
				tooltip = HAS_NOT_ENABLED_OFFENSIVE_WARS_FOR_DEFENSIVE_MARCH_LAST_10_YEARS
				NOT = { has_country_modifier = switched_defensive_march_to_or_from_offensive_wars }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = defensive_march
					has_country_flag = call_defensive_march_to_offensive_war
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					NOT = { has_country_modifier = switched_defensive_march_to_or_from_offensive_wars }
				}
			}
			FROM = {
				clr_country_flag = call_defensive_march_to_offensive_war
				country_event = { id = subjects_expanded_defensive_march_events.2 }
				add_country_modifier = {
					name = switched_defensive_march_to_or_from_offensive_wars
					duration = 3650
					hidden = yes
				}
			}
		}
	}

	ai_will_do = {
		always = yes
	}
}

#subjects_expanded_diplomatic_actions_dutch_province_subject
establish_dutch_province_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_dutch_province_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		NOT = { exists = NED }
		can_create_subject_type = {
			subject = FROM
			subject_type = dutch_province_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			NOT = { exists = NED }
		}
		can_create_subject_type = {
			subject = FROM
			subject_type = dutch_province_subject
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		army_size = FROM
		total_base_tax = FROM
		is_month = 1
		if = {
			limit = {
				FROM = {
					NOT = { is_subject_of = ROOT }
				}
			}
			alliance_with = FROM
		}
		else = {
			FROM = {
				NOT = { liberty_desire = 50 }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				NOT = { exists = NED }
				can_create_subject_type = {
					subject = FROM
					subject_type = dutch_province_subject
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				army_size = FROM
				total_base_tax = FROM
				is_month = 1
				if = {
					limit = {
						FROM = {
							NOT = { is_subject_of = ROOT }
						}
					}
					alliance_with = FROM
				}
				else = {
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			create_subject = {
				subject = FROM
				subject_type = dutch_province_subject
			}
			add_truce_with = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				NOT = { exists = NED }
				can_create_subject_type = {
					subject = FROM
					subject_type = dutch_province_subject
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				army_size = FROM
				total_base_tax = FROM
				is_month = 1
				if = {
					limit = {
						FROM = {
							NOT = { is_subject_of = ROOT }
						}
					}
					alliance_with = FROM
				}
				else = {
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			FROM = {
				clr_country_flag = declined_establish_dutch_province_subject_@ROOT
				set_country_flag = declined_establish_dutch_province_subject_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_dutch_province_subject_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_IS_VASSAL_OF_ROOT
			limit = {
				overlord_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				overlord_of = FROM
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_DIFF_OF_GOV_RANKS
			export_to_variable = {
				which = ai_value
				value = trigger_value:government_rank
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:government_rank
				who = FROM
			}
			subtract_variable = { which = ai_value which = ai_value_2 }
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			export_to_variable = {
				which = ai_value
				value = army_size
			}
			export_to_variable = {
				which = ai_value_2
				value = army_size
				who = FROM
			}
			multiply_variable = { which = ai_value_2 value = 1.5 }
			subtract_variable = { which = ai_value which = ai_value_2 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 75
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = yes
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				FROM = {
					tag = PAP
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				NOT = { overlord_of = FROM }
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_HAVE_SAME_PRIMARY_CULTURE
			limit = {
				primary_culture = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				FROM = {
					has_reform = free_city
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPEROR
			limit = {
				FROM = {
					is_emperor = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_NUM_OF_PROVINCES
			export_to_variable = {
				which = ai_value
				value = num_of_cities
				who = FROM
			}
			multiply_variable = { which = ai_value value = -5 }
		}
		add_entry = {
			name = FROM_IS_FRISIAN
			limit = {
				FROM = {
					primary_culture = frisian
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_WALLONIAN
			limit = {
				FROM = {
					primary_culture = wallonian
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_FRISIAN
			limit = {
				primary_culture = frisian
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_WALLONIAN
			limit = {
				primary_culture = wallonian
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		NOT = { has_country_flag = formed_netherlands_flag }
		OR = {
			tag = HOL
			tag = UTR
			tag = GEL
			has_subject_of_type = dutch_province_subject
		}
		OR = {
			owns = 95
			owns = 96
			owns = 97
			owns = 98
			owns = 99
			owns = 100
			owns = 4383
		}
		OR = {
			NOT = { primary_culture = frisian }
			FROM = {
				NOT = { primary_culture = frisian }
			}
		}
		OR = {
			NOT = { primary_culture = wallonian }
			FROM = {
				NOT = { primary_culture = wallonian }
			}
		}
		FROM = {
			OR = {
				owns = 95
				owns = 96
				owns = 97
				owns = 98
				owns = 99
				owns = 100
				owns = 4383
			}
			OR = {
				NOT = { has_country_flag = declined_establish_dutch_province_subject_@ROOT }
				had_country_flag = { flag = declined_establish_dutch_province_subject_@ROOT days = 1825 }
			}
		}
	}
}

ask_for_dutch_province_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_for_dutch_province_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		NOT = { exists = NED }
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = dutch_province_subject
			}
		}
	}

	is_allowed = {
		hidden_trigger = {
			NOT = { exists = NED }
		}
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = dutch_province_subject
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			army_size = ROOT
		}
		FROM = {
			total_base_tax = ROOT
		}
		is_month = 1
		if = {
			limit = {
				NOT = { is_subject_of = FROM }
			}
			alliance_with = FROM
		}
		else = {
			NOT = { liberty_desire = 50 }
		}
	}

	on_accept = {
		if = {
			limit = {
				NOT = { exists = NED }
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = dutch_province_subject
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					army_size = ROOT
				}
				FROM = {
					total_base_tax = ROOT
				}
				is_month = 1
				if = {
					limit = {
						NOT = { is_subject_of = FROM }
					}
					alliance_with = FROM
				}
				else = {
					NOT = { liberty_desire = 50 }
				}
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = dutch_province_subject
				}
				add_truce_with = ROOT
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				NOT = { exists = NED }
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = dutch_province_subject
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					army_size = ROOT
				}
				FROM = {
					total_base_tax = ROOT
				}
				is_month = 1
				if = {
					limit = {
						NOT = { is_subject_of = FROM }
					}
					alliance_with = FROM
				}
				else = {
					NOT = { liberty_desire = 50 }
				}
			}
			clr_country_flag = declined_establish_dutch_province_subject_@FROM
			set_country_flag = declined_establish_dutch_province_subject_@FROM
			add_opinion = {
				who = FROM
				modifier = declined_ask_for_dutch_province_subject_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = ROOT_IS_VASSAL_OF_FROM
			limit = {
				is_subject_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
		}
		add_entry = {
			name = ROOT_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				is_subject_of = FROM
				liberty_desire = 50
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_DIFF_OF_GOV_RANKS
			export_to_variable = {
				which = ai_value
				value = trigger_value:government_rank
				who = FROM
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:government_rank
			}
			subtract_variable = { which = ai_value which = ai_value_2 }
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			export_to_variable = {
				which = ai_value
				value = army_size
				who = FROM
			}
			export_to_variable = {
				which = ai_value_2
				value = army_size
			}
			multiply_variable = { which = ai_value_2 value = 1.5 }
			subtract_variable = { which = ai_value which = ai_value_2 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				NOT = { is_subject_of = FROM }
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_HAVE_SAME_PRIMARY_CULTURE
			limit = {
				primary_culture = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = ROOT_NUM_OF_PROVINCES
			export_to_variable = {
				which = ai_value
				value = num_of_cities
			}
			multiply_variable = { which = ai_value value = -4 }
		}
		add_entry = {
			name = STRATEGIC_VALUE
			limit = {
				NOT = {
					AND = {
						FROM = {
							NOT = { has_country_flag = formed_netherlands_flag }
							OR = {
								tag = HOL
								tag = UTR
								tag = GEL
								has_subject_of_type = dutch_province_subject
							}
							OR = {
								owns = 95
								owns = 96
								owns = 97
								owns = 98
								owns = 99
								owns = 100
								owns = 4383
							}
						}
						OR = {
							NOT = { primary_culture = frisian }
							FROM = {
								NOT = { primary_culture = frisian }
							}
						}
						OR = {
							NOT = { primary_culture = wallonian }
							FROM = {
								NOT = { primary_culture = wallonian }
							}
						}
						OR = {
							owns = 95
							owns = 96
							owns = 97
							owns = 98
							owns = 99
							owns = 100
							owns = 4383
						}
						OR = {
							NOT = { has_country_flag = declined_establish_dutch_province_subject_@FROM }
							had_country_flag = { flag = declined_establish_dutch_province_subject_@FROM days = 1825 }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_FRISIAN
			limit = {
				FROM = {
					primary_culture = frisian
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_WALLONIAN
			limit = {
				FROM = {
					primary_culture = wallonian
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_FRISIAN
			limit = {
				primary_culture = frisian
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_WALLONIAN
			limit = {
				primary_culture = wallonian
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		OR = {
			owns = 95
			owns = 96
			owns = 97
			owns = 98
			owns = 99
			owns = 100
			owns = 4383
		}
		OR = {
			NOT = { has_country_flag = declined_establish_dutch_province_subject_@FROM }
			had_country_flag = { flag = declined_establish_dutch_province_subject_@FROM days = 1825 }
		}
		NOT = { has_reform = free_city }
		is_emperor = no
		NOT = { num_of_subjects = 1 }
		NOT = { num_of_cities = 20 }
		NOT = { num_of_cities = FROM }
		OR = {
			NOT = { primary_culture = frisian }
			FROM = {
				NOT = { primary_culture = frisian }
			}
		}
		OR = {
			NOT = { primary_culture = wallonian }
			FROM = {
				NOT = { primary_culture = wallonian }
			}
		}
		FROM = {
			NOT = { has_country_flag = formed_netherlands_flag }
			OR = {
				tag = HOL
				tag = UTR
				tag = GEL
				overlord_of = ROOT
				has_subject_of_type = dutch_province_subject
			}
			OR = {
				owns = 95
				owns = 96
				owns = 97
				owns = 98
				owns = 99
				owns = 100
				owns = 4383
			}
		}
	}
}

dutch_province_subject_ask_for_independence = {
	category = influence

	alert_index = 2
	alert_tooltip = dutch_province_subject_ask_for_independence_alert_tooltip

	require_acceptance = yes

	is_visible = {
		NOT = { has_global_flag = dutch_province_subject_no_leader_election }
		is_subject_of = FROM
		is_subject_of_type = dutch_province_subject
	}

	is_allowed = {
		hidden_trigger = {
			NOT = { has_global_flag = dutch_province_subject_no_leader_election }
			is_subject_of = FROM
			is_subject_of_type = dutch_province_subject
		}
		is_at_war = no
		liberty_desire = 50
		NOT = { truce_with = FROM }
		is_month = 1
		custom_trigger_tooltip = {
			tooltip = DID_NOT_ASK_FOR_INDEPENDENCE_WITHIN_LAST_6_MONTHS
			NOT = { has_country_modifier = cooldown_dutch_province_subject_ask_for_independence }
		}
	}

	on_accept = {
		if = {
			limit = {
				NOT = { has_global_flag = dutch_province_subject_no_leader_election }
				is_subject_of = FROM
				is_subject_of_type = dutch_province_subject
				is_at_war = no
				liberty_desire = 50
				NOT = { truce_with = FROM }
				is_month = 1
			}
			FROM = {
				ROOT = { grant_independence = yes }
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				NOT = { has_global_flag = dutch_province_subject_no_leader_election }
				is_subject_of = FROM
				is_subject_of_type = dutch_province_subject
				is_at_war = no
				liberty_desire = 50
				NOT = { truce_with = FROM }
				is_month = 1
			}
			add_liberty_desire = 50
			add_opinion = {
				who = FROM
				modifier = dutch_province_subject_declined_freedom
			}
			add_country_modifier = {
				name = cooldown_dutch_province_subject_ask_for_independence
				duration = 183
				hidden = yes
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = ROOT_LIBERTY_DESIRE_TOO_LOW
			limit = {
				NOT = { liberty_desire = 50 }
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_LIBERTY_DESIRE
			limit = {
				liberty_desire = 50
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:liberty_desire
			}
			subtract_variable = { which = ai_value value = 51 }
			divide_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			export_to_variable = {
				which = ai_value
				value = army_size
				who = FROM
			}
			export_to_variable = {
				which = ai_value_2
				value = army_size
			}
			divide_variable = { which = ai_value value = 2 }
			subtract_variable = { which = ai_value which = ai_value_2 }
		}
		add_entry = {
			name = ROOT_AMOUNT_OF_ALLIANCES
			limit = {
				num_of_allies = 1
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:num_of_allies
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = FROM_AMOUNT_OF_ALLIANCES
			limit = {
				num_of_allies = 1
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:num_of_allies
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			multiply_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = ROOT_HAS_NO_ALLIANCES
			limit = {
				NOT = { num_of_allies = 1 }
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -5 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				historical_friend_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = FROM_COULD_PERHAPS_ENACT_A_REFORM
			limit = {
				FROM = {
					OR = {
						NOT = { has_global_flag = dutch_province_subject_no_internal_war }
						AND = {
							NOT = { has_global_flag = dutch_province_subject_no_external_war }
							had_global_flag = { flag = dutch_province_subject_no_internal_war days = 1460 }
						}
						AND = {
							NOT = { has_global_flag = dutch_province_subject_no_leader_election }
							had_global_flag = { flag = dutch_province_subject_no_external_war days = 1460 }
						}
					}
					is_subject = no
					is_nomad = no
					stability = 1
					adm_power = 150
					dip_power = 150
					mil_power = 150
					calc_true_if = {
						all_subject_country = {
							is_subject_of_type = dutch_province_subject
						}
						amount = 2
					}
				}
				years_in_vassalage_under = {
					who = FROM
					years = 1
					all_subject_country = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_DUTCH_PROVINCES_REFORMS_PASSED
			limit = {
				has_global_flag = dutch_province_subject_no_internal_war
				NOT = { has_global_flag = dutch_province_subject_no_external_war }
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_DUTCH_PROVINCES_REFORMS_PASSED
			limit = {
				has_global_flag = dutch_province_subject_no_external_war
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		num_of_allies = 1
		liberty_desire = 70
	}
}

dutch_province_subject_force_white_peace = {
	category = influence

	alert_index = 2
	alert_tooltip = dutch_province_subject_force_white_peace_alert_tooltip

	require_acceptance = yes

	is_visible = {
		has_global_flag = dutch_province_subject_no_leader_election
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = dutch_province_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			has_global_flag = dutch_province_subject_no_leader_election
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = dutch_province_subject
			}
		}
		is_at_war = no
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = WAS_NOT_FORCED_TO_DO_WHITE_PEACE_WITHIN_LAST_YEAR
				NOT = { has_country_modifier = cooldown_dutch_province_subject_force_white_peace }
			}
		}
		FROM = {
			is_at_war = yes
			custom_trigger_tooltip = {
				tooltip = IS_AT_LEAST_IN_ONE_WAR_WHERE_THEY_ARE_NOT_WARLEADER
				any_country = {
					war_with = FROM
					NOT = {
						is_in_war = {
							participants = THIS
							participants = FROM
							attacker_leader = FROM
						}
					}
					NOT = {
						is_in_war = {
							participants = THIS
							participants = FROM
							defender_leader = FROM
						}
					}
				}
			}
		}
		custom_trigger_tooltip = {
			tooltip = HAS_LARGER_ARMY_SIZE_THAN_ALL_WAR_LEADERS_AGAINST_FROM
			all_country = {
				OR = {
					NOT = { war_with = FROM }
					NOT = {
						OR = {
							is_in_war = {
								participants = THIS
								participants = FROM
								attacker_leader = THIS
							}
							is_in_war = {
								participants = THIS
								participants = FROM
								defender_leader = THIS
							}
						}
					}
					ROOT = { army_size = PREV }
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				has_global_flag = dutch_province_subject_no_leader_election
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = dutch_province_subject
				}
				is_at_war = no
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					NOT = { has_country_modifier = cooldown_dutch_province_subject_force_white_peace }
				}
				FROM = {
					is_at_war = yes
					custom_trigger_tooltip = {
						tooltip = IS_AT_LEAST_IN_ONE_WAR_WHERE_THEY_ARE_NOT_WARLEADER
						any_country = {
							war_with = PREV
							NOT = {
								is_in_war = {
									participants = THIS
									participants = PREV
									attacker_leader = PREV
								}
							}
							NOT = {
								is_in_war = {
									participants = THIS
									participants = PREV
									defender_leader = PREV
								}
							}
						}
					}
				}
				all_country = {
					OR = {
						NOT = { war_with = FROM }
						NOT = {
							OR = {
								is_in_war = {
									participants = THIS
									participants = FROM
									attacker_leader = THIS
								}
								is_in_war = {
									participants = THIS
									participants = FROM
									defender_leader = THIS
								}
							}
						}
						ROOT = { army_size = PREV }
					}
				}
			}
			FROM = {
				add_liberty_desire = 50
				add_country_modifier = {
					name = cooldown_dutch_province_subject_force_white_peace
					duration = 365
					hidden = yes
				}
				every_owned_province = {
					limit = {
						NOT = { controlled_by = PREV }
						NOT = { controlled_by = REB }
						NOT = { is_permanent_claim = controller }
						NOT = { is_core = controller }
					}
					controller = {
						add_claim = PREV
					}
				}
				every_country = {
					limit = {
						war_with = PREV
						NOT = {
							is_in_war = {
								participants = THIS
								participants = PREV
								attacker_leader = PREV
							}
						}
						NOT = {
							is_in_war = {
								participants = THIS
								participants = PREV
								defender_leader = PREV
							}
						}
					}
					white_peace = PREV
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				has_global_flag = dutch_province_subject_no_leader_election
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = dutch_province_subject
				}
				is_at_war = no
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					NOT = { has_country_modifier = cooldown_dutch_province_subject_force_white_peace }
				}
				FROM = {
					is_at_war = yes
					custom_trigger_tooltip = {
						tooltip = IS_AT_LEAST_IN_ONE_WAR_WHERE_THEY_ARE_NOT_WARLEADER
						any_country = {
							war_with = PREV
							NOT = {
								is_in_war = {
									participants = THIS
									participants = PREV
									attacker_leader = PREV
								}
							}
							NOT = {
								is_in_war = {
									participants = THIS
									participants = PREV
									defender_leader = PREV
								}
							}
						}
					}
				}
				all_country = {
					OR = {
						NOT = { war_with = FROM }
						NOT = {
							OR = {
								is_in_war = {
									participants = THIS
									participants = FROM
									attacker_leader = THIS
								}
								is_in_war = {
									participants = THIS
									participants = FROM
									defender_leader = THIS
								}
							}
						}
						ROOT = { army_size = PREV }
					}
				}
			}
			FROM = {
				add_liberty_desire = 25
				add_country_modifier = {
					name = cooldown_dutch_province_subject_force_white_peace
					duration = 365
					hidden = yes
				}
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = base_values
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_ENEMY_CONTROLLED_PROVINCES
			limit = {
				FROM = {
					any_owned_province = {
						NOT = { controlled_by = PREV }
						NOT = { controlled_by = REB }
					}
					NOT = {
						calc_true_if = {
							all_owned_province = {
								NOT = { controlled_by = PREV }
								NOT = { controlled_by = REB }
							}
							amount = 2
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_HAS_ENEMY_CONTROLLED_PROVINCES
			limit = {
				FROM = {
					calc_true_if = {
						all_owned_province = {
							NOT = { controlled_by = PREV }
							NOT = { controlled_by = REB }
						}
						amount = 2
					}
					NOT = {
						calc_true_if = {
							all_owned_province = {
								NOT = { controlled_by = PREV }
								NOT = { controlled_by = REB }
							}
							amount = 4
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = FROM_HAS_ENEMY_CONTROLLED_PROVINCES
			limit = {
				FROM = {
					calc_true_if = {
						all_owned_province = {
							NOT = { controlled_by = PREV }
							NOT = { controlled_by = REB }
						}
						amount = 4
					}
					NOT = {
						calc_true_if = {
							all_owned_province = {
								NOT = { controlled_by = PREV }
								NOT = { controlled_by = REB }
							}
							amount = 6
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_HAS_ENEMY_CONTROLLED_PROVINCES
			limit = {
				FROM = {
					calc_true_if = {
						all_owned_province = {
							NOT = { controlled_by = PREV }
							NOT = { controlled_by = REB }
						}
						amount = 6
					}
					NOT = {
						calc_true_if = {
							all_owned_province = {
								NOT = { controlled_by = PREV }
								NOT = { controlled_by = REB }
							}
							amount = 8
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
		}
		add_entry = {
			name = FROM_HAS_ENEMY_CONTROLLED_PROVINCES
			limit = {
				FROM = {
					calc_true_if = {
						all_owned_province = {
							NOT = { controlled_by = PREV }
							NOT = { controlled_by = REB }
						}
						amount = 8
					}
					NOT = {
						calc_true_if = {
							all_owned_province = {
								NOT = { controlled_by = PREV }
								NOT = { controlled_by = REB }
							}
							amount = 10
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_HAS_ENEMY_CONTROLLED_PROVINCES
			limit = {
				FROM = {
					calc_true_if = {
						all_owned_province = {
							NOT = { controlled_by = PREV }
							NOT = { controlled_by = REB }
						}
						amount = 10
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 75
			}
		}
		add_entry = {
			name = FROM_NUM_OF_PROVINCES
			export_to_variable = {
				which = ai_value
				value = trigger_value:num_of_cities
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = FROM_HAS_OWN_CONTROLLED_PROVINCES
			limit = {
				any_province = {
					NOT = { owned_by = FROM }
					controlled_by = FROM
				}
				NOT = {
					calc_true_if = {
						all_province = {
							NOT = { owned_by = FROM }
							controlled_by = FROM
						}
						amount = 2
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_OWN_CONTROLLED_PROVINCES
			limit = {
				calc_true_if = {
					all_province = {
						NOT = { owned_by = FROM }
						controlled_by = FROM
					}
					amount = 2
				}
				NOT = {
					calc_true_if = {
						all_province = {
							NOT = { owned_by = FROM }
							controlled_by = FROM
						}
						amount = 4
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_OWN_CONTROLLED_PROVINCES
			limit = {
				calc_true_if = {
					all_province = {
						NOT = { owned_by = FROM }
						controlled_by = FROM
					}
					amount = 4
				}
				NOT = {
					calc_true_if = {
						all_province = {
							NOT = { owned_by = FROM }
							controlled_by = FROM
						}
						amount = 6
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_OWN_CONTROLLED_PROVINCES
			limit = {
				calc_true_if = {
					all_province = {
						NOT = { owned_by = FROM }
						controlled_by = FROM
					}
					amount = 6
				}
				NOT = {
					calc_true_if = {
						all_province = {
							NOT = { owned_by = FROM }
							controlled_by = FROM
						}
						amount = 8
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_OWN_CONTROLLED_PROVINCES
			limit = {
				calc_true_if = {
					all_province = {
						NOT = { owned_by = FROM }
						controlled_by = FROM
					}
					amount = 8
				}
				NOT = {
					calc_true_if = {
						all_province = {
							NOT = { owned_by = FROM }
							controlled_by = FROM
						}
						amount = 10
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_OWN_CONTROLLED_PROVINCES
			limit = {
				calc_true_if = {
					all_province = {
						NOT = { owned_by = FROM }
						controlled_by = FROM
					}
					amount = 10
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_CAPITAL_CONTROLLED_BY_ENEMY
			limit = {
				FROM = {
					capital_scope = {
						NOT = { controlled_by = PREV }
						NOT = { controlled_by = REB }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
		add_entry = {
			name = FROM_ENEMY_ARMIES_ON_CORE_TERRITORY
			limit = {
				FROM = {
					any_owned_province = {
						is_core = PREV
						any_country = {
							war_with = FROM
							NOT = {
								is_in_war = {
									participants = THIS
									participants = FROM
									attacker_leader = FROM
								}
							}
							NOT = {
								is_in_war = {
									participants = THIS
									participants = FROM
									defender_leader = FROM
								}
							}
							PREV = {
								num_of_units_in_province = {
									who = PREV
									amount = 5
								}
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ARMY_SIZE
			export_to_variable = {
				which = ai_value
				value = trigger_value:army_size
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE
			export_to_variable = {
				which = ai_value
				value = trigger_value:liberty_desire
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -2 }
		}
	}

	ai_will_do = {
		calc_true_if = {
			all_subject_country = {
				is_subject_of_type = dutch_province_subject
			}
			amount = 2
		}
		NOT = {
			calc_true_if = {
				all_subject_country = {
					is_subject_of_type = dutch_province_subject
				}
				amount = 3
			}
		}
		FROM = {
			any_owned_province = {
				NOT = { controlled_by = PREV }
				NOT = { controlled_by = REB }
			}
		}
	}
}

cancel_dutch_province_subject = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = dutch_province_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = dutch_province_subject
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
		is_month = 1
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = dutch_province_subject
				}
				NOT = { truce_with = FROM }
				prestige = 0
				is_month = 1
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		OR = {
			AND = {
				exists = NED
				NOT = { tag = NED }
			}
			FROM = {
				liberty_desire = 100
				years_in_vassalage_under = {
					who = ROOT
					years = 50
					all_subject_country = yes
				}
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_fief_subject
establish_fief_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_fief_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = fief_subject
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = fief_subject
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		if = {
			limit = {
				FROM = {
					NOT = { is_subject_of = ROOT }
				}
			}
			FROM = {
				has_opinion = {
					who = ROOT
					value = 150
				}
			}
			alliance_with = FROM
			FROM = {
				NOT = { total_development = 100 }
			}
		}
		else = {
			FROM = {
				NOT = { liberty_desire = 50 }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = fief_subject
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				if = {
					limit = {
						FROM = {
							NOT = { is_subject_of = ROOT }
						}
					}
					FROM = {
						has_opinion = {
							who = ROOT
							value = 150
						}
					}
					alliance_with = FROM
					FROM = {
						NOT = { total_development = 100 }
					}
				}
				else = {
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			create_subject = {
				subject = FROM
				subject_type = fief_subject
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = fief_subject
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				if = {
					limit = {
						FROM = {
							NOT = { is_subject_of = ROOT }
						}
					}
					FROM = {
						has_opinion = {
							who = ROOT
							value = 150
						}
					}
					alliance_with = FROM
					FROM = {
						NOT = { total_development = 100 }
					}
				}
				else = {
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			FROM = {
				clr_country_flag = declined_establish_fief_subject_@ROOT
				set_country_flag = declined_establish_fief_subject_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_fief_subject_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_IS_VASSAL_OF_ROOT
			limit = {
				overlord_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				overlord_of = FROM
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_DIFF_OF_GOV_RANKS
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:government_rank
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:government_rank
				who = FROM
			}
			subtract_variable = { which = ai_value which = ai_value_2 }
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { overlord_of = FROM }
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { overlord_of = FROM }
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				NOT = { overlord_of = FROM }
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				NOT = { overlord_of = FROM }
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 75
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				NOT = { overlord_of = FROM }
				is_part_of_hre = yes
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					tag = PAP
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MORE_THAN_100_TOTAL_DEVELOPMENT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					total_development = 100
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				NOT = { overlord_of = FROM }
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = -89 }
					NOT = { check_variable = { which = eco_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					NOT = { check_variable = { which = eco_power value = -89 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_FROM_HAVE_SAME_PRIMARY_CULTURE
			limit = {
				NOT = { overlord_of = FROM }
				primary_culture = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					has_reform = free_city
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_CLAIMED_CULTURAL_HEGEMONY
			limit = {
				is_expanded_mod_active = { mod = peace_treaties }
				has_country_modifier = pte_culture_group_hegemony_modifier
				NOT = { is_variable_equal = { which = pte_culture_group_hegemony_var value = 0 } }
				FROM = {
					culture_group = variable:Root:pte_culture_group_hegemony_var
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
	}

	ai_will_do = {
		is_emperor = no
		NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = fief_subject } amount = 5 } }
		num_of_free_diplomatic_relations = 1
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_establish_fief_subject_@ROOT }
				had_country_flag = { flag = declined_establish_fief_subject_@ROOT days = 1825 }
			}
			NOT = { is_subject_of = ROOT }
		}
	}
}

demand_troops_from_fief_subject = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = fief_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = fief_subject
			}
		}
		FROM = {
			is_at_war = no
		}
		FROM = {
			num_of_infantry = 10
		}
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_DEMAND_TROOPS_OF_FIEF_WITHIN_LAST_10_YEARS
				NOT = { has_country_modifier = cooldown_demand_troops_from_fief_subject }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = fief_subject
				}
				FROM = {
					is_at_war = no
				}
				FROM = {
					num_of_infantry = 10
				}
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					NOT = { has_country_modifier = cooldown_demand_troops_from_fief_subject }
				}
			}
			capital_scope = {
				infantry = ROOT
				infantry = ROOT
				infantry = ROOT
				infantry = ROOT
				infantry = ROOT
			}
			FROM = {
				add_liberty_desire = 10
				add_country_modifier = {
					name = cooldown_demand_troops_from_fief_subject
					duration = 1825
					hidden = yes
				}
				country_event = { id = subjects_expanded_fief_subject_events.1 }
			}
			random_province = {
				limit = {
					infantry_in_province = FROM
				}
				kill_units = {
					who = FROM
					type = infantry
					amount = 1
				}
			}
			random_province = {
				limit = {
					infantry_in_province = FROM
				}
				kill_units = {
					who = FROM
					type = infantry
					amount = 1
				}
			}
			random_province = {
				limit = {
					infantry_in_province = FROM
				}
				kill_units = {
					who = FROM
					type = infantry
					amount = 1
				}
			}
			random_province = {
				limit = {
					infantry_in_province = FROM
				}
				kill_units = {
					who = FROM
					type = infantry
					amount = 1
				}
			}
			random_province = {
				limit = {
					infantry_in_province = FROM
				}
				kill_units = {
					who = FROM
					type = infantry
					amount = 1
				}
			}
		}
	}

	ai_will_do = {
		is_at_war = yes
		NOT = { manpower = 1 }
		NOT = { army_size = 30 }
		FROM = {
			NOT = { liberty_desire = 40 }
		}
		NOT = {
			calc_true_if = {
				all_subject_country = {
					has_country_modifier = cooldown_demand_troops_from_fief_subject
				}
				amount = 2
			}
		}
	}
}

enforce_call_to_arms_from_fief_subject = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = fief_subject
		}
		is_at_war = yes
		OR = {
			is_in_war = {
				attacker_leader = ROOT
			}
			is_in_war = {
				defender_leader = ROOT
			}
		}
		any_country = {
			OR = {
				is_in_war = {
					attacker_leader = ROOT
					defender_leader = THIS
				}
				is_in_war = {
					attacker_leader = THIS
					defender_leader = ROOT
				}
			}
			NOT = { war_with = FROM }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = fief_subject
			}
			is_at_war = yes
			OR = {
				is_in_war = {
					attacker_leader = ROOT
				}
				is_in_war = {
					defender_leader = ROOT
				}
			}
			any_country = {
				OR = {
					is_in_war = {
						attacker_leader = ROOT
						defender_leader = THIS
					}
					is_in_war = {
						attacker_leader = THIS
						defender_leader = ROOT
					}
				}
				NOT = { war_with = FROM }
			}
		}
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = fief_subject
				}
				is_at_war = yes
				OR = {
					is_in_war = {
						attacker_leader = ROOT
					}
					is_in_war = {
						defender_leader = ROOT
					}
				}
				any_country = {
					OR = {
						is_in_war = {
							attacker_leader = ROOT
							defender_leader = THIS
						}
						is_in_war = {
							attacker_leader = THIS
							defender_leader = ROOT
						}
					}
					NOT = { war_with = FROM }
				}
				FROM = { NOT = { liberty_desire = 50 } }
			}
			FROM = {
				add_liberty_desire = 25
				join_all_defensive_wars_of = ROOT
				join_all_offensive_wars_of = ROOT
				country_event = { id = subjects_expanded_fief_subject_events.2 }
			}
		}
	}

	ai_will_do = {
		is_at_war = yes
		NOT = { war_score = -20 }
		FROM = {
			army_size = 5
			NOT = { liberty_desire = 30 }
		}
	}
}

cancel_fief_subject = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = fief_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = fief_subject
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = fief_subject
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 25
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_imperial_feud_subject
establish_imperial_feud_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_imperial_feud_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = imperial_feud_subject
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = imperial_feud_subject
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		imperial_influence = 5
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = imperial_feud_subject
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				imperial_influence = 5
			}
			add_imperial_influence = -5
			create_subject = {
				subject = FROM
				subject_type = imperial_feud_subject
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = imperial_feud_subject
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				imperial_influence = 5
			}
			FROM = {
				clr_country_flag = declined_establish_imperial_feud_subject_@ROOT
				set_country_flag = declined_establish_imperial_feud_subject_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_imperial_feud_subject_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_threatened }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_rivalry }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			limit = {
				diplomatic_reputation = 0
			}
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			limit = {
				NOT = { diplomatic_reputation = 0 }
			}
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				OR = {
					any_owned_province = {
						is_core = FROM
					}
					any_subject_country = {
						is_subject_other_than_tributary_trigger = yes
						any_owned_province = {
							is_core = FROM
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -4 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_NEIGHBOR_OUTSIDE_OF_HRE
			limit = {
				FROM = {
					any_neighbor_country = {
						is_part_of_hre = no
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = this_army_size
								value = trigger_value:army_size
							}
							export_to_variable = {
								which = our_army_size
								value = trigger_value:army_size
								who = ROOT
							}
							export_to_variable = {
								which = their_army_size
								value = trigger_value:army_size
								who = FROM
							}
							divide_variable = { which = this_army_size value = 2 }
							divide_variable = { which = our_army_size value = 3 }
							check_variable = { which = this_army_size which = their_army_size }
							check_variable = { which = our_army_size which = this_army_size }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_HAS_STRONG_NEIGHBOR_OUTSIDE_OF_HRE
			limit = {
				FROM = {
					any_neighbor_country = {
						is_part_of_hre = no
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = this_army_size
								value = trigger_value:army_size
							}
							export_to_variable = {
								which = our_army_size
								value = trigger_value:army_size
								who = ROOT
							}
							export_to_variable = {
								which = their_army_size
								value = trigger_value:army_size
								who = FROM
							}
							divide_variable = { which = this_army_size value = 2 }
							divide_variable = { which = our_army_size value = 3 }
							check_variable = { which = this_army_size which = their_army_size }
							NOT = { check_variable = { which = our_army_size which = this_army_size } }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				FROM = {
					tag = PAP
					is_papal_controller = no
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_CURIA_CONTROLLER
			limit = {
				FROM = {
					is_papal_controller = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				FROM = {
					historical_friend_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_AI_PERSONALITY
			limit = {
				FROM = {
					personality = ai_militarist
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = AMOUNT_OF_IMPERIAL_INFLUENCE
			export_to_variable = {
				which = ai_value
				value = trigger_value:imperial_influence
			}
			#change_variable = { which = ai_value value = -1 }
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = FROM_OWNS_HRE_PROVINCES
			limit = {
				FROM = {
					NOT = { total_development = 100 }
					any_owned_province = {
						is_part_of_hre = yes
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = FROM_OWNS_HRE_PROVINCES_BUT_IS_LARGE
			limit = {
				FROM = {
					total_development = 100
					any_owned_province = {
						is_part_of_hre = yes
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_LEFT_DURING_SHADOW_KINGDOM_EVENT
			limit = {
				FROM = {
					has_country_flag = was_member_of_HRE_and_left
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		imperial_influence = 10
		OR = {
			NOT = { religion = catholic }
			FROM = {
				NOT = { tag = PAP }
			}
		}
		FROM = {
			NOT = { total_development = 200 }
			OR = {
				NOT = { has_country_flag = declined_establish_imperial_feud_subject_@ROOT }
				had_country_flag = { flag = declined_establish_imperial_feud_subject_@ROOT days = 1825 }
			}
		}
	}
}

ask_for_imperial_feud_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_for_imperial_feud_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = imperial_feud_subject
			}
		}
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = imperial_feud_subject
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			imperial_influence = 5
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = imperial_feud_subject
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					imperial_influence = 5
				}
			}
			FROM = {
				add_imperial_influence = -5
				create_subject = {
					subject = ROOT
					subject_type = imperial_feud_subject
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = imperial_feud_subject
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					imperial_influence = 5
				}
			}
			clr_country_flag = declined_establish_imperial_feud_subject_@FROM
			set_country_flag = declined_establish_imperial_feud_subject_@FROM
			add_opinion = {
				who = FROM
				modifier = declined_ask_for_imperial_feud_subject_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_protective }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_rivalry }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = ROOT_IS_EMPIRE_RANK
			limit = {
				government_rank = 3
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_IS_KINGDOM_RANK
			limit = {
				government_rank = 2
				NOT = { government_rank = 3 }
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
				who = FROM
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -4 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_PAPAL_STATE
			limit = {
				FROM = {
					religion = catholic
				}
				tag = PAP
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				FROM = {
					historical_friend_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_AI_PERSONALITY
			limit = {
				FROM = {
					personality = ai_militarist
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_HRE_PROVINCES
			limit = {
				any_owned_province = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_TOO_HIGH_DEVELOPMENT
			limit = {
				total_development = 200
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_HRE_MEMBERS
			limit = {
				NOT = { hre_size = 25 }
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:hre_size
			}
			#change_variable = { which = ai_value_2 value = -1 }
			subtract_variable = { which = ai_value which = ai_value_2 }
			multiply_variable = { which = ai_value value = 5 }
		}
	}

	ai_will_do = {
		is_papal_controller = no
		NOT = { personality = ai_militarist }
		NOT = { government_rank = 2 }
		NOT = { num_of_subjects = 1 }
		OR = {
			NOT = { has_country_flag = declined_establish_imperial_feud_subject_@FROM }
			had_country_flag = { flag = declined_establish_imperial_feud_subject_@FROM days = 1825 }
		}
		religion = FROM
		NOT = { total_development = 150 }
		OR = {
			ai_attitude = { who = FROM attitude = attitude_allied }
			ai_attitude = { who = FROM attitude = attitude_friendly }
			ai_attitude = { who = FROM attitude = attitude_threatened }
			any_neighbor_country = {
				is_part_of_hre = no
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = this_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = ROOT
					}
					divide_variable = { which = this_army_size value = 2 }
					check_variable = { which = this_army_size which = their_army_size }
				}
			}
		}
		FROM = {
			NOT = {
				any_owned_province = {
					is_core = ROOT
				}
			}
			NOT = {
				any_subject_country = {
					is_subject_other_than_tributary_trigger = yes
					any_owned_province = {
						is_core = ROOT
					}
				}
			}
		}
		NOT = { has_country_flag = was_member_of_HRE_and_left }
	}
}

make_imperial_feud_subject_hre_member = {
	category = influence

	alert_index = 21
	alert_tooltip = make_imperial_feud_subject_hre_member_alert_tooltip

	require_acceptance = yes

	is_visible = {
		is_emperor = yes
		NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
		NOT = { hre_reform_passed = privilegia_de_non_appelando }
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = imperial_feud_subject
			is_part_of_hre = no
		}
	}

	is_allowed = {
		hidden_trigger = {
			is_emperor = yes
			NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
			NOT = { hre_reform_passed = privilegia_de_non_appelando }
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = imperial_feud_subject
				is_part_of_hre = no
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			OR = {
				religion = catholic
				religion = protestant
				religion = reformed
				religion = ROOT
			}
		}
		imperial_influence = 5
		FROM = {
			if = {
				limit = {
					has_dlc = "Emperor"
				}
				OR = {
					AND = {
						hre_reform_passed = emperor_reichsstabilitaet
						years_in_vassalage_under = {
							who = ROOT
							years = 5
							all_subject_country = yes
						}
					}
					years_in_vassalage_under = {
						who = ROOT
						years = 10
						all_subject_country = yes
					}
				}
			}
			else = {
				OR = {
					AND = {
						hre_reform_passed = hofgericht
						years_in_vassalage_under = {
							who = ROOT
							years = 5
							all_subject_country = yes
						}
					}
					years_in_vassalage_under = {
						who = ROOT
						years = 10
						all_subject_country = yes
					}
				}
			}
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_REJECT_TO_JOIN_THE_HRE_WITHIN_LAST_5_YEARS
				OR = {
					NOT = { has_country_flag = declined_join_hre }
					had_country_flag = { flag = declined_join_hre days = 1825 }
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				is_emperor = yes
				NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
				NOT = { hre_reform_passed = privilegia_de_non_appelando }
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = imperial_feud_subject
					is_part_of_hre = no
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					OR = {
						religion = catholic
						religion = protestant
						religion = reformed
						religion = ROOT
					}
				}
				imperial_influence = 5
				FROM = {
					if = {
						limit = {
							has_dlc = "Emperor"
						}
						OR = {
							AND = {
								hre_reform_passed = emperor_reichsstabilitaet
								years_in_vassalage_under = {
									who = ROOT
									years = 5
									all_subject_country = yes
								}
							}
							years_in_vassalage_under = {
								who = ROOT
								years = 10
								all_subject_country = yes
							}
						}
					}
					else = {
						OR = {
							AND = {
								hre_reform_passed = hofgericht
								years_in_vassalage_under = {
									who = ROOT
									years = 5
									all_subject_country = yes
								}
							}
							years_in_vassalage_under = {
								who = ROOT
								years = 10
								all_subject_country = yes
							}
						}
					}
				}
				FROM = {
					OR = {
						NOT = { has_country_flag = declined_join_hre }
						had_country_flag = { flag = declined_join_hre days = 1825 }
					}
				}
			}
			FROM = {
				grant_independence = yes
				every_owned_province = {
					limit = {
						continent = europe
					}
					set_in_empire = yes
				}
				if = {
					limit = {
						NOT = { num_of_electors = 7 }
					}
					elector = yes
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				is_emperor = yes
				NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
				NOT = { hre_reform_passed = privilegia_de_non_appelando }
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = imperial_feud_subject
					is_part_of_hre = no
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					OR = {
						religion = catholic
						religion = protestant
						religion = reformed
						religion = ROOT
					}
				}
				imperial_influence = 5
				FROM = {
					if = {
						limit = {
							has_dlc = "Emperor"
						}
						OR = {
							AND = {
								hre_reform_passed = emperor_reichsstabilitaet
								years_in_vassalage_under = {
									who = ROOT
									years = 5
									all_subject_country = yes
								}
							}
							years_in_vassalage_under = {
								who = ROOT
								years = 10
								all_subject_country = yes
							}
						}
					}
					else = {
						OR = {
							AND = {
								hre_reform_passed = hofgericht
								years_in_vassalage_under = {
									who = ROOT
									years = 5
									all_subject_country = yes
								}
							}
							years_in_vassalage_under = {
								who = ROOT
								years = 10
								all_subject_country = yes
							}
						}
					}
				}
				FROM = {
					OR = {
						NOT = { has_country_flag = declined_join_hre }
						had_country_flag = { flag = declined_join_hre days = 1825 }
					}
				}
			}
			add_imperial_influence = -5
			FROM = {
				clr_country_flag = declined_join_hre
				set_country_flag = declined_join_hre
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_DUCHY_RANK
			limit = {
				FROM = {
					NOT = { government_rank = 2 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				FROM = {
					tag = PAP
					is_papal_controller = no
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_CURIA_CONTROLLER
			limit = {
				FROM = {
					tag = PAP
					is_papal_controller = no
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				FROM = {
					historical_friend_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = AMOUNT_OF_IMPERIAL_INFLUENCE
			export_to_variable = {
				which = ai_value
				value = trigger_value:imperial_influence
			}
			#change_variable = { which = ai_value value = -1 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_OWNS_HRE_PROVINCES
			limit = {
				FROM = {
					any_owned_province = {
						is_part_of_hre = yes
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE
			limit = {
				FROM = {
					NOT = { liberty_desire = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:liberty_desire
				who = FROM
			}
			#change_variable = { which = ai_value_2 value = -1 }
			subtract_variable = { which = ai_value which = ai_value_2 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				calc_true_if = {
					amount = 8
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 8
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 8
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 7
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 7
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 7
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 6
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 6
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 6
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 5
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 5
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 4
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 4
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 4
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 3
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 3
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 3
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 2
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 2
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				OR = {
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				calc_true_if = {
					amount = 12
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 12
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 12
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 11
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 11
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 11
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 10
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 10
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 9
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 9
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 9
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 8
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 8
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 8
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 7
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 7
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 7
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 6
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 6
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 6
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 5
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 5
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 4
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 4
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 4
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 3
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 3
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 3
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 2
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 2
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				OR = {
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_LEFT_DURING_SHADOW_KINGDOM_EVENT
			limit = {
				FROM = {
					has_country_flag = was_member_of_HRE_and_left
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		OR = {
			imperial_influence = 10
			FROM = {
				ai = yes
			}
		}
	}
}

ask_for_imperial_feud_subject_hre_member = {
	category = influence

	alert_index = 21
	alert_tooltip = ask_for_imperial_feud_subject_hre_member_alert_tooltip

	require_acceptance = yes

	is_visible = {
		is_subject_of = FROM
		is_subject_of_type = imperial_feud_subject
		is_part_of_hre = no
		NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
		NOT = { hre_reform_passed = privilegia_de_non_appelando }
		FROM = {
			is_emperor = yes
		}
	}

	is_allowed = {
		hidden_trigger = {
			is_subject_of = FROM
			is_subject_of_type = imperial_feud_subject
			is_part_of_hre = no
			NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
			NOT = { hre_reform_passed = privilegia_de_non_appelando }
			FROM = {
				is_emperor = yes
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		OR = {
			religion = catholic
			religion = protestant
			religion = reformed
			religion = FROM
		}
		years_in_vassalage_under = {
			who = FROM
			years = 3
			all_subject_country = yes
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_REJECT_TO_LET_US_JOIN_THE_HRE_WITHIN_LAST_5_YEARS
				OR = {
					NOT = { has_country_flag = declined_us_join_hre }
					had_country_flag = { flag = declined_us_join_hre days = 1825 }
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				is_subject_of = FROM
				is_subject_of_type = imperial_feud_subject
				is_part_of_hre = no
				NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
				NOT = { hre_reform_passed = privilegia_de_non_appelando }
				FROM = {
					is_emperor = yes
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				OR = {
					religion = catholic
					religion = protestant
					religion = reformed
					religion = FROM
				}
				years_in_vassalage_under = {
					who = FROM
					years = 3
					all_subject_country = yes
				}
				FROM = {
					OR = {
						NOT = { has_country_flag = declined_us_join_hre }
						had_country_flag = { flag = declined_us_join_hre days = 1825 }
					}
				}
			}
			FROM = {
				ROOT = {
					grant_independence = yes
				}
			}
			every_owned_province = {
				limit = {
					continent = europe
				}
				set_in_empire = yes
			}
			if = {
				limit = {
					NOT = { num_of_electors = 7 }
				}
				elector = yes
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				is_subject_of = FROM
				is_subject_of_type = imperial_feud_subject
				is_part_of_hre = no
				NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
				NOT = { hre_reform_passed = privilegia_de_non_appelando }
				FROM = {
					is_emperor = yes
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				OR = {
					religion = catholic
					religion = protestant
					religion = reformed
					religion = FROM
				}
				years_in_vassalage_under = {
					who = FROM
					years = 3
					all_subject_country = yes
				}
				FROM = {
					OR = {
						NOT = { has_country_flag = declined_us_join_hre }
						had_country_flag = { flag = declined_us_join_hre days = 1825 }
					}
				}
			}
			add_prestige = -5
			FROM = {
				clr_country_flag = declined_us_join_hre
				set_country_flag = declined_us_join_hre
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				FROM = {
					historical_friend_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_OWNS_HRE_PROVINCES
			limit = {
				any_owned_province = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				calc_true_if = {
					amount = 8
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 8
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 8
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 7
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 7
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 7
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 6
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 6
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 6
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 5
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 5
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 4
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 4
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 4
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 3
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 3
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 3
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				calc_true_if = {
					amount = 2
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				NOT = { has_dlc = "Emperor" }
				NOT = {
					calc_true_if = {
						amount = 2
						hre_reform_passed = reichsreform
						hre_reform_passed = reichsregiment
						hre_reform_passed = hofgericht
						hre_reform_passed = gemeinerpfennig
						hre_reform_passed = landfriede
						hre_reform_passed = erbkaisertum
						hre_reform_passed = privilegia_de_non_appelando
						hre_reform_passed = renovatio
					}
				}
				OR = {
					hre_reform_passed = reichsreform
					hre_reform_passed = reichsregiment
					hre_reform_passed = hofgericht
					hre_reform_passed = gemeinerpfennig
					hre_reform_passed = landfriede
					hre_reform_passed = erbkaisertum
					hre_reform_passed = privilegia_de_non_appelando
					hre_reform_passed = renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				calc_true_if = {
					amount = 12
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 12
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 12
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 11
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 11
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 11
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 10
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 10
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 9
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 9
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 9
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 8
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 8
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 8
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 7
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 7
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 7
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 6
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 6
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 6
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 5
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 5
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 4
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 4
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 4
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 3
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 3
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 3
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				calc_true_if = {
					amount = 2
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_HRE_REFORMS
			limit = {
				has_dlc = "Emperor"
				NOT = {
					calc_true_if = {
						amount = 2
						hre_reform_passed = emperor_reichsreform
						hre_reform_passed = emperor_reichsregiment
						hre_reform_passed = emperor_reichsstabilitaet
						hre_reform_passed = emperor_gemeinerpfennig
						hre_reform_passed = emperor_perpetual_diet
						hre_reform_passed = emperor_landsknechtswesen
						hre_reform_passed = emperor_landfriede
						hre_reform_passed = emperor_reichstag_collegia
						hre_reform_passed = emperor_expand_gemeiner_pfennig
						hre_reform_passed = emperor_rechenschaft
						hre_reform_passed = emperor_geteilte_macht
						hre_reform_passed = emperor_reichskrieg
						hre_reform_passed = emperor_hofgericht
						hre_reform_passed = emperor_imperial_estates
						hre_reform_passed = emperor_erbkaisertum
						hre_reform_passed = emperor_privilegia_de_non_appelando
						hre_reform_passed = emperor_renovatio
					}
				}
				OR = {
					hre_reform_passed = emperor_reichsreform
					hre_reform_passed = emperor_reichsregiment
					hre_reform_passed = emperor_reichsstabilitaet
					hre_reform_passed = emperor_gemeinerpfennig
					hre_reform_passed = emperor_perpetual_diet
					hre_reform_passed = emperor_landsknechtswesen
					hre_reform_passed = emperor_landfriede
					hre_reform_passed = emperor_reichstag_collegia
					hre_reform_passed = emperor_expand_gemeiner_pfennig
					hre_reform_passed = emperor_rechenschaft
					hre_reform_passed = emperor_geteilte_macht
					hre_reform_passed = emperor_reichskrieg
					hre_reform_passed = emperor_hofgericht
					hre_reform_passed = emperor_imperial_estates
					hre_reform_passed = emperor_erbkaisertum
					hre_reform_passed = emperor_privilegia_de_non_appelando
					hre_reform_passed = emperor_renovatio
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = FROM_MIGHT_WANT_TO_VASSALIZE_ROOT
			limit = {
				FROM = {
					num_of_free_diplomatic_relations = 1
				}
				NOT = { liberty_desire = 50 }
				has_opinion = {
					who = FROM
					value = 150
				}
				NOT = { total_development = 150 }
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			#change_variable = { which = ai_value value = -1 }
			divide_variable = { which = ai_value value = -7 }
		}
		add_entry = {
			name = ROOT_IS_EMPIRE_RANK
			limit = {
				government_rank = 3
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_IS_KINGDOM_RANK
			limit = {
				government_rank = 2
				NOT = { government_rank = 3 }
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
		}
	}

	ai_will_do = {
		NOT = { tag = PAP }
		NOT = { liberty_desire = 50 }
		NOT = { government_rank = 2 }
		prestige = 10
		religion = FROM
		FROM = {
			NOT = {
				any_owned_province = {
					is_core = ROOT
				}
			}
			NOT = {
				any_subject_country = {
					is_subject_other_than_tributary_trigger = yes
					any_owned_province = {
						is_core = ROOT
					}
				}
			}
		}
		NOT = { has_country_flag = was_member_of_HRE_and_left }
		OR = {
			years_in_vassalage_under = {
				who = FROM
				years = 10
				all_subject_country = yes
			}
			AND = {
				has_opinion = {
					who = FROM
					value = 150
				}
				reverse_has_opinion = {
					who = FROM
					value = 150
				}
				years_in_vassalage_under = {
					who = FROM
					years = 5
					all_subject_country = yes
				}
			}
			AND = {
				has_opinion = {
					who = FROM
					value = 200
				}
				reverse_has_opinion = {
					who = FROM
					value = 200
				}
			}
		}
	}
}

change_imperial_feud_subject_to_vassal = {
	category = influence

	alert_index = 6
	alert_tooltip = change_imperial_feud_subject_to_vassal_alert_tooltip

	require_acceptance = yes

	is_visible = {
		is_emperor = yes
		NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
		NOT = { hre_reform_passed = privilegia_de_non_appelando }
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = imperial_feud_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			is_emperor = yes
			NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
			NOT = { hre_reform_passed = privilegia_de_non_appelando }
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = imperial_feud_subject
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			has_opinion = {
				who = ROOT
				value = 190
			}
		}
		FROM = {
			years_in_vassalage_under = {
				who = ROOT
				years = 10
				all_subject_country = yes
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				is_emperor = yes
				NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
				NOT = { hre_reform_passed = privilegia_de_non_appelando }
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = imperial_feud_subject
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 190
					}
				}
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 10
						all_subject_country = yes
					}
				}
			}
			vassalize = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				is_emperor = yes
				NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
				NOT = { hre_reform_passed = privilegia_de_non_appelando }
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = imperial_feud_subject
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 190
					}
				}
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 10
						all_subject_country = yes
					}
				}
			}
			FROM = {
				clr_country_flag = declined_change_imperial_feud_subject_to_vassal
				set_country_flag = declined_change_imperial_feud_subject_to_vassal
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = base_values
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_DIFF_OF_GOV_RANKS
			export_to_variable = {
				which = ai_value
				value = trigger_value:government_rank
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:government_rank
				who = FROM
			}
			subtract_variable = { which = ai_value which = ai_value_2 }
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				FROM = {
					tag = PAP
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MORE_THAN_200_TOTAL_DEVELOPMENT
			limit = {
				FROM = {
					total_development = 200
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -4 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = -89 }
					NOT = { check_variable = { which = eco_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					NOT = { check_variable = { which = eco_power value = -89 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_EMPEROR
			limit = {
				is_emperor = yes
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = ROOT_IS_NOT_EMPEROR
			limit = {
				is_emperor = no
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		num_of_free_diplomatic_relations = 1
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_change_imperial_feud_subject_to_vassal }
				had_country_flag = { flag = declined_change_imperial_feud_subject_to_vassal days = 1825 }
			}
		}
	}
}

imperial_feud_subject_become_independent = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_subject_of = FROM
		is_subject_of_type = imperial_feud_subject
	}

	is_allowed = {
		hidden_trigger = {
			is_subject_of = FROM
			is_subject_of_type = imperial_feud_subject
		}
		NOT = { truce_with = FROM }
		OR = {
			liberty_desire = 50
			NOT = {
				has_opinion = {
					who = FROM
					value = 0
				}
			}
			AND = {
				has_dlc = "Art of War"
				hre_religion_locked = yes
				NOT = { religion = FROM }
			}
			custom_trigger_tooltip = {
				tooltip = ROOT_HAS_LEFT_HRE_DURING_SHADOW_KINGDOM_EVENT
				has_country_flag = was_member_of_HRE_and_left
			}
		}
		is_at_war = no
	}

	on_accept = {
		if = {
			limit = {
				is_subject_of = FROM
				is_subject_of_type = imperial_feud_subject
				NOT = { truce_with = FROM }
				OR = {
					liberty_desire = 50
					NOT = {
						has_opinion = {
							who = FROM
							value = 0
						}
					}
				}
				is_at_war = no
			}
			FROM = {
				ROOT = { grant_independence = yes }
				country_event = { id = subjects_expanded_imperial_feud_subject_events.1 days = 1 }
			}
			add_truce_with = FROM
			FROM = {
				add_casus_belli = {
					target = ROOT
					type = cb_disloyal_imperial_feud_subject
				}
			}
		}
	}

	ai_will_do = {
		OR = {
			liberty_desire = 65
			NOT = {
				has_opinion = {
					who = FROM
					value = 0
				}
			}
			AND = {
				has_dlc = "Art of War"
				hre_religion_locked = yes
				NOT = { religion = FROM }
			}
			has_country_flag = was_member_of_HRE_and_left
		}
	}
}

bestow_impirial_grace_to_imperial_feud_subject = {
	category = emperor

	require_acceptance = no

	is_visible = {
		is_emperor = yes
		NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
		NOT = { hre_reform_passed = privilegia_de_non_appelando }
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = imperial_feud_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			is_emperor = yes
			NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
			NOT = { hre_reform_passed = privilegia_de_non_appelando }
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = imperial_feud_subject
			}
		}
		imperial_influence = 5
		FROM = {
			NOT = {
				has_opinion_modifier = {
					who = ROOT
					modifier = improved_imperial_relations
				}
			}
		}
		FROM = {
			NOT = {
				has_country_modifier = imperial_feud_subject_imperial_grace_modifier
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				is_emperor = yes
				NOT = { hre_reform_passed = emperor_privilegia_de_non_appelando }
				NOT = { hre_reform_passed = privilegia_de_non_appelando }
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = imperial_feud_subject
				}
				imperial_influence = 5
				FROM = {
					NOT = {
						has_opinion_modifier = {
							who = ROOT
							modifier = improved_imperial_relations
						}
					}
				}
				FROM = {
					NOT = {
						has_country_modifier = imperial_feud_subject_imperial_grace_modifier
					}
				}
			}
			add_imperial_influence = -5
			FROM = {
				add_opinion = {
					who = ROOT
					modifier = improved_imperial_relations
				}
				add_country_modifier = {
					name = imperial_feud_subject_imperial_grace_modifier
					duration = 7300
				}
			}
		}
	}

	ai_will_do = {
		imperial_influence = 10
		FROM = {
			OR = {
				liberty_desire = 60
				AND = {
					ai = no
					liberty_desire = 50
				}
				NOT = {
					has_opinion = {
						who = ROOT
						value = 0
					}
				}
			}
		}
	}
}

cancel_imperial_feud_subject = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_emperor = yes
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = imperial_feud_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			is_emperor = yes
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = imperial_feud_subject
			}
		}
		is_at_war = no
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				is_emperor = yes
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = imperial_feud_subject
				}
				is_at_war = no
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
			every_country = {
				limit = {
					is_part_of_hre = yes
				}
				add_opinion = {
					who = ROOT
					modifier = emperor_abandoned_imperial_feud_subject
				}
			}
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 25
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_imperial_tributary_state
establish_imperial_tributary_state = {
	category = influence

	require_acceptance = no

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = imperial_tributary_state
		}
		FROM = {
			is_subject_of = ROOT
			capital_scope = { trade_range = ROOT }
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = imperial_tributary_state
		}
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				capital_scope = { trade_range = ROOT }
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 90 } }
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = imperial_tributary_state
				}
				FROM = {
					is_subject_of = ROOT
					capital_scope = { trade_range = ROOT }
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 90 } }
			}
			create_subject = {
				subject = FROM
				subject_type = imperial_tributary_state
			}
			FROM = {
				add_liberty_desire = -25
			}
		}
	}

	ai_will_do = {
		OR = {
			AND = {
				tag = GBR
				FROM = {
					capital_scope = {
						superregion = india_superregion
					}
				}
			}
			AND = {
				tag = ROM
				FROM = {
					government = tribal
				}
			}
		}
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
		OR = {
			FROM = { liberty_desire = 60 }
			NOT = {
				calc_true_if = {
					all_subject_country = {
						is_subject_of_type = imperial_tributary_state
					}
					amount = 2
				}
			}
		}
	}
}

ask_for_imperial_tributary_state = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_for_imperial_tributary_state_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = imperial_tributary_state
			}
		}
		is_subject_of = FROM
		capital_scope = { trade_range = FROM }
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = imperial_tributary_state
			}
		}
		hidden_trigger = {
			is_subject_of = FROM
			capital_scope = { trade_range = FROM }
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		NOT = { liberty_desire = 90 }
		custom_trigger_tooltip = {
			tooltip = DID_NOT_GED_DENIED_TO_BECOME_IMPERIAL_TRIBUTARY_STATE_WITHIN_LAST_5_YEARS
			OR = {
				NOT = { has_country_flag = ask_for_imperial_tributary_state_declined }
				had_country_flag = { flag = ask_for_imperial_tributary_state_declined days = 1825 }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = imperial_tributary_state
					}
				}
				is_subject_of = FROM
				capital_scope = { trade_range = FROM }
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				NOT = { liberty_desire = 90 }
				OR = {
					NOT = { has_country_flag = ask_for_imperial_tributary_state_declined }
					had_country_flag = { flag = ask_for_imperial_tributary_state_declined days = 1825 }
				}
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = imperial_tributary_state
				}
			}
			add_liberty_desire = -25
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = imperial_tributary_state
					}
				}
				is_subject_of = FROM
				capital_scope = { trade_range = FROM }
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				NOT = { liberty_desire = 90 }
				OR = {
					NOT = { has_country_flag = ask_for_imperial_tributary_state_declined }
					had_country_flag = { flag = ask_for_imperial_tributary_state_declined days = 1825 }
				}
			}
			add_liberty_desire = 10
			clr_country_flag = ask_for_imperial_tributary_state_declined
			set_country_flag = ask_for_imperial_tributary_state_declined
		}
	}

	ai_acceptance = {
		add_entry = {
			name = STATEGIC_VALUE
			limit = {
				NOT = {
					OR = {
						AND = {
							tag = GBR
							FROM = {
								capital_scope = {
									superregion = india_superregion
								}
							}
						}
						AND = {
							tag = ROM
							FROM = {
								government = tribal
							}
						}
					}
					FROM = {
						NOT = {
							years_in_vassalage_under = {
								who = ROOT
								years = 10
								all_subject_country = yes
							}
						}
					}
					OR = {
						FROM = { liberty_desire = 60 }
						NOT = {
							calc_true_if = {
								all_subject_country = {
									is_subject_of_type = imperial_tributary_state
								}
								amount = 2
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_LIBERTY_DESIRE
			limit = {
				liberty_desire = 50
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:liberty_desire
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = ROOT_LIBERTY_DESIRE
			limit = {
				NOT = { liberty_desire = 50 }
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:liberty_desire
			}
			subtract_variable = { which = ai_value value = 101 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		liberty_desire = 60
		has_heir = yes
		has_regency = no
	}
}

cancel_imperial_tributary_state = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = imperial_tributary_state
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = imperial_tributary_state
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = imperial_tributary_state
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			has_heir = yes
			years_in_vassalage_under = {
				who = ROOT
				years = 30
				all_subject_country = yes
			}
			OR = {
				is_neighbor_of = ROOT
				any_country = {
					is_subject_of = ROOT
					NOT = { tag = FROM }
					is_neighbor_of = FROM
				}
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_integrated_personal_union
establish_integrated_personal_union = {
	category = influence

	require_acceptance = no

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = integrated_personal_union
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = integrated_personal_union
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = integrated_personal_union
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			create_subject = {
				subject = FROM
				subject_type = integrated_personal_union
			}
		}
	}

	ai_will_do = {
		FROM = {
			NOT = { has_country_flag = integrated_personal_union_was_made_to_personal_union_again }
			NOT = { liberty_desire = 40 }
			total_development = 100
			NOT = { total_development = 300 }
			years_in_vassalage_under = {
				who = ROOT
				years = 70
				all_subject_country = yes
			}
		}
	}
}

increase_chance_to_integrate_integrated_personal_union = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = integrated_personal_union
			NOT = { has_country_modifier = increase_chance_to_integrate_integrated_personal_union_modifier }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = integrated_personal_union
				NOT = { has_country_modifier = increase_chance_to_integrate_integrated_personal_union_modifier }
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			years_in_vassalage_under = {
				who = ROOT
				years = 10
				all_subject_country = yes
			}
		}
		if = {
			limit = {
				FROM = {
					total_development = 500
				}
			}
			dip_power = 200
		}
		else_if = {
			limit = {
				FROM = {
					total_development = 200
				}
			}
			dip_power = 150
		}
		else = {
			dip_power = 100
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = integrated_personal_union
					NOT = { has_country_modifier = increase_chance_to_integrate_integrated_personal_union_modifier }
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 10
						all_subject_country = yes
					}
				}
			}
			if = {
				limit = {
					FROM = {
						total_development = 500
					}
				}
				add_dip_power = -200
			}
			else_if = {
				limit = {
					FROM = {
						total_development = 200
					}
				}
				add_dip_power = -150
			}
			else = {
				add_dip_power = -100
			}
			FROM = {
				add_country_modifier = {
					name = increase_chance_to_integrate_integrated_personal_union_modifier
					duration = 9125
				}
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

return_integrated_personal_union_to_personal_union = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = integrated_personal_union
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = integrated_personal_union
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			years_in_vassalage_under = {
				who = ROOT
				years = 10
				all_subject_country = yes
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				hidden_trigger = {
					FROM = {
						is_subject_of = ROOT
						is_subject_of_type = integrated_personal_union
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 10
						all_subject_country = yes
					}
				}
			}
			FROM = {
				set_country_flag = integrated_personal_union_was_made_to_personal_union_again
				add_opinion = {
					who = ROOT
					modifier = returned_to_vassal
				}
				grant_independence = yes
			}
			create_union = FROM
			add_prestige = -10
			FROM = {
				add_liberty_desire = 25
			}
		}
	}

	ai_will_do = {
		FROM = {
			OR = {
				liberty_desire = 90
				AND = {
					liberty_desire = 60
					has_support_loyalists = yes
				}
			}
			years_in_vassalage_under = {
				who = ROOT
				years = 25
				all_subject_country = yes
			}
		}
	}
}

cancel_integrated_personal_union = {
	category = influence

	require_acceptance = no

	is_visible = {
		NOT = { has_dlc = "Rights of Man" }
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = integrated_personal_union
		}
	}

	is_allowed = {
		hidden_trigger = {
			NOT = { has_dlc = "Rights of Man" }
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = integrated_personal_union
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				NOT = { has_dlc = "Rights of Man" }
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = integrated_personal_union
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		always = no
	}
}

#subjects_expanded_diplomatic_actions_integrated_tribe_subject
establish_integrated_tribe_subject = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = integrated_tribe_subject
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = integrated_tribe_subject
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = integrated_tribe_subject
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			create_subject = {
				subject = FROM
				subject_type = integrated_tribe_subject
			}
		}
	}
	
	ai_will_do = {
		OR = {
			AND = {
				tag = GAZ
				FROM = {
					tag = AVR
				}
			}
			AND = {
				government = tribal
				capital_scope = {
					continent = north_america
				}
				FROM = {
					government = tribal
					capital_scope = {
						continent = north_america
					}
				}
			}
		}
		FROM = {
			NOT = { liberty_desire = 30 }
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
	}
}

integrated_tribe_subject_give_additional_tribute_to_overlord = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		is_subject_of_type = integrated_tribe_subject
		is_subject_of = FROM
	}
	
	is_allowed = {
		hidden_trigger = {
			is_subject_of_type = integrated_tribe_subject
			is_subject_of = FROM
		}
		manpower_percentage = 0.2
		is_at_war = no
		FROM = { is_at_war = no }
		custom_trigger_tooltip = {
			tooltip = INTEGRATED_TRIBE_SUBJECT_DID_NOT_SEND_ADDITIONAL_TRIBUTE_WITHIN_LAST_5_YEARS
			NOT = { has_country_modifier = cooldown_integrated_tribe_subject_give_additional_tribute_to_overlord }
		}
	}
	
	on_accept = {
		if = {
			limit = {
				is_subject_of_type = integrated_tribe_subject
				is_subject_of = FROM
				manpower_percentage = 0.2
				is_at_war = no
				FROM = { is_at_war = no }
				NOT = { has_country_modifier = cooldown_integrated_tribe_subject_give_additional_tribute_to_overlord }
			}
			divide_variable = { which = integrated_tribe_subject_yearly_manpower_var value = 10 }
			add_yearly_manpower = -0.1
			FROM = {
				country_event = { id = subjects_expanded_integrated_tribe_subject_events.1 }
				add_opinion = {
					who = ROOT
					modifier = integrated_tribe_subject_paid_additional_tribute
				}
			}
			add_country_modifier = {
				name = cooldown_integrated_tribe_subject_give_additional_tribute_to_overlord
				duration = 1825
				hidden = yes
			}
		}
	}
	
	ai_will_do = {
		has_scutage = yes
		NOT = { liberty_desire = 50 }
		manpower_percentage = 0.5
		FROM = {
			OR = {
				NOT = {
					has_opinion = {
						who = ROOT
						value = 25
					}
				}
				AND = {
					is_at_war = yes
					NOT = { manpower = 5 }
				}
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_iqta_vassal
establish_iqta_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = iqta_vassal
		}
		FROM = {
			is_subject_of = ROOT
		}
	}

	is_allowed = {
		hidden_trigger = {
			can_create_subject_type = {
				subject = FROM
				subject_type = iqta_vassal
			}
			FROM = {
				is_subject_of = ROOT
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			NOT = { liberty_desire = 50 }
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = iqta_vassal
				}
				FROM = {
					is_subject_of = ROOT
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
			}
			create_subject = {
				subject = FROM
				subject_type = iqta_vassal
			}
			add_truce_with = FROM
			FROM = {
				country_event = { id = subjects_expanded_iqta_vassal_events.3 }
				country_event = { id = subjects_expanded_iqta_vassal_events.3 days = 1 }
			}
		}
	}

	ai_will_do = {
		OR = {
			is_defender_of_faith = yes
			has_reform = iqta
			# Missions Expanded reforms
			has_reform = caliphate_theocracy_reform
			has_reform = ME_caliphate_reform_sunni
			has_reform = ME_caliphate_reform_sunni_andalusia
			has_reform = ME_caliphate_reform_sunni_arabian
			# Extended Timeline reforms
			has_reform = caliphate_reform #VU - ET entry used by PDX that they've not given any credit to ET for. 
		}
		FROM = {
			vassal_of = ROOT
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
				}
			}
			religion = ROOT
			OR = {
				NOT = { religious_unity = 0.75 }
				any_neighbor_country = {
					is_subject = no
					NOT = { tag = ROOT }
					NOT = { is_neighbor_of = ROOT }
					NOT = { alliance_with = ROOT }
					NOT = { religion = ROOT }
					NOT = { has_matching_religion = ROOT }
				}
			}
		}
	}
}

allow_annex_iqta_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = iqta_vassal
			NOT = { has_country_modifier = iqta_vassal_allow_annex_modifier }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = iqta_vassal
				NOT = { has_country_modifier = iqta_vassal_allow_annex_modifier }
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
			NOT = { liberty_desire = 50 }
		}
		FROM = {
			years_in_vassalage_under = {
				who = ROOT
				years = 10
				all_subject_country = yes
			}
		}
		FROM = {
			religion = ROOT
		}
		FROM = {
			religious_unity = 0.25
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = iqta_vassal
					NOT = { has_country_modifier = iqta_vassal_allow_annex_modifier }
				}
				is_at_war = no
				FROM = {
					is_at_war = no
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 10
						all_subject_country = yes
					}
				}
				FROM = {
					religion = ROOT
				}
				FROM = {
					religious_unity = 0.25
				}
			}
			FROM = {
				add_country_modifier = {
					name = iqta_vassal_allow_annex_modifier
					duration = -1
					hidden = yes
				}
			}
		}
	}

	ai_will_do = {
		FROM = {
			OR = {
				NOT = { liberty_desire = 20 }
				AND = {
					has_scutage = no
					NOT = { liberty_desire = 30 }
				}
				years_in_vassalage_under = {
					who = ROOT
					years = 25
				}
			}
		}
	}
}

cancel_allow_annex_iqta_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = iqta_vassal
			has_country_modifier = iqta_vassal_allow_annex_modifier
			NOT = { has_country_modifier = iqta_vassal_is_getting_annexed_modifier }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = iqta_vassal
				has_country_modifier = iqta_vassal_allow_annex_modifier
				NOT = { has_country_modifier = iqta_vassal_is_getting_annexed_modifier }
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = iqta_vassal
					has_country_modifier = iqta_vassal_allow_annex_modifier
					NOT = { has_country_modifier = iqta_vassal_is_getting_annexed_modifier }
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
			}
			FROM = {
				remove_country_modifier = iqta_vassal_allow_annex_modifier
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

#subjects_expanded_diplomatic_actions_mandala_trade_vassal
establish_mandala_trade_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_subject_of = FROM
		is_subject_of_type = mandala_trade_vassal
		can_create_subject_type = {
			subject = FROM
			subject_type = mandala_trade_vassal
		}
	}

	is_allowed = {
		hidden_trigger = {
			is_subject_of = FROM
			is_subject_of_type = mandala_trade_vassal
			can_create_subject_type = {
				subject = FROM
				subject_type = mandala_trade_vassal
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		liberty_desire = 75
	}

	on_accept = {
		if = {
			limit = {
				is_subject_of = FROM
				is_subject_of_type = mandala_trade_vassal
				can_create_subject_type = {
					subject = FROM
					subject_type = mandala_trade_vassal
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				liberty_desire = 75
			}
			FROM = {
				ROOT = {
					grant_independence = yes
				}
				transfer_subjects_of_type_to = { type = vassal who = ROOT }
				transfer_subjects_of_type_to = { type = client_vassal who = ROOT }
				transfer_subjects_of_type_to = { type = march who = ROOT }
				transfer_subjects_of_type_to = { type = client_march who = ROOT }
				transfer_subjects_of_type_to = { type = roman_client_kingdom who = ROOT }
				transfer_subjects_of_type_to = { type = voivodeship who = ROOT }
				transfer_subjects_of_type_to = { type = fief_subject who = ROOT }
				transfer_subjects_of_type_to = { type = crusader_state_vassal who = ROOT }
				transfer_subjects_of_type_to = { type = nahuatl_vassal who = ROOT }
				transfer_subjects_of_type_to = { type = peasant_vassal who = ROOT }
				transfer_subjects_of_type_to = { type = muslim_tributary_vassal who = ROOT }
				transfer_subjects_of_type_to = { type = integrated_tribe_subject who = ROOT }
				transfer_subjects_of_type_to = { type = naval_march who = ROOT }
				transfer_subjects_of_type_to = { type = iqta_vassal who = ROOT }
				transfer_subjects_of_type_to = { type = pagan_chiefdom who = ROOT }
				transfer_subjects_of_type_to = { type = administrative_region who = ROOT }
				transfer_subjects_of_type_to = { type = defensive_march who = ROOT }
				transfer_subjects_of_type_to = { type = agricultural_march who = ROOT }
				transfer_subjects_of_type_to = { type = religious_march who = ROOT }
				if = {
					limit = {
						has_subject_of_type = mandala_trade_vassal
					}
					every_subject_country = {
						limit = {
							is_subject_of_type = mandala_trade_vassal
						}
						add_opinion = {
							who = ROOT
							modifier = mandala_trade_vassal_forced
						}
						set_country_flag = will_get_reduced_liberty_desire
					}
					transfer_subjects_of_type_to = { type = mandala_trade_vassal who = ROOT }
				}
			}
			every_subject_country = {
				limit = {
					is_subject_of_type = mandala_trade_vassal
					has_country_flag = will_get_reduced_liberty_desire
				}
				clr_country_flag = will_get_reduced_liberty_desire
				add_liberty_desire = -50
			}
			create_subject = {
				subject = FROM
				subject_type = mandala_trade_vassal
			}
			FROM = {
				add_opinion = {
					who = ROOT
					modifier = mandala_trade_vassal_forced
				}
				add_truce_with = ROOT
				add_liberty_desire = -100
				country_event = { id = subjects_expanded_mandala_trade_vassal_events.1 }
			}
		}
	}

	ai_will_do = {
		num_of_free_diplomatic_relations = 1
		NOT = { war_exhaustion = 5 }
		OR = {
			AND = {
				num_of_merchants = 1
				NOT = { num_of_cities = 25 }
			}
			AND = {
				num_of_merchants = 2
				num_of_cities = 25
			}
		}
		OR = {
			army_size = FROM
			num_of_cities = FROM
			num_of_subjects = 2
			liberty_desire = 85
		}
	}
}

cancel_mandala_trade_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = mandala_trade_vassal
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = mandala_trade_vassal
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = mandala_trade_vassal
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 50
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_medieval_vassal
establish_medieval_vassal = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_medieval_vassal_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = medieval_vassal
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = medieval_vassal
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		is_neighbor_of = FROM
		NOT = { truce_with = FROM }
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = medieval_vassal
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				is_neighbor_of = FROM
				NOT = { truce_with = FROM }
			}
			create_subject = {
				subject = FROM
				subject_type = medieval_vassal
			}
			add_truce_with = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = medieval_vassal
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				is_neighbor_of = FROM
				NOT = { truce_with = FROM }
			}
			FROM = {
				clr_country_flag = declined_establish_medieval_vassal_@ROOT
				set_country_flag = declined_establish_medieval_vassal_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_medieval_vassal_opinion
			}
			add_casus_belli = {
				target = FROM
				type = cb_force_medieval_vassal_triggered_only
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_threatened }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
						ai_attitude = { who = ROOT attitude = attitude_rivalry }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_EMPIRE_RANK
			limit = {
				government_rank = 3
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = yes
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
				is_emperor = no
				emperor = {
					OR = {
						army_strength = { who = ROOT value = 0.8 }
						military_strength = { who = ROOT value = 1 }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
				OR = {
					is_emperor = yes
					emperor = {
						NOT = { army_strength = { who = ROOT value = 0.8 } }
						NOT = { military_strength = { who = ROOT value = 1 } }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 75
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				FROM = {
					tag = PAP
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			limit = {
				NOT = { is_neighbor_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				FROM = {
					has_reform = free_city
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_A_THEOCRACY
			limit = {
				FROM = {
					government = theocracy
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_A_REPUBLIC
			limit = {
				FROM = {
					government = republic
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_ACCEPT_VASSALIZATION_REASONS
			export_to_variable = {
				which = ai_value
				value = modifier:accept_vassalization_reasons
			}
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 15
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development value = 0.66 }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -35 }

					check_variable = { which = eco_power value = -99 }
					NOT = { check_variable = { which = eco_power value = 50 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development value = 0.66 }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -35 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 15
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development value = 0.66 }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -35 }

					NOT = { check_variable = { which = eco_power value = -99 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 15
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development value = 0.66 }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -35 }

					check_variable = { which = eco_power value = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = military_power
						value = 15
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					multiply_variable = { which = their_army_size value = 0.66 }
					divide_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power value = -35 }

					check_variable = { which = military_power value = -49 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			multiply_variable = { which = their_army_size value = 0.66 }
			divide_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value value = -35 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = military_power
						value = 15
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					multiply_variable = { which = their_army_size value = 0.66 }
					divide_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power value = -35 }

					NOT = { check_variable = { which = military_power value = -49 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = military_power
						value = 15
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					multiply_variable = { which = their_army_size value = 0.66 }
					divide_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power value = -35 }

					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
	}

	ai_will_do = {
		num_of_free_diplomatic_relations = 1
		OR = {
			current_age = age_of_discovery
			NOT = { is_year = 1450 }
		}
		NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = medieval_vassal } amount = 5 } }
		NOT = { core_claim = FROM }
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_establish_medieval_vassal_@ROOT }
				had_country_flag = { flag = declined_establish_medieval_vassal_@ROOT days = 1825 }
			}
			num_of_cities = 5
			total_development = 100
			NOT = {
				num_of_owned_provinces_with = {
					value = 3
					is_permanent_claim = ROOT
				}
			}
		}
	}
}

ask_to_become_medieval_vassal = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_to_become_medieval_vassal_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = medieval_vassal
			}
		}
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = medieval_vassal
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		is_neighbor_of = FROM
		NOT = { truce_with = FROM }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = medieval_vassal
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				is_neighbor_of = FROM
				NOT = { truce_with = FROM }
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = medieval_vassal
				}
				add_truce_with = ROOT
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = medieval_vassal
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				is_neighbor_of = FROM
				NOT = { truce_with = FROM }
			}
			clr_country_flag = declined_establish_medieval_vassal_@FROM
			set_country_flag = declined_establish_medieval_vassal_@FROM
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_medieval_vassal
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_protective }
						ai_attitude = { who = ROOT attitude = attitude_domineering }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
						ai_attitude = { who = ROOT attitude = attitude_rivalry }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 5 }
		}
				add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_KINGDOM_RANK
			limit = {
				government_rank = 2
				NOT = { government_rank = 3 }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_EMPIRE_RANK
			limit = {
				government_rank = 3
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_A_THEOCRACY
			limit = {
				government = theocracy
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_A_REPUBLIC
			limit = {
				government = republic
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			limit = {
				NOT = { is_neighbor_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = STRATEGIC_VALUE
			limit = {
				NOT = {
					AND = {
						FROM = {
							num_of_free_diplomatic_relations = 1
							OR = {
								current_age = age_of_discovery
								NOT = { is_year = 1450 }
							}
							NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = medieval_vassal } amount = 5 } }
							NOT = { core_claim = ROOT }
						}
						OR = {
							NOT = { has_country_flag = declined_establish_medieval_vassal_@FROM }
							had_country_flag = { flag = declined_establish_medieval_vassal_@FROM days = 1825 }
						}
						num_of_cities = 5
						total_development = 100
						NOT = {
							num_of_owned_provinces_with = {
								value = 3
								is_permanent_claim = FROM
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 15
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
						who = FROM
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
					}
					multiply_variable = { which = their_total_development value = 0.66 }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -35 }

					check_variable = { which = eco_power value = -99 }
					NOT = { check_variable = { which = eco_power value = 50 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
				who = FROM
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
			}
			multiply_variable = { which = their_total_development value = 0.66 }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -35 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 15
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
						who = FROM
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
					}
					multiply_variable = { which = their_total_development value = 0.66 }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -35 }

					NOT = { check_variable = { which = eco_power value = -99 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 15
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development value = 0.66 }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -35 }

					check_variable = { which = eco_power value = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = military_power
						value = 15
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					multiply_variable = { which = their_army_size value = 0.66 }
					divide_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power value = -35 }

					check_variable = { which = military_power value = -49 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
				who = FROM
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
			}
			multiply_variable = { which = their_army_size value = 0.66 }
			divide_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value value = -35 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = military_power
						value = 15
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					multiply_variable = { which = their_army_size value = 0.66 }
					divide_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power value = -35 }

					NOT = { check_variable = { which = military_power value = -49 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = military_power
						value = 15
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					multiply_variable = { which = their_army_size value = 0.66 }
					divide_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power value = -30 }

					check_variable = { which = military_power value = 35 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
	}

	ai_will_do = {
		NOT = { current_age = age_of_absolutism }
		NOT = { is_year = 1700 }
		OR = {
			NOT = { has_country_flag = declined_establish_medieval_vassal_@FROM }
			had_country_flag = { flag = declined_establish_medieval_vassal_@FROM days = 1825 }
		}
		NOT = { has_reform = free_city }
		is_emperor = no
		is_elector = no
		NOT = { num_of_subjects = 1 }
		NOT = { num_of_cities = 20 }
		NOT = { num_of_cities = FROM }
		OR = {
			is_part_of_hre = no
			FROM = { is_part_of_hre = yes }
		}
		NOT = { government_rank = 2 }
		government = monarchy
		NOT = { core_claim = FROM }
		religion = FROM
	}
}

enforce_call_to_arms_from_medieval_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = medieval_vassal
		}
		is_at_war = yes
		OR = {
			is_in_war = {
				attacker_leader = ROOT
			}
			is_in_war = {
				defender_leader = ROOT
			}
		}
		any_country = {
			OR = {
				is_in_war = {
					attacker_leader = ROOT
					defender_leader = THIS
				}
				is_in_war = {
					attacker_leader = THIS
					defender_leader = ROOT
				}
			}
			NOT = { war_with = FROM }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = medieval_vassal
			}
			is_at_war = yes
			OR = {
				is_in_war = {
					attacker_leader = ROOT
				}
				is_in_war = {
					defender_leader = ROOT
				}
			}
			any_country = {
				OR = {
					is_in_war = {
						attacker_leader = ROOT
						defender_leader = THIS
					}
					is_in_war = {
						attacker_leader = THIS
						defender_leader = ROOT
					}
				}
				NOT = { war_with = FROM }
			}
		}
		FROM = { NOT = { liberty_desire = 50 } }
		if = {
			limit = {
				is_in_war = {
					attacker_leader = ROOT
				}
			}
			dip_power = 25
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = medieval_vassal
				}
				is_at_war = yes
				OR = {
					is_in_war = {
						attacker_leader = ROOT
					}
					is_in_war = {
						defender_leader = ROOT
					}
				}
				any_country = {
					OR = {
						is_in_war = {
							attacker_leader = ROOT
							defender_leader = THIS
						}
						is_in_war = {
							attacker_leader = THIS
							defender_leader = ROOT
						}
					}
					NOT = { war_with = FROM }
				}
				FROM = { NOT = { liberty_desire = 50 } }
				if = {
					limit = {
						is_in_war = {
							attacker_leader = ROOT
						}
					}
					dip_power = 25
				}
			}
			if = {
				limit = {
					is_in_war = {
						attacker_leader = ROOT
					}
				}
				add_dip_power = -25
			}
			FROM = {
				add_liberty_desire = 25
				join_all_defensive_wars_of = ROOT
				join_all_offensive_wars_of = ROOT
				country_event = { id = subjects_expanded_medieval_vassal_events.1 }
			}
		}
	}

	ai_will_do = {
		is_at_war = yes
		OR = {
			NOT = { war_score = -20 }
			dip_power = 200
			NOT = {
				is_in_war = {
					attacker_leader = ROOT
				}
			}
		}
		FROM = {
			army_size = 10
		}
		OR = {
			FROM = {
				NOT = { liberty_desire = 30 }
			}
			AND = {
				is_in_war = {
					defender_leader = ROOT
				}
				NOT = { war_score = -30 }
				FROM = {
					NOT = { liberty_desire = 70 }
				}
			}
		}
	}
}

disallow_medieval_vassal_to_declare_war = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = medieval_vassal
			NOT = { has_country_flag = medieval_vassal_disallowed_war }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = medieval_vassal
				NOT = { has_country_flag = medieval_vassal_disallowed_war }
			}
		}
		is_at_war = no
		dip_power = 25
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = medieval_vassal
					NOT = { has_country_flag = medieval_vassal_disallowed_war }
				}
				is_at_war = no
				dip_power = 25
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			add_dip_power = -25
			FROM = {
				set_country_flag = medieval_vassal_disallowed_war
				country_event = { id = subjects_expanded_medieval_vassal_events.2 }
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

allow_medieval_vassal_to_declare_war = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = medieval_vassal
			has_country_flag = medieval_vassal_disallowed_war
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = medieval_vassal
				has_country_flag = medieval_vassal_disallowed_war
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = medieval_vassal
					has_country_flag = medieval_vassal_disallowed_war
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			FROM = {
				clr_country_flag = medieval_vassal_disallowed_war
				country_event = { id = subjects_expanded_medieval_vassal_events.3 }
			}
		}
	}

	ai_will_do = {
		always = yes
	}
}

force_medieval_vassal_to_annul_alliances = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = medieval_vassal
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = medieval_vassal
			}
			NOT = { has_country_flag = force_medieval_vassal_to_annul_alliances }
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = medieval_vassal
				}
				NOT = { has_country_flag = force_medieval_vassal_to_annul_alliances }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			set_country_flag = force_medieval_vassal_to_annul_alliances
			FROM = {
				save_event_target_as = medieval_vassal_target
			}
			country_event = { id = subjects_expanded_medieval_vassal_events.6 }
		}
	}

	ai_will_do = {
		always = no
	}
}

make_medieval_vassal_to_vassal = {
	category = influence

	alert_index = 2
	alert_tooltip = make_medieval_vassal_to_vassal_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = medieval_vassal
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = medieval_vassal
			}
		}
		has_regency = no
		dip_power = 100
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = MEDIEVAL_VASSAL_AT_LEAST_SUBJECT_FOR_25_YEARS_TT
				years_in_vassalage_under = {
					who = ROOT
					years = 25
					all_subject_country = yes
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = medieval_vassal
				}
				has_regency = no
				dip_power = 100
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 25
						all_subject_country = yes
					}
				}
			}
			add_dip_power = -100
			vassalize = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = medieval_vassal
				}
				has_regency = no
				dip_power = 100
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 25
						all_subject_country = yes
					}
				}
			}
			add_prestige = -10
			FROM = {
				clr_country_flag = make_medieval_vassal_to_vassal_@ROOT
				set_country_flag = make_medieval_vassal_to_vassal_@ROOT
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_IS_VASSAL_OF_ROOT
			limit = {
				FROM = {
					NOT = { liberty_desire = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_CURIA_CONTROLLER
			limit = {
				FROM = {
					is_papal_controller = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -4.5 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
	}

	ai_will_do = {
		prestige = 1
		FROM = {
			has_opinion = {
				who = ROOT
				value = 50
			}
		}
	}
}

cancel_medieval_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = medieval_vassal
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = medieval_vassal
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = medieval_vassal
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			OR = {
				AND = {
					liberty_desire = 70
					OR = {
						current_age = age_of_absolutism
						is_year = 1700
						years_in_vassalage_under = {
							who = ROOT
							years = 30
							all_subject_country = yes
						}
					}
				}
				num_of_owned_provinces_with = {
					value = 5
					is_permanent_claim = ROOT
				}
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_muslim_tributary_vassal
establish_muslim_tributary_vassal = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_muslim_tributary_vassal_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = muslim_tributary_vassal
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = muslim_tributary_vassal
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		NOT = { truce_with = FROM }
		FROM = {
			NOT = { num_of_cities = ROOT }
		}
		army_size = 20
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = muslim_tributary_vassal
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				NOT = { truce_with = FROM }
				FROM = {
					NOT = { num_of_cities = ROOT }
				}
				army_size = 20
			}
			create_subject = {
				subject = FROM
				subject_type = muslim_tributary_vassal
			}
			add_piety = 0.05
			FROM = {
				country_event = { id = subjects_expanded_muslim_tributary_vassal_events.1 }
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = muslim_tributary_vassal
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				NOT = { truce_with = FROM }
				FROM = {
					NOT = { num_of_cities = ROOT }
				}
				army_size = 20
			}
			FROM = {
				clr_country_flag = declined_establish_muslim_tributary_vassal_@ROOT
				set_country_flag = declined_establish_muslim_tributary_vassal_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_muslim_tributary_vassal_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_IS_VASSAL_OF_ROOT
			limit = {
				overlord_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				overlord_of = FROM
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_threatened }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
						ai_attitude = { who = ROOT attitude = atittude_rivalry }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					tag = PAP
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_ALLIED_TO_PAPAL_STATE
			limit = {
				FROM = {
					religion = catholic
					OR = {
						alliance_with = PAP
						guaranteed_by = PAP
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_DEFENDER_OF_FAITH
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					is_defender_of_faith = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_ALLIED_TO_DEFENDER_OF_FAITH
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					any_ally = {
						religion = PREV
						is_defender_of_faith = yes
						NOT = { army_size = ROOT }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_ALLIED_TO_DEFENDER_OF_FAITH
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					any_ally = {
						religion = PREV
						is_defender_of_faith = yes
						army_size = ROOT
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_A_REPUBLIC
			limit = {
				FROM = {
					government = republic
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_A_THEOCRACY
			limit = {
				FROM = {
					government = theocracy
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPEROR
			limit = {
				FROM = {
					is_emperor = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_ALLIED_TO_EMPEROR
			limit = {
				FROM = {
					OR = {
						any_ally = {
							is_emperor = yes
						}
						guaranteed_by = emperor
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_ALLIES
			limit = {
				FROM = {
					any_ally = {
						NOT = { tag = ROOT }
						army_size = 20
					}
					NOT = {
						calc_true_if = {
							all_ally = {
								NOT = { tag = ROOT }
								army_size = 20
							}
							amount = 2
						}
					}
					NOT = {
						any_ally = {
							NOT = { tag = ROOT }
							OR = {
								army_size = 100
								military_strength = { who = ROOT value = 2 }
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_ALLIES
			limit = {
				FROM = {
					calc_true_if = {
						all_ally = {
							NOT = { tag = ROOT }
							army_size = 20
						}
						amount = 2
					}
					NOT = {
						any_ally = {
							NOT = { tag = ROOT }
							OR = {
								army_size = 100
								military_strength = { who = ROOT value = 2 }
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_ALLIES
			limit = {
				FROM = {
					any_ally = {
						NOT = { tag = ROOT }
						OR = {
							army_size = 100
							military_strength = { who = ROOT value = 2 }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_GUARANTEES
			limit = {
				any_country = {
					NOT = { tag = ROOT }
					FROM = {
						guaranteed_by = PREV
					}
					army_size = 20
				}
				NOT = {
					calc_true_if = {
						all_country = {
							NOT = { tag = ROOT }
							FROM = {
								guaranteed_by = PREV
							}
							army_size = 20
						}
						amount = 2
					}
				}
				NOT = {
					any_country = {
						NOT = { tag = ROOT }
						FROM = {
							guaranteed_by = PREV
						}
						OR = {
							army_size = 100
							military_strength = { who = ROOT value = 2 }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_GUARANTEES
			limit = {
				calc_true_if = {
					all_country = {
						NOT = { tag = ROOT }
						FROM = {
							guaranteed_by = PREV
						}
						army_size = 20
					}
					amount = 2
				}
				NOT = {
					any_country = {
						NOT = { tag = ROOT }
						FROM = {
							guaranteed_by = PREV
						}
						OR = {
							army_size = 100
							military_strength = { who = ROOT value = 2 }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_GUARANTEES
			limit = {
				any_country = {
					NOT = { tag = ROOT }
					FROM = {
						guaranteed_by = PREV
					}
					OR = {
						army_size = 100
						military_strength = { who = ROOT value = 2 }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SOME_MUSLIM_PROVINCES
			limit = {
				FROM = {
					OR = {
						num_of_religion = { religion = sunni value = 0.1 }
						num_of_religion = { religion = shiite value = 0.1 }
						num_of_religion = { religion = ibadi value = 0.1 }
					}
					NOT = { dominant_religion = sunni }
					NOT = { dominant_religion = shiite }
					NOT = { dominant_religion = ibadi }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MUSLIM_DOMINANT_FAITH
			limit = {
				FROM = {
					OR = {
						dominant_religion = sunni
						dominant_religion = shiite
						dominant_religion = ibadi
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				FROM = {
					historical_friend_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_RIVALS
			limit = {
				FROM = {
					historical_rival_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALLIED_TO_ROOT_RIVALS
			limit = {
				any_country = {
					OR = {
						alliance_with = FROM
						FROM = {
							guaranteed_by = PREV
						}
					}
					OR = {
						is_enemy = ROOT
						is_rival = ROOT
					}
				}
				NOT = {
					calc_true_if = {
						all_country = {
							OR = {
								alliance_with = FROM
								FROM = {
									guaranteed_by = PREV
								}
							}
							OR = {
								is_enemy = ROOT
								is_rival = ROOT
							}
						}
						amount = 2
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = -25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALLIED_TO_ROOT_RIVALS
			limit = {
				calc_true_if = {
					all_country = {
						OR = {
							alliance_with = FROM
							FROM = {
								guaranteed_by = PREV
							}
						}
						OR = {
							is_enemy = ROOT
							is_rival = ROOT
						}
					}
					amount = 2
				}
				NOT = {
					calc_true_if = {
						all_country = {
							OR = {
								alliance_with = FROM
								FROM = {
									guaranteed_by = PREV
								}
							}
							OR = {
								is_enemy = ROOT
								is_rival = ROOT
							}
						}
						amount = 3
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = -50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALLIED_TO_ROOT_RIVALS
			limit = {
				calc_true_if = {
					all_country = {
						OR = {
							alliance_with = FROM
							FROM = {
								guaranteed_by = PREV
							}
						}
						OR = {
							is_enemy = ROOT
							is_rival = ROOT
						}
					}
					amount = 3
				}
				NOT = {
					calc_true_if = {
						all_country = {
							OR = {
								alliance_with = FROM
								FROM = {
									guaranteed_by = PREV
								}
							}
							OR = {
								is_enemy = ROOT
								is_rival = ROOT
							}
						}
						amount = 4
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = -75
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALLIED_TO_ROOT_RIVALS
			limit = {
				calc_true_if = {
					all_country = {
						OR = {
							alliance_with = FROM
							FROM = {
								guaranteed_by = PREV
							}
						}
						OR = {
							is_enemy = ROOT
							is_rival = ROOT
						}
					}
					amount = 4
				}
				NOT = {
					calc_true_if = {
						all_country = {
							OR = {
								alliance_with = FROM
								FROM = {
									guaranteed_by = PREV
								}
							}
							OR = {
								is_enemy = ROOT
								is_rival = ROOT
							}
						}
						amount = 5
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = -100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALLIED_TO_ROOT_RIVALS
			limit = {
				calc_true_if = {
					all_country = {
						OR = {
							alliance_with = FROM
							FROM = {
								guaranteed_by = PREV
							}
						}
						OR = {
							is_enemy = ROOT
							is_rival = ROOT
						}
					}
					amount = 5
				}
			}
			export_to_variable = {
				which = ai_value
				value = -1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		religion = sunni
		num_of_free_diplomatic_relations = 1
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_establish_muslim_tributary_vassal_@ROOT }
				had_country_flag = { flag = declined_establish_muslim_tributary_vassal_@ROOT days = 1825 }
			}
			NOT = { is_subject_of = ROOT }
			capital_scope = {
				continent = europe
			}
			NOT = { total_development = 150 }
			NOT = {
				num_of_owned_provinces_with = {
					value = 5
					OR = {
						is_claim = ROOT
						is_core = ROOT
					}
				}
			}
		}
	}
}

ask_for_muslim_tributary_vassal = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_muslim_tributary_vassal_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = muslim_tributary_vassal
			}
		}
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = muslim_tributary_vassal
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		NOT = { truce_with = FROM }
		NOT = { num_of_cities = FROM }
		FROM = {
			army_size = 20
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = muslim_tributary_vassal
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				NOT = { truce_with = FROM }
				NOT = { num_of_cities = FROM }
				FROM = {
					army_size = 20
				}
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = muslim_tributary_vassal
				}
				add_piety = 0.05
			}
			country_event = { id = subjects_expanded_muslim_tributary_vassal_events.1 }
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = muslim_tributary_vassal
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				NOT = { truce_with = FROM }
				NOT = { num_of_cities = FROM }
				FROM = {
					army_size = 20
				}
			}
			clr_country_flag = declined_establish_muslim_tributary_vassal_@FROM
			set_country_flag = declined_establish_muslim_tributary_vassal_@FROM
			add_opinion = {
				who = FROM
				modifier = declined_ask_for_muslim_tributary_vassal_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = ROOT_IS_VASSAL_OF_FROM
			limit = {
				is_subject_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_ATTITUDE_TOWARDS_FROM
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_threatened }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
						ai_attitude = { who = ROOT attitude = atittude_rivalry }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = ROOT_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -4 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
				who = FROM
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = STRATEGIC_VALUE
			limit = {
				NOT = {
					AND = {
						FROM = {
							religion = sunni
							num_of_free_diplomatic_relations = 1
						}
						OR = {
							NOT = { has_country_flag = declined_establish_muslim_tributary_vassal_@FROM }
							had_country_flag = { flag = declined_establish_muslim_tributary_vassal_@FROM days = 1825 }
						}
						NOT = { is_subject_of = FROM }
						capital_scope = {
							continent = europe
						}
						NOT = { total_development = 150 }
						NOT = {
							num_of_owned_provinces_with = {
								value = 5
								OR = {
									is_claim = FROM
									is_core = FROM
								}
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				FROM = {
					historical_friend_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_RIVALS
			limit = {
				FROM = {
					historical_rival_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		NOT = { tag = PAP }
		is_papal_controller = no
		government = monarchy
		is_emperor = no
		is_defender_of_faith = no
		religion_group = christian
		is_part_of_hre = no
		NOT = { num_of_cities = 10 }
		capital_scope = {
			continent = europe
		}
		NOT = { historical_rival_with = FROM }
		NOT = { alliance_with = FROM }
		OR = {
			NOT = { religion = catholic }
			NOT = { alliance_with = PAP }
		}
		OR = {
			AND = {
				NOT = { religion = catholic }
				NOT = { religion = protestant }
				NOT = { religion = reformed }
			}
			NOT = { alliance_with = emperor }
		}
		NOT = {
			calc_true_if = {
				all_ally = {
					NOT = { tag = FROM }
					army_size = 20
				}
				amount = 2
			}
		}
		NOT = {
			any_ally = {
				NOT = { tag = FROM }
				OR = {
					army_size = 100
					military_strength = { who = FROM value = 2 }
					is_defender_of_faith = yes
				}
			}
		}
		NOT = {
			calc_true_if = {
				all_country = {
					NOT = { tag = FROM }
					ROOT = {
						guaranteed_by = PREV
					}
					army_size = 20
				}
				amount = 2
			}
		}
		NOT = {
			any_country = {
				NOT = { tag = FROM }
				ROOT = {
					guaranteed_by = PREV
				}
				OR = {
					army_size = 100
					military_strength = { who = FROM value = 2 }
				}
			}
		}
		NOT = {
			calc_true_if = {
				all_country = {
					OR = {
						alliance_with = FROM
						FROM = {
							guaranteed_by = PREV
						}
					}
					OR = {
						is_enemy = ROOT
						is_rival = ROOT
					}
				}
				amount = 2
			}
		}
		OR = {
			NOT = { has_country_flag = declined_establish_muslim_tributary_vassal_@FROM }
			had_country_flag = { flag = declined_establish_muslim_tributary_vassal_@FROM days = 1825 }
		}
		NOT = { num_of_religion = { religion = sunni value = 0.1 } }
		NOT = { num_of_religion = { religion = shiite value = 0.1 } }
		NOT = { num_of_religion = { religion = ibadi value = 0.1 } }
		NOT = { dominant_religion = sunni }
		NOT = { dominant_religion = shiite }
		NOT = { dominant_religion = ibadi }
		NOT = { is_subject_of = FROM }
		NOT = { army_size = FROM }
		NOT = { core_claim = FROM }
		NOT = { num_of_subjects = 1 }
		NOT = { ai_attitude = { who = FROM attitude = attitude_hostile } }
		NOT = { ai_attitude = { who = FROM attitude = attitude_outraged } }
		NOT = { ai_attitude = { who = FROM attitude = atittude_rivalry } }
		NOT = { coalition_target = FROM }
		FROM = {
			num_of_free_diplomatic_relations = 1
			OR = {
				tag = TUR
				AND = {
					OR = {
						ai = no
						NOT = { exists = TUR }
					}
					is_defender_of_faith = yes
					government_rank = 3
				}
			}
			OR = {
				religion = sunni
				AND = {
					ai = no
					religion_group = muslim
				}
			}
			NOT = { truce_with = ROOT }
			has_casus_belli_against = ROOT
			NOT = { coalition_target = ROOT }
		}
	}
}

cancel_muslim_tributary_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = muslim_tributary_vassal
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = muslim_tributary_vassal
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = muslim_tributary_vassal
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 25
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_nahuatl_vassal
establish_nahuatl_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = nahuatl_vassal
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = nahuatl_vassal
		}
		NOT = { doom = 90 }
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = nahuatl_vassal
				}
				NOT = { doom = 90 }
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			add_doom = 10
			create_subject = {
				subject = FROM
				subject_type = nahuatl_vassal
			}
		}
	}
	
	ai_will_do = {
		NOT = { doom = 50 }
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_native_reserve
establish_native_reserve = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_native_reserve_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = native_reserve
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = native_reserve
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = native_reserve
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
			}
			create_subject = {
				subject = FROM
				subject_type = native_reserve
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = native_reserve
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
			}
			FROM = {
				clr_country_flag = declined_establish_native_reserve_@ROOT
				set_country_flag = declined_establish_native_reserve_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_native_reserve_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				NOT = { overlord_of = FROM }
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				FROM = {
					historical_friend_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_AI_PERSONALITY
			limit = {
				FROM = {
					personality = ai_militarist
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
	}

	ai_will_do = {
		OR = {
			tag = CAN
			tag = USA
			tag = FRA
			is_former_colonial_nation = yes
		}
		NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = native_reserve } amount = 5 } }
		FROM = {
			NOT = { total_development = 200 }
			capital_scope = {
				continent = north_america
			}
			OR = {
				NOT = { has_country_flag = declined_establish_native_reserve_@ROOT }
				had_country_flag = { flag = declined_establish_native_reserve_@ROOT days = 1825 }
			}
			NOT = {
				any_owned_province = {
					OR = {
						is_core = ROOT
						is_permanent_claim = ROOT
					}
				}
			}
		}
	}
}

ask_to_become_native_reserve = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_to_become_native_reserve_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = native_reserve
			}
		}
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = native_reserve
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = native_reserve
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = native_reserve
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = native_reserve
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
			}
			clr_country_flag = declined_establish_native_reserve_@FROM
			set_country_flag = declined_establish_native_reserve_@FROM
			add_opinion = {
				who = FROM
				modifier = declined_ask_for_native_reserve_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_protective }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_rivalry }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
				who = FROM
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				FROM = {
					historical_friend_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_AI_PERSONALITY
			limit = {
				FROM = {
					personality = ai_militarist
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_TOO_HIGH_DEVELOPMENT
			limit = {
				total_development = 200
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = STATEGIC_VALUE
			limit = {
				ai = yes
				FROM = { ai = yes }
				OR = {
					FROM = {
						OR = {
							AND = {
								NOT = { tag = CAN }
								NOT = { tag = USA }
								NOT = { tag = FRA }
								is_former_colonial_nation = no
							}
							calc_true_if = { all_subject_country = { is_subject_of_type = native_reserve } amount = 5 }
						}
					}
					capital_scope = {
						NOT = { continent = north_america }
					}
					any_owned_province = {
						OR = {
							is_core = FROM
							is_permanent_claim = FROM
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = STATEGIC_VALUE
			limit = {
				ai = no
				FROM = { ai = yes }
				any_owned_province = {
					OR = {
						is_core = FROM
						is_permanent_claim = FROM
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		NOT = { personality = ai_militarist }
		NOT = { government_rank = 2 }
		OR = {
			NOT = { has_country_flag = declined_establish_native_reserve_@FROM }
			had_country_flag = { flag = declined_establish_native_reserve_@FROM days = 1825 }
		}
		NOT = { total_development = 150 }
		OR = {
			ai_attitude = { who = FROM attitude = attitude_allied }
			ai_attitude = { who = FROM attitude = attitude_friendly }
			ai_attitude = { who = FROM attitude = attitude_threatened }
		}
		has_opinion = {
			who = FROM
			value = 100
		}
		FROM = {
			NOT = {
				num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
					value = 1
					is_core = ROOT
				}
			}
		}
	}
}

cancel_native_reserve = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = native_reserve
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = native_reserve
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = native_reserve
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 25
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_naval_march
establish_naval_march = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_subject = no
		can_create_subject_type = {
			subject = FROM
			subject_type = naval_march
		}
	}

	is_allowed = {
		is_subject = no
		can_create_subject_type = {
			subject = FROM
			subject_type = naval_march
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}

	on_accept = {
		if = {
			limit = {
				is_subject = no
				can_create_subject_type = {
					subject = FROM
					subject_type = naval_march
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			create_subject = {
				subject = FROM
				subject_type = naval_march
			}
		}
	}

	ai_will_do = {
		navy_size = 50
		FROM = {
			NOT = { liberty_desire = 50 }
			NOT = { is_different_march_subject = yes }
			NOT = { development_of_overlord_fraction = 0.25 }
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
			any_neighbor_country = {
				OR = {
					is_rival = ROOT
					is_enemy = ROOT
				}
			}
			NOT = {
				num_of_owned_provinces_with = {
					value = 10
					is_permanent_claim = ROOT
				}
			}
		}
	}
}

ask_to_become_naval_march = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_to_become_naval_march_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			is_subject = no
			can_create_subject_type = {
				subject = ROOT
				subject_type = naval_march
			}
		}
	}

	is_allowed = {
		FROM = {
			is_subject = no
			can_create_subject_type = {
				subject = ROOT
				subject_type = naval_march
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					can_create_subject_type = {
						subject = ROOT
						subject_type = naval_march
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = naval_march
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					can_create_subject_type = {
						subject = ROOT
						subject_type = naval_march
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			FROM = {
				clr_country_flag = declined_become_naval_march_@ROOT
				set_country_flag = declined_become_naval_march_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_naval_march
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_NAVY_SIZE_TOO_SMALL
			limit = {
				FROM = {
					NOT = { navy_size = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_VASSAL_FOR_AT_LEAST_10_YEARS
			limit = {
				years_in_vassalage_under = {
					who = FROM
					years = 10
					all_subject_country = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_NOT_A_NEIGHBOR_OF_FROMS_RIVALS
			limit = {
				NOT = {
					any_neighbor_country = {
						OR = {
							is_rival = FROM
							is_enemy = FROM
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_MORE_THAN_25_PERCENT_OF_OVERLORD_DEVELOPMENT
			limit = {
				development_of_overlord_fraction = 0.25
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		NOT = { liberty_desire = 50 }
		NOT = { is_different_march_subject = yes }
		num_of_ports = 5
		navy_size = 20
		any_neighbor_country = {
			OR = {
				is_rival = FROM
				is_enemy = FROM
			}
		}
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_become_naval_march_@ROOT }
				had_country_flag = { flag = declined_become_naval_march_@ROOT days = 1825 }
			}
		}
		NOT = {
			num_of_owned_provinces_with = {
				value = 10
				is_permanent_claim = FROM
			}
		}
	}
}

naval_march_enable_send_officers = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = naval_march
			NOT = { has_country_flag = naval_march_send_officers }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = naval_march
				NOT = { has_country_flag = naval_march_send_officers }
			}
		}
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = naval_march
					NOT = { has_country_flag = naval_march_send_officers }
				}
				FROM = { NOT = { liberty_desire = 50 } }
			}
			FROM = {
				set_country_flag = naval_march_send_officers
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

naval_march_disable_send_officers = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = naval_march
			has_country_flag = naval_march_send_officers
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = naval_march
				has_country_flag = naval_march_send_officers
			}
		}
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = naval_march
					has_country_flag = naval_march_send_officers
				}
				FROM = { NOT = { liberty_desire = 50 } }
			}
			FROM = {
				clr_country_flag = naval_march_send_officers
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

#subjects_expanded_diplomatic_actions_pagan_chiefdom
establish_pagan_chiefdom = {
	category = influence

	require_acceptance = no

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = pagan_chiefdom
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = pagan_chiefdom
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = pagan_chiefdom
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			create_subject = {
				subject = FROM
				subject_type = pagan_chiefdom
			}
		}
	}

	ai_will_do = {
		army_size = 15
		FROM = {
			NOT = { army_strength = { who = ROOT value = 0.75 } }
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
			any_neighbor_country = {
				OR = {
					is_rival = ROOT
					is_enemy = ROOT
				}
			}
		}
	}
}

ask_to_become_pagan_chiefdom = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_to_become_pagan_chiefdom_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = pagan_chiefdom
			}
		}
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = pagan_chiefdom
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		NOT = { liberty_desire = 50 }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = pagan_chiefdom
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
				NOT = { liberty_desire = 50 }
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = pagan_chiefdom
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = pagan_chiefdom
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
				NOT = { liberty_desire = 50 }
			}
			FROM = {
				clr_country_flag = declined_become_pagan_chiefdom_@ROOT
				set_country_flag = declined_become_pagan_chiefdom_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_pagan_chiefdom
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_VASSAL_FOR_AT_LEAST_10_YEARS
			limit = {
				years_in_vassalage_under = {
					who = FROM
					years = 10
					all_subject_country = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_NOT_A_NEIGHBOR_OF_FROMS_RIVALS
			limit = {
				NOT = {
					any_neighbor_country = {
						OR = {
							is_rival = FROM
							is_enemy = FROM
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_ARMY_SIZE
			limit = {
				army_strength = { who = FROM value = 0.75 }
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		religion = FROM
		any_neighbor_country = {
			OR = {
				is_rival = FROM
				is_enemy = FROM
			}
		}
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_become_pagan_chiefdom_@ROOT }
				had_country_flag = { flag = declined_become_pagan_chiefdom_@ROOT days = 1825 }
			}
		}
	}
}

increase_looting_speed_with_pagan_chiefdom = {
	category = influence

	require_acceptance = no

	is_visible = {
		has_dlc = "The Cossacks"
		is_nomad = yes
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = pagan_chiefdom
		}
	}

	is_allowed = {
		hidden_trigger = {
			has_dlc = "The Cossacks"
			is_nomad = yes
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = pagan_chiefdom
			}
		}
		horde_unity = 5
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_INCREASE_LOOTING_SPEED_WITH_THIS_PAGAN_CHIEFDOM_WITHIN_LAST_10_YEARS
				NOT = { has_country_modifier = increase_looting_speed_with_pagan_chiefdom_cooldown }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				has_dlc = "The Cossacks"
				is_nomad = yes
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = pagan_chiefdom
				}
				horde_unity = 5
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					NOT = { has_country_modifier = increase_looting_speed_with_pagan_chiefdom_cooldown }
				}
			}
			add_horde_unity = -5
			FROM = {
				add_country_modifier = {
					name = increase_looting_speed_with_pagan_chiefdom_cooldown
					duration = 3650
					hidden = yes
				}
			}
		}
	}

	ai_will_do = {
		horde_unity = 60
		is_at_war = yes
		OR = {
			NOT = {
				is_in_war = {
					attacker_leader = ROOT
				}
			}
			NOT = {
				any_country = {
					is_in_war = {
						attacker_leader = ROOT
						defenders = THIS
					}
					num_of_owned_provinces_with = {
						value = 2
						is_claim = ROOT
					}
				}
			}
		}
		NOT = {
			calc_true_if = {
				all_subject_country = {
					is_subject_of_type = pagan_chiefdom
					has_country_modifier = increase_looting_speed_with_pagan_chiefdom_cooldown
				}
				amount = 2
			}
		}
	}
}

increase_horde_unity_with_pagan_chiefdom = {
	category = influence

	require_acceptance = no

	is_visible = {
		has_dlc = "The Cossacks"
		is_nomad = yes
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = pagan_chiefdom
		}
	}

	is_allowed = {
		hidden_trigger = {
			has_dlc = "The Cossacks"
			is_nomad = yes
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = pagan_chiefdom
			}
		}
		NOT = { horde_unity = 100 }
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_INCREASE_HORDE_UNITY_WITH_THIS_PAGAN_CHIEFDOM_WITHIN_LAST_5_YEARS
				NOT = { has_country_modifier = increase_horde_unity_with_pagan_chiefdom_cooldown }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				has_dlc = "The Cossacks"
				is_nomad = yes
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = pagan_chiefdom
				}
				NOT = { horde_unity = 100 }
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					NOT = { has_country_modifier = increase_horde_unity_with_pagan_chiefdom_cooldown }
				}
			}
			FROM = {
				if = {
					limit = {
						total_development = 200
					}
					add_liberty_desire = 20
					ROOT = { add_horde_unity = 20 }
				}
				else_if = {
					limit = {
						total_development = 190
					}
					add_liberty_desire = 19
					ROOT = { add_horde_unity = 19 }
				}
				else_if = {
					limit = {
						total_development = 180
					}
					add_liberty_desire = 18
					ROOT = { add_horde_unity = 18 }
				}
				else_if = {
					limit = {
						total_development = 170
					}
					add_liberty_desire = 17
					ROOT = { add_horde_unity = 17 }
				}
				else_if = {
					limit = {
						total_development = 160
					}
					add_liberty_desire = 16
					ROOT = { add_horde_unity = 16 }
				}
				else_if = {
					limit = {
						total_development = 150
					}
					add_liberty_desire = 15
					ROOT = { add_horde_unity = 15 }
				}
				else_if = {
					limit = {
						total_development = 140
					}
					add_liberty_desire = 14
					ROOT = { add_horde_unity = 14 }
				}
				else_if = {
					limit = {
						total_development = 130
					}
					add_liberty_desire = 13
					ROOT = { add_horde_unity = 13 }
				}
				else_if = {
					limit = {
						total_development = 120
					}
					add_liberty_desire = 12
					ROOT = { add_horde_unity = 12 }
				}
				else_if = {
					limit = {
						total_development = 110
					}
					add_liberty_desire = 11
					ROOT = { add_horde_unity = 11 }
				}
				else_if = {
					limit = {
						total_development = 100
					}
					add_liberty_desire = 10
					ROOT = { add_horde_unity = 10 }
				}
				else_if = {
					limit = {
						total_development = 90
					}
					add_liberty_desire = 9
					ROOT = { add_horde_unity = 9 }
				}
				else_if = {
					limit = {
						total_development = 80
					}
					add_liberty_desire = 8
					ROOT = { add_horde_unity = 8 }
				}
				else_if = {
					limit = {
						total_development = 70
					}
					add_liberty_desire = 7
					ROOT = { add_horde_unity = 7 }
				}
				else_if = {
					limit = {
						total_development = 60
					}
					add_liberty_desire = 6
					ROOT = { add_horde_unity = 6 }
				}
				else_if = {
					limit = {
						total_development = 50
					}
					add_liberty_desire = 5
					ROOT = { add_horde_unity = 5 }
				}
				else_if = {
					limit = {
						total_development = 40
					}
					add_liberty_desire = 4
					ROOT = { add_horde_unity = 4 }
				}
				else_if = {
					limit = {
						total_development = 30
					}
					add_liberty_desire = 3
					ROOT = { add_horde_unity = 3 }
				}
				else_if = {
					limit = {
						total_development = 20
					}
					add_liberty_desire = 2
					ROOT = { add_horde_unity = 2 }
				}
				else = {
					add_liberty_desire = 1
					ROOT = { add_horde_unity = 1 }
				}
				add_country_modifier = {
					name = increase_horde_unity_with_pagan_chiefdom_cooldown
					duration = 1825
					hidden = yes
				}
			}
		}
	}

	ai_will_do = {
		NOT = { horde_unity = 50 }
		is_at_war = no
		FROM = {
			OR = {
				AND = {
					total_development = 200
					NOT = { liberty_desire = 25 }
				}
				AND = {
					total_development = 150
					NOT = { total_development = 200 }
					NOT = { liberty_desire = 30 }
				}
				AND = {
					total_development = 100
					NOT = { total_development = 150 }
					NOT = { liberty_desire = 35 }
				}
				AND = {
					total_development = 50
					NOT = { total_development = 100 }
					NOT = { liberty_desire = 40 }
				}
				AND = {
					NOT = { total_development = 50 }
					NOT = { liberty_desire = 45 }
				}
			}
		}
		NOT = {
			calc_true_if = {
				all_subject_country = {
					is_subject_of_type = pagan_chiefdom
					has_country_modifier = increase_horde_unity_with_pagan_chiefdom_cooldown
				}
				amount = 2
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_palatinate_vassal
establish_palatinate_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		overlord_of = FROM
		can_create_subject_type = {
			subject = FROM
			subject_type = palatinate_vassal
		}
	}

	is_allowed = {
		hidden_trigger = {
			overlord_of = FROM
		}
		can_create_subject_type = {
			subject = FROM
			subject_type = palatinate_vassal
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}

	on_accept = {
		if = {
			limit = {
				overlord_of = FROM
				can_create_subject_type = {
					subject = FROM
					subject_type = palatinate_vassal
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			create_subject = {
				subject = FROM
				subject_type = palatinate_vassal
			}
		}
	}

	ai_will_do = {
		always = yes
	}
}

#subjects_expanded_diplomatic_actions_papal_sanctuary_subject
establish_papal_sanctuary_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_papal_sanctuary_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = papal_sanctuary_subject
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = papal_sanctuary_subject
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			has_opinion = {
				who = ROOT
				value = 100
			}
		}
		FROM = {
			religious_unity = 0.9
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = papal_sanctuary_subject
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 100
					}
				}
				FROM = {
					religious_unity = 0.9
				}
			}
			create_subject = {
				subject = FROM
				subject_type = papal_sanctuary_subject
			}
			add_truce_with = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = papal_sanctuary_subject
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 100
					}
				}
				FROM = {
					religious_unity = 0.9
				}
			}
			FROM = {
				clr_country_flag = declined_establish_papal_sanctuary_subject_@ROOT
				set_country_flag = declined_establish_papal_sanctuary_subject_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_papal_sanctuary_subject_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_threatened }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_rivalry }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = yes
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPEROR
			limit = {
				FROM = {
					is_emperor = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_CURIA_CONTROLLER
			limit = {
				is_papal_controller = yes
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				FROM = {
					has_reform = free_city
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MONARCHY
			limit = {
				FROM = {
					government = monarchy
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_A_REPUBLIC
			limit = {
				FROM = {
					government = republic
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_A_THEOCRACY
			limit = {
				FROM = {
					government = theocracy
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_AMOUNT_OF_INVESTED_PAPAL_INFLUENCE
			limit = {
				FROM = {
					invested_papal_influence = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:invested_papal_influence
				who = FROM
			}
		}
		add_entry = {
			name = ROOT_RULER_IS_RELIGIOUS
			limit = {
				has_dlc = "Rights of Man"
				OR = {
					ruler_has_personality = zealot_personality
					ruler_has_personality = pious_personality
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = ROOT_RULER_IS_SINNER
			limit = {
				has_dlc = "Rights of Man"
				ruler_has_personality = sinner_personality
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_RULER_IS_RELIGIOUS
			limit = {
				has_dlc = "Rights of Man"
				FROM = {
					OR = {
						ruler_has_personality = zealot_personality
						ruler_has_personality = pious_personality
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_RULER_IS_SINNER
			limit = {
				has_dlc = "Rights of Man"
				FROM = {
					ruler_has_personality = sinner_personality
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_SUBJECT
			limit = {
				is_subject = yes
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_DEFENDER_OF_FAITH
			limit = {
				is_defender_of_faith = yes
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_HAS_ESTABLISHED_THE_KINGDOM_OF_GOD
			limit = {
				has_country_flag = is_kingdom_of_god_flag
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_HAS_STRONG_NEIGHBOR_WITH_DIFFERENT_RELIGION
			limit = {
				FROM = {
					any_neighbor_country = {
						NOT = { religion = PREV }
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = this_army_size
								value = trigger_value:army_size
							}
							export_to_variable = {
								which = our_army_size
								value = trigger_value:army_size
								who = ROOT
							}
							export_to_variable = {
								which = their_army_size
								value = trigger_value:army_size
								who = FROM
							}
							divide_variable = { which = this_army_size value = 2 }
							divide_variable = { which = our_army_size value = 3 }
							check_variable = { which = this_army_size which = their_army_size }
							check_variable = { which = our_army_size which = this_army_size }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_HAS_STRONG_NEIGHBOR_WITH_DIFFERENT_RELIGION
			limit = {
				FROM = {
					any_neighbor_country = {
						NOT = { religion = PREV }
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = this_army_size
								value = trigger_value:army_size
							}
							export_to_variable = {
								which = our_army_size
								value = trigger_value:army_size
								who = ROOT
							}
							export_to_variable = {
								which = their_army_size
								value = trigger_value:army_size
								who = FROM
							}
							divide_variable = { which = this_army_size value = 2 }
							divide_variable = { which = our_army_size value = 3 }
							check_variable = { which = this_army_size which = their_army_size }
							NOT = { check_variable = { which = our_army_size which = this_army_size } }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
		}
	}

	ai_will_do = {
		OR = {
			is_defender_of_faith = yes
			is_papal_controller = yes
			personality = ai_diplomat
			has_country_flag = is_kingdom_of_god_flag
			AND = {
				has_dlc = "Rights of Man"
				OR = {
					ruler_has_personality = zealot_personality
					ruler_has_personality = pious_personality
				}
			}
		}
		OR = {
			num_of_free_diplomatic_relations = 1
			FROM = {
				religion = ROOT
				OR = {
					government = theocracy
					is_papal_controller = yes
					is_defender_of_faith = yes
					crusade_target = {
						is_neighbor_of = PREV
					}
				}
			}
		}
		FROM = {
			is_emperor = no
			NOT = { total_development = 125 }
			OR = {
				NOT = { has_country_flag = declined_establish_papal_sanctuary_subject_@ROOT }
				had_country_flag = { flag = declined_establish_papal_sanctuary_subject_@ROOT days = 1825 }
			}
		}
	}
}

ask_for_papal_sanctuary_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_for_papal_sanctuary_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = papal_sanctuary_subject
			}
		}
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = papal_sanctuary_subject
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			has_opinion = {
				who = ROOT
				value = 100
			}
		}
		religious_unity = 0.9
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = papal_sanctuary_subject
					}
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 100
					}
				}
				religious_unity = 0.9
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = papal_sanctuary_subject
				}
			}
			add_truce_with = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = papal_sanctuary_subject
					}
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 100
					}
				}
				religious_unity = 0.9
			}
			clr_country_flag = declined_establish_papal_sanctuary_subject_@FROM
			set_country_flag = declined_establish_papal_sanctuary_subject_@FROM
			add_opinion = {
				who = FROM
				modifier = declined_ask_for_papal_sanctuary_subject_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_threatened }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_rivalry }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_IS_EMPIRE_RANK
			limit = {
				government_rank = 3
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_IS_KINGDOM_RANK
			limit = {
				government_rank = 2
				NOT = { government_rank = 3 }
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
				who = FROM
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = yes
				FROM = {
					is_part_of_hre = no
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = yes
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_CURIA_CONTROLLER
			limit = {
				is_papal_controller = yes
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
		add_entry = {
			name = ROOT_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MONARCHY
			limit = {
				government = monarchy
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_A_REPUBLIC
			limit = {
				government = republic
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_A_THEOCRACY
			limit = {
				government = theocracy
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_AMOUNT_OF_INVESTED_PAPAL_INFLUENCE
			limit = {
				FROM = {
					invested_papal_influence = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:invested_papal_influence
				who = FROM
			}
			divide_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = ROOT_RULER_IS_RELIGIOUS
			limit = {
				has_dlc = "Rights of Man"
				OR = {
					ruler_has_personality = zealot_personality
					ruler_has_personality = pious_personality
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = ROOT_RULER_IS_SINNER
			limit = {
				has_dlc = "Rights of Man"
				ruler_has_personality = sinner_personality
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_RULER_IS_RELIGIOUS
			limit = {
				has_dlc = "Rights of Man"
				FROM = {
					OR = {
						ruler_has_personality = zealot_personality
						ruler_has_personality = pious_personality
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_RULER_IS_SINNER
			limit = {
				has_dlc = "Rights of Man"
				FROM = {
					ruler_has_personality = sinner_personality
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_DEFENDER_OF_FAITH
			limit = {
				is_defender_of_faith = yes
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = STATEGIC_VALUE
			limit = {
				NOT = {
					FROM = {
						OR = {
							is_defender_of_faith = yes
							is_papal_controller = yes
							personality = ai_diplomat
							has_country_flag = is_kingdom_of_god_flag
							AND = {
								has_dlc = "Rights of Man"
								OR = {
									ruler_has_personality = zealot_personality
									ruler_has_personality = pious_personality
								}
							}
						}
					}
					OR = {
						FROM = {
							num_of_free_diplomatic_relations = 1
						}
						AND = {
							religion = FROM
							OR = {
								government = theocracy
								is_papal_controller = yes
								is_defender_of_faith = yes
								crusade_target = {
									is_neighbor_of = ROOT
								}
							}
						}
					}
					is_emperor = no
					NOT = { total_development = 125 }
					OR = {
						NOT = { has_country_flag = declined_establish_papal_sanctuary_subject_@FROM }
						had_country_flag = { flag = declined_establish_papal_sanctuary_subject_@FROM days = 1825 }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		NOT = { total_development = 125 }
		NOT = { government_rank = 3 }
		is_emperor = no
		is_elector = no
		NOT = { has_reform = free_city }
		invested_papal_influence = 5
		OR = {
			government = theocracy
			alliance_with = FROM
		}
		OR = {
			ai_attitude = { who = FROM attitude = attitude_threatened }
			ai_attitude = { who = FROM attitude = attitude_allied }
			ai_attitude = { who = FROM attitude = attitude_friendly }
		}
		NOT = { is_rival = FROM }
		NOT = { is_enemy = FROM }
		NOT = { army_size = FROM }
		FROM = {
			is_subject = no
			OR = {
				is_papal_controller = yes
				is_defender_of_faith = yes
				has_country_flag = is_kingdom_of_god_flag
				alliance_with = ROOT
			}
		}
		OR = {
			NOT = { has_country_flag = declined_establish_papal_sanctuary_subject_@FROM }
			had_country_flag = { flag = declined_establish_papal_sanctuary_subject_@FROM days = 1825 }
		}
	}
}

request_curia_money_from_papal_sanctuary_subject = {
	category = papacy

	alert_index = 6
	alert_tooltip = request_curia_money_from_papal_sanctuary_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		has_dlc = "Emperor"
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = papal_sanctuary_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			has_dlc = "Emperor"
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = papal_sanctuary_subject
			}
		}
		is_papal_controller = yes
		FROM = {
			has_regency = no
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_REQUEST_CURIA_MONEY_FROM_THIS_RULER
				NOT = { has_ruler_flag = requested_curia_money_from_papal_sanctuary_subject }
			}
		}
		FROM = {
			if = {
				limit = {
					total_development = 300
				}
				treasury = 250
			}
			else_if = {
				limit = {
					total_development = 250
				}
				treasury = 200
			}
			else_if = {
				limit = {
					total_development = 200
				}
				treasury = 150
			}
			else_if = {
				limit = {
					total_development = 100
				}
				treasury = 100
			}
			else = {
				treasury = 50
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				has_dlc = "Emperor"
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = papal_sanctuary_subject
				}
				is_papal_controller = yes
				FROM = {
					has_regency = no
				}
				FROM = {
					NOT = { has_ruler_flag = requested_curia_money_from_papal_sanctuary_subject }
				}
				FROM = {
					if = {
						limit = {
							total_development = 300
						}
						treasury = 250
					}
					else_if = {
						limit = {
							total_development = 250
						}
						treasury = 200
					}
					else_if = {
						limit = {
							total_development = 200
						}
						treasury = 150
					}
					else_if = {
						limit = {
							total_development = 100
						}
						treasury = 100
					}
					else = {
						treasury = 50
					}
				}
			}
			FROM = {
				add_papal_influence = 5
				set_ruler_flag = requested_curia_money_from_papal_sanctuary_subject
				if = {
					limit = {
						total_development = 300
					}
					add_treasury = -250
					add_curia_treasury = 250
				}
				else_if = {
					limit = {
						total_development = 250
					}
					add_treasury = -200
					add_curia_treasury = 200
				}
				else_if = {
					limit = {
						total_development = 200
					}
					add_treasury = -150
					add_curia_treasury = 150
				}
				else_if = {
					limit = {
						total_development = 100
					}
					add_treasury = -100
					add_curia_treasury = 100
				}
				else = {
					add_treasury = -50
					add_curia_treasury = 50
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				has_dlc = "Emperor"
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = papal_sanctuary_subject
				}
				is_papal_controller = yes
				FROM = {
					has_regency = no
				}
				FROM = {
					NOT = { has_ruler_flag = requested_curia_money_from_papal_sanctuary_subject }
				}
				FROM = {
					if = {
						limit = {
							total_development = 300
						}
						treasury = 250
					}
					else_if = {
						limit = {
							total_development = 250
						}
						treasury = 200
					}
					else_if = {
						limit = {
							total_development = 200
						}
						treasury = 150
					}
					else_if = {
						limit = {
							total_development = 100
						}
						treasury = 100
					}
					else = {
						treasury = 50
					}
				}
			}
			FROM = {
				set_ruler_flag = requested_curia_money_from_papal_sanctuary_subject
			}
			add_opinion = {
				who = ROOT
				modifier = declined_request_curia_money_from_papal_sanctuary_subject_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPEROR
			limit = {
				FROM = {
					is_emperor = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -5 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = FROM_RULER_IS_RELIGIOUS
			limit = {
				has_dlc = "Rights of Man"
				FROM = {
					OR = {
						ruler_has_personality = zealot_personality
						ruler_has_personality = pious_personality
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_RULER_IS_SINNER
			limit = {
				has_dlc = "Rights of Man"
				FROM = {
					ruler_has_personality = sinner_personality
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_DEFENDER_OF_FAITH
			limit = {
				is_defender_of_faith = yes
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_HAS_ESTABLISHED_THE_KINGDOM_OF_GOD
			limit = {
				has_country_flag = is_kingdom_of_god_flag
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_HAS_NOT_MUCH_MONEY
			limit = {
				FROM = {
					OR = {
						AND = {
							total_development = 300
							NOT = { treasury = 1000 }
						}
						AND = {
							NOT = { total_development = 300 }
							total_development = 250
							NOT = { treasury = 800 }
						}
						AND = {
							NOT = { total_development = 250 }
							total_development = 200
							NOT = { treasury = 600 }
						}
						AND = {
							NOT = { total_development = 200 }
							total_development = 150
							NOT = { treasury = 500 }
						}
						AND = {
							NOT = { total_development = 150 }
							total_development = 100
							NOT = { treasury = 400 }
						}
						AND = {
							NOT = { total_development = 100 }
							NOT = { treasury = 300 }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_HAS_ALREAD_CONTRIBUTED_MUCH_TO_CURIA_TREASURY
			limit = {
				FROM = {
					curia_treasury_contribution = 0.5
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		OR = {
			personality = ai_capitalist
			AND = {
				ruler_has_personality = pious_personality
				FROM = {
					ruler_has_personality = pious_personality
				}
			}
			FROM = {
				is_defender_of_faith = yes
			}
		}
	}
}

make_papal_sanctuary_subject_to_theocracy = {
	category = influence

	alert_index = 6
	alert_tooltip = make_papal_sanctuary_subject_to_theocracy_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_be_overlord = papal_sanctuary_subject
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = papal_sanctuary_subject
			NOT = { government = theocracy }
		}
	}

	is_allowed = {
		hidden_trigger = {
			can_be_overlord = papal_sanctuary_subject
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = papal_sanctuary_subject
				NOT = { government = theocracy }
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		religion = catholic
		FROM = {
			religion = catholic
		}
		FROM = {
			papal_influence = 10
		}
		FROM = {
			has_regency = no
		}
	}

	on_accept = {
		if = {
			limit = {
				hidden_trigger = {
					can_be_overlord = papal_sanctuary_subject
					FROM = {
						is_subject_of = ROOT
						is_subject_of_type = papal_sanctuary_subject
						NOT = { government = theocracy }
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				religion = catholic
				FROM = {
					religion = catholic
				}
				FROM = {
					papal_influence = 10
				}
				FROM = {
					has_regency = no
				}
			}
			FROM = {
				change_government = theocracy
				add_government_reform = leading_clergy_reform
				add_country_modifier = {
					name = papal_sanctuary_subject_converted_to_theocracy_modifier
					duration = 1825
				}
				add_papal_influence = -10
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				hidden_trigger = {
					can_be_overlord = papal_sanctuary_subject
					FROM = {
						is_subject_of = ROOT
						is_subject_of_type = papal_sanctuary_subject
						NOT = { government = theocracy }
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				religion = catholic
				FROM = {
					religion = catholic
				}
				FROM = {
					papal_influence = 10
				}
				FROM = {
					has_regency = no
				}
			}
			add_prestige = -10
			FROM = {
				add_country_modifier = {
					name = cooldown_papal_sanctuary_subject_converted_to_theocracy_modifier
					duration = 1825
					hidden = yes
				}
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE
			limit = {
				FROM = {
					NOT = { liberty_desire = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:liberty_desire
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPEROR
			limit = {
				FROM = {
					is_emperor = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_CURIA_CONTROLLER
			limit = {
				is_papal_controller = yes
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				has_reform = free_city
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MONARCHY
			limit = {
				FROM = {
					government = monarchy
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_A_REPUBLIC
			limit = {
				FROM = {
					government = republic
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_AMOUNT_OF_INVESTED_PAPAL_INFLUENCE
			limit = {
				FROM = {
					invested_papal_influence = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:invested_papal_influence
				who = FROM
			}
		}
		add_entry = {
			name = ROOT_RULER_IS_RELIGIOUS
			limit = {
				has_dlc = "Rights of Man"
				OR = {
					ruler_has_personality = zealot_personality
					ruler_has_personality = pious_personality
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = ROOT_RULER_IS_SINNER
			limit = {
				has_dlc = "Rights of Man"
				ruler_has_personality = sinner_personality
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_RULER_IS_RELIGIOUS
			limit = {
				has_dlc = "Rights of Man"
				FROM = {
					OR = {
						ruler_has_personality = zealot_personality
						ruler_has_personality = pious_personality
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = FROM_RULER_IS_SINNER
			limit = {
				has_dlc = "Rights of Man"
				FROM = {
					ruler_has_personality = sinner_personality
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_SUBJECT
			limit = {
				is_subject = yes
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_DEFENDER_OF_FAITH
			limit = {
				is_defender_of_faith = yes
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_HAS_ESTABLISHED_THE_KINGDOM_OF_GOD
			limit = {
				has_country_flag = is_kingdom_of_god_flag
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_HAS_A_HEIR
			limit = {
				FROM = {
					government = monarchy
					has_heir = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_NO_HEIR
			limit = {
				FROM = {
					government = monarchy
					has_heir = no
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = FROM_WAS_RECENTLY_ASKED_TO_BECOME_THEOCRACY
			limit = {
				FROM = {
					OR = {
						has_country_modifier = papal_sanctuary_subject_converted_to_theocracy_modifier
						has_country_modifier = cooldown_papal_sanctuary_subject_converted_to_theocracy_modifier
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		OR = {
			is_defender_of_faith = yes
			is_papal_controller = yes
			has_country_flag = is_kingdom_of_god_flag
		}
		FROM = {
			NOT = { liberty_desire = 25 }
			NOT = { has_country_modifier = papal_sanctuary_subject_converted_to_theocracy_modifier }
			NOT = { has_country_modifier = cooldown_papal_sanctuary_subject_converted_to_theocracy_modifier }
		}
	}
}

make_papal_sanctuary_subject_to_vassal = {
	category = influence

	alert_index = 6
	alert_tooltip = make_papal_sanctuary_subject_to_vassal_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_be_overlord = papal_sanctuary_subject
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = papal_sanctuary_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			can_be_overlord = papal_sanctuary_subject
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = papal_sanctuary_subject
			}
		}
		is_at_war = no
		religion = catholic
		FROM = {
			religion = catholic
		}
		FROM = {
			is_at_war = no
		}
		FROM = {
			papal_influence = 10
		}
		FROM = {
			years_in_vassalage_under = {
				who = ROOT
				years = 5
				all_subject_country = yes
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				hidden_trigger = {
					can_be_overlord = papal_sanctuary_subject
					FROM = {
						is_subject_of = ROOT
						is_subject_of_type = papal_sanctuary_subject
					}
				}
				is_at_war = no
				religion = catholic
				FROM = {
					religion = catholic
				}
				FROM = {
					is_at_war = no
				}
				FROM = {
					papal_influence = 10
				}
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 5
						all_subject_country = yes
					}
				}
			}
			FROM = {
				grant_independence = yes
				add_papal_influence = -10
			}
			vassalize = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				hidden_trigger = {
					can_be_overlord = papal_sanctuary_subject
					FROM = {
						is_subject_of = ROOT
						is_subject_of_type = papal_sanctuary_subject
					}
				}
				is_at_war = no
				religion = catholic
				FROM = {
					religion = catholic
				}
				FROM = {
					is_at_war = no
				}
				FROM = {
					papal_influence = 10
				}
				FROM = {
					years_in_vassalage_under = {
						who = ROOT
						years = 5
						all_subject_country = yes
					}
				}
			}
			add_prestige = -10
			FROM = {
				clr_country_flag = decline_make_papal_sanctuary_subject_to_vassal_@ROOT
				set_country_flag = decline_make_papal_sanctuary_subject_to_vassal_@ROOT
			}
			add_casus_belli = {
				target = FROM
				type = cb_vassalize_papal_sanctuary_subject
				months = 12
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_LIBERTY_DESIRE
			limit = {
				FROM = {
					NOT = { liberty_desire = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:liberty_desire
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }

					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPEROR
			limit = {
				FROM = {
					is_emperor = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_CURIA_CONTROLLER
			limit = {
				is_papal_controller = yes
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				has_reform = free_city
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MONARCHY
			limit = {
				FROM = {
					government = monarchy
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_A_REPUBLIC
			limit = {
				FROM = {
					government = republic
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_AMOUNT_OF_INVESTED_PAPAL_INFLUENCE
			limit = {
				FROM = {
					invested_papal_influence = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:invested_papal_influence
				who = FROM
			}
		}
		add_entry = {
			name = ROOT_RULER_IS_RELIGIOUS
			limit = {
				has_dlc = "Rights of Man"
				OR = {
					ruler_has_personality = zealot_personality
					ruler_has_personality = pious_personality
				}
			}
			export_to_variable = {
				which = ai_value
				value = 5
			}
		}
		add_entry = {
			name = ROOT_RULER_IS_SINNER
			limit = {
				has_dlc = "Rights of Man"
				ruler_has_personality = sinner_personality
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_RULER_IS_RELIGIOUS
			limit = {
				has_dlc = "Rights of Man"
				FROM = {
					OR = {
						ruler_has_personality = zealot_personality
						ruler_has_personality = pious_personality
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = FROM_RULER_IS_SINNER
			limit = {
				has_dlc = "Rights of Man"
				FROM = {
					ruler_has_personality = sinner_personality
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_SUBJECT
			limit = {
				is_subject = yes
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_DEFENDER_OF_FAITH
			limit = {
				is_defender_of_faith = yes
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_HAS_ESTABLISHED_THE_KINGDOM_OF_GOD
			limit = {
				has_country_flag = is_kingdom_of_god_flag
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_WAS_RECENTLY_ASKED_TO_BECOME_A_VASSAL
			limit = {
				FROM = {
					has_country_flag = decline_make_papal_sanctuary_subject_to_vassal_@ROOT
					NOT = { had_country_flag = { flag = decline_make_papal_sanctuary_subject_to_vassal_@ROOT days = 1825 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_WAS_RECENTLY_ASKED_TO_BECOME_THEOCRACY
			limit = {
				FROM = {
					OR = {
						has_country_modifier = papal_sanctuary_subject_converted_to_theocracy_modifier
						has_country_modifier = cooldown_papal_sanctuary_subject_converted_to_theocracy_modifier
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		OR = {
			is_papal_controller = yes
			has_country_flag = is_kingdom_of_god_flag
		}
		OR = {
			num_of_free_diplomatic_relations = 1
			FROM = {
				OR = {
					NOT = { religion = ROOT }
					NOT = {
						government = theocracy
						is_papal_controller = yes
						is_defender_of_faith = yes
						crusade_target = {
							is_neighbor_of = PREV
						}
					}
				}
			}
		}
		is_neighbor_of = FROM
		FROM = {
			NOT = { total_development = 100 }
			OR = {
				NOT = { has_country_flag = decline_make_papal_sanctuary_subject_to_vassal_@ROOT }
				had_country_flag = { flag = decline_make_papal_sanctuary_subject_to_vassal_@ROOT days = 1825 }
			}
		}
	}
}

papal_sanctuary_subject_become_independent = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_subject_of = FROM
		is_subject_of_type = papal_sanctuary_subject
	}

	is_allowed = {
		hidden_trigger = {
			is_subject_of = FROM
			is_subject_of_type = papal_sanctuary_subject
		}
		OR = {
			NOT = { government = theocracy }
			NOT = { religion = FROM }
			FROM = {
				NOT = { can_be_overlord = papal_sanctuary_subject }
			}
		}
		NOT = { truce_with = FROM }
		OR = {
			is_excommunicated = yes
			NOT = { religion = FROM }
			FROM = {
				is_excommunicated = yes
			}
			AND = {
				liberty_desire = 50
				has_country_modifier = the_statue_in_restraint_of_appeals
			}
			liberty_desire = 65
			FROM = {
				NOT = { can_be_overlord = papal_sanctuary_subject }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				is_subject_of = FROM
				is_subject_of_type = papal_sanctuary_subject
				OR = {
					NOT = { government = theocracy }
					NOT = { religion = FROM }
					FROM = {
						NOT = { can_be_overlord = papal_sanctuary_subject }
					}
				}
				NOT = { truce_with = FROM }
				OR = {
					is_excommunicated = yes
					NOT = { religion = FROM }
					FROM = {
						is_excommunicated = yes
					}
					AND = {
						liberty_desire = 50
						has_country_modifier = the_statue_in_restraint_of_appeals
					}
					liberty_desire = 65
					FROM = {
						NOT = { can_be_overlord = papal_sanctuary_subject }
					}
				}
			}
			FROM = {
				ROOT = { grant_independence = yes }
				country_event = { id = subjects_expanded_papal_sanctuary_subject_events.1 }
				add_casus_belli = {
					target = ROOT
					type = cb_insult
					months = 72
				}
			}
			add_truce_with = FROM
			if = {
				limit = {
					is_excommunicated = no
				}
				excommunicate = ROOT
			}
		}
	}

	ai_will_do = {
		OR = {
			NOT = { has_dlc = "Rights of Man" }
			AND = {
				NOT = { ruler_has_personality = zealot_personality }
				NOT = { ruler_has_personality = pious_personality }
			}
		}
		OR = {
			is_excommunicated = yes
			NOT = { religion = FROM }
			FROM = {
				is_excommunicated = yes
			}
			AND = {
				liberty_desire = 55
				has_country_modifier = the_statue_in_restraint_of_appeals
			}
			liberty_desire = 75
			FROM = {
				NOT = { can_be_overlord = papal_sanctuary_subject }
			}
		}
	}
}

cancel_papal_sanctuary_subject = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = papal_sanctuary_subject
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = papal_sanctuary_subject
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = papal_sanctuary_subject
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 25
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_peasant_vassal
establish_peasant_vassal = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_peasant_vassal_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = peasant_vassal
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = peasant_vassal
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			has_opinion = {
				who = ROOT
				value = 165
			}
		}
		alliance_with = FROM
		FROM = {
			NOT = { total_development = 100 }
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = peasant_vassal
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 165
					}
				}
				alliance_with = FROM
				FROM = {
					NOT = { total_development = 100 }
				}
			}
			create_subject = {
				subject = FROM
				subject_type = peasant_vassal
			}
			FROM = {
				country_event = { id = subjects_expanded_peasant_vassal_events.1 }
				country_event = { id = subjects_expanded_peasant_vassal_events.1 days = 1 }
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = peasant_vassal
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 165
					}
				}
				alliance_with = FROM
				FROM = {
					NOT = { total_development = 100 }
				}
			}
			FROM = {
				clr_country_flag = declined_establish_peasant_vassal_@ROOT
				set_country_flag = declined_establish_peasant_vassal_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_peasant_vassal_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_DIFF_OF_GOV_RANKS
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:government_rank
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:government_rank
				who = FROM
			}
			subtract_variable = { 
				which = ai_value 
				which = ai_value_2 
			}
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 75
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = yes
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				FROM = {
					tag = PAP
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MORE_THAN_100_TOTAL_DEVELOPMENT
			limit = {
				FROM = {
					total_development = 100
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = -89 }
					NOT = { check_variable = { which = eco_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					NOT = { check_variable = { which = eco_power value = -89 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_PEASANTS_REPUBLIC
			limit = {
				FROM = {
					has_reform = peasants_republic
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_NOT_PEASANTS_REPUBLIC
			limit = {
				FROM = {
					NOT = { has_reform = peasants_republic }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				FROM = {
					has_reform = free_city
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		num_of_free_diplomatic_relations = 1
		has_global_modifier_value = {
			which = global_tax_income
			value = 2
		}
		monthly_income = 5
		NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = peasant_vassal } amount = 5 } }
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_establish_peasant_vassal_@ROOT }
				had_country_flag = { flag = declined_establish_peasant_vassal_@ROOT days = 1825 }
			}
		}
	}
}

cancel_peasant_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = peasant_vassal
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = peasant_vassal
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = peasant_vassal
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 75
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_persian_satrapy
establish_persian_satrapy = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = persian_satrapy
		}
		FROM = {
			is_subject_of = ROOT
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = persian_satrapy
		}
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		if = {
			limit = {
				tag = TIM
				has_ruler_modifier = shahrukhs_empire
			}
			NOT = { has_ruler_modifier = shahrukhs_empire }
		}
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = persian_satrapy
				}
				FROM = {
					is_subject_of = ROOT
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
				if = {
					limit = {
						tag = TIM
						has_ruler_modifier = shahrukhs_empire
					}
					NOT = { has_ruler_modifier = shahrukhs_empire }
				}
			}
			create_subject = {
				subject = FROM
				subject_type = persian_satrapy
			}
			FROM = {
				country_event = { id = subjects_expanded_persian_satrapy_events.1 }
				country_event = { id = subjects_expanded_persian_satrapy_events.1 days = 1 }
			}
		}
	}
	
	ai_will_do = {
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
			capital_scope = {
				region_for_scope_province = {
					is_capital_of = ROOT
				}
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_pirate_vassal
establish_pirate_brotherhood_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = pirate_brotherhood_vassal
		}
		FROM = {
			is_subject_of = ROOT
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = pirate_brotherhood_vassal
		}
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
			}
		}
		FROM = {
			capital_scope = { trade_range = ROOT }
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = pirate_brotherhood_vassal
				}
				FROM = {
					is_subject_of = ROOT
				}
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			create_subject = {
				subject = FROM
				subject_type = pirate_brotherhood_vassal
			}
		}
	}
	
	ai_will_do = {
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
	}
}

cancel_pirate_brotherhood_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = pirate_brotherhood_vassal
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = pirate_brotherhood_vassal
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = pirate_brotherhood_vassal
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			FROM = {
				grant_independence = yes
				create_alliance = ROOT
			}
		}
	}
	
	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 25
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_protectorate
establish_protectorate = {
	category = influence

	alert_index = 4
	alert_tooltip = establish_protectorate_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = protectorate
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = protectorate
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = {
			capital_scope = { trade_range = ROOT }
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = protectorate
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
			}
			create_subject = {
				subject = FROM
				subject_type = protectorate
			}
			if = {
				limit = {
					any_country = {
						is_subject_of = FROM
						is_colonial_nation = no
					}
				}
				every_country = {
					limit = {
						is_subject_of = FROM
						is_colonial_nation = no
					}
					FROM = {
						PREV = { grant_independence = yes }
					}
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = protectorate
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
			}
			FROM = {
				clr_country_flag = declined_establish_protectorate_@ROOT
				set_country_flag = declined_establish_protectorate_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_protectorate_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					NOT = { has_opinion = { who = ROOT value = 0 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					NOT = { has_opinion = { who = ROOT value = 100 } }
					has_opinion = { who = ROOT value = 0 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
			export_to_variable = {
				variable_name = ai_value_2
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value_2 value = 4 }
			change_variable = { which = ai_value which = ai_value_2 }
		}
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					has_opinion = { who = ROOT value = 100 }
				}
			}
			export_to_variable = {
				variable_name = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 8 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 1 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 2 } }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 2 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 3 } }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 3 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 4 } }
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 4 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 5 } }
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 5 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 6 } }
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 6 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 7 } }
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 7 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 8 } }
			}
			export_to_variable = {
				which = ai_value
				value = 70
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 8 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 9 } }
			}
			export_to_variable = {
				which = ai_value
				value = 80
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 9 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 10 } }
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 10 }
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_TOTAL_DEVELOPMENT_OVER_200
			limit = {
				FROM = { total_development = 200 }
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				any_country = {
					is_subject_of = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			multiply_variable = { which = ai_value value = -0.5 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { 
				which = our_army_size 
				value = 10 
			}
			divide_variable = { 
				which = their_army_size 
				value = -10 
			}
			change_variable = { 
				which = our_army_size 
				which = their_army_size 
			}
			multiply_variable = { 
				which = their_mil_tech 
				value = -1 
			}
			change_variable = { 
				which = our_mil_tech 
				which = their_mil_tech 
			}
			multiply_variable = { 
				which = our_mil_tech 
				value = 3 
			}
			change_variable = { 
				which = ai_value 
				which = our_army_size 
			}
			change_variable = { 
				which = ai_value 
				which = our_mil_tech 
			}
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = -89 }
					NOT = { check_variable = { which = eco_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					NOT = { check_variable = { which = eco_power value = -89 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
	}

	ai_will_do = {
		NOT = {
			has_casus_belli = {
				type = cb_imperial
				target = FROM
			}
		}
		FROM = {
			total_development = 70
			NOT = { total_development = 200 }
			OR = {
				NOT = { has_country_flag = declined_establish_protectorate_@ROOT }
				had_country_flag = { flag = declined_establish_protectorate_@ROOT days = 1825 }
			}
			NOT = { adm_tech = ROOT }
			NOT = { dip_tech = ROOT }
			NOT = { mil_tech = ROOT }
			capital_scope = {
				NOT = { continent = north_america }
				NOT = { continent = south_america }
				region_for_scope_province = {
					type = all
					owner = {
						NOT = { is_subject_of = ROOT }
					}
				}
			}
		}
		institution_difference = { who = FROM value = 1 }
		has_opinion = { who = FROM value = 50 }
		OR = {
			ai_attitude = { who = FROM attitude = attitude_friendly }
			ai_attitude = { who = FROM attitude = attitude_allied }
			ai_attitude = { who = FROM attitude = attitude_neutral }
		}
		OR = {
			NOT = { has_casus_belli_against = FROM }
			FROM = {
				NOT = {
					num_of_owned_provinces_with = {
						value = 3
						OR = {
							is_claim = ROOT
							is_core = ROOT
							any_country = {
								is_subject_of = ROOT
								PREV = { is_claim = PREV }
							}
							any_country = {
								is_subject_of = ROOT
								PREV = { is_core = PREV }
							}
						}
					}
				}
			}
		}
	}
}

ask_to_become_protectorate = {
	category = influence

	alert_index = 4
	alert_tooltip = ask_to_become_protectorate_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = protectorate
			}
		}
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = protectorate
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		capital_scope = { trade_range = FROM }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = protectorate
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
				capital_scope = { trade_range = FROM }
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = protectorate
				}
			}
			if = {
				limit = {
					any_country = {
						is_subject_of = ROOT
						is_colonial_nation = no
					}
				}
				every_country = {
					limit = {
						is_subject_of = ROOT
						is_colonial_nation = no
					}
					ROOT = {
						PREV = { grant_independence = yes }
					}
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = protectorate
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
				capital_scope = { trade_range = FROM }
			}
			FROM = {
				clr_country_flag = declined_become_protectorate_@ROOT
				set_country_flag = declined_become_protectorate_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_protectorate
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					NOT = { has_opinion = { who = ROOT value = 0 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					NOT = { has_opinion = { who = ROOT value = 100 } }
					has_opinion = { who = ROOT value = 0 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
			export_to_variable = {
				variable_name = ai_value_2
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value_2 value = 4 }
			change_variable = { which = ai_value which = ai_value_2 }
		}
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					has_opinion = { who = ROOT value = 100 }
				}
			}
			export_to_variable = {
				variable_name = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 8 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_domineering }
						ai_attitude = { who = ROOT attitude = attitude_protective }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10000
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_allied }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			multiply_variable = { which = ai_value value = -0.5 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					NOT = { check_variable = { which = military_power value = -349 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 350
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = -349 }
					NOT = { check_variable = { which = military_power value = 60 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { 
				which = our_army_size 
				value = 10 
			}
			divide_variable = { 
				which = their_army_size 
				value = -10 
			}
			change_variable = { 
				which = our_army_size 
				which = their_army_size 
			}
			multiply_variable = { 
				which = their_mil_tech 
				value = -1 
			}
			change_variable = { 
				which = our_mil_tech 
				which = their_mil_tech 
			}
			multiply_variable = { 
				which = our_mil_tech 
				value = 3 
			}
			change_variable = { 
				which = ai_value 
				which = our_army_size 
			}
			change_variable = { 
				which = ai_value 
				which = our_mil_tech 
			}
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 60 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = -349 }
					NOT = { check_variable = { which = eco_power value = 60 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { 
				which = their_total_development 
				which = their_total_development 
			}
			divide_variable = { 
				which = our_total_development 
				which = their_total_development 
			}
			multiply_variable = { 
				which = ai_value 
				which = our_total_development 
			}
			change_variable = { 
				which = ai_value 
				value = -90 
			}
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					NOT = { check_variable = { which = eco_power value = -349 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 350
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = 60 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
		}
	}

	ai_will_do = {
		total_development = 70
		NOT = { total_development = 200 }
		NOT = { adm_tech = FROM }
		NOT = { dip_tech = FROM }
		NOT = { mil_tech = FROM }
		NOT = { num_of_subjects = 1 }
		has_opinion = { who = FROM value = 50 }
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_become_protectorate_@ROOT }
				had_country_flag = { flag = declined_become_protectorate_@ROOT days = 1825 }
			}
			institution_difference = { who = ROOT value = 1 }
			OR = {
				ai_attitude = { who = ROOT attitude = attitude_friendly }
				ai_attitude = { who = ROOT attitude = attitude_allied }
				ai_attitude = { who = ROOT attitude = attitude_neutral }
				ai_attitude = { who = ROOT attitude = attitude_threatened }
			}
			OR = {
				NOT = { has_casus_belli_against = ROOT }
				ROOT = {
					NOT = {
						num_of_owned_provinces_with = {
							value = 3
							OR = {
								is_claim = FROM
								is_core = FROM
								any_country = {
									is_subject_of = FROM
									PREV = { is_claim = PREV }
								}
								any_country = {
									is_subject_of = FROM
									PREV = { is_core = PREV }
								}
							}
						}
					}
				}
			}
		}
		OR = {
			FROM = { ai = no }
			AND = {
				FROM = {
					NOT = {
						has_casus_belli = {
							type = cb_imperial
							target = FROM
						}
					}
				}
				capital_scope = {
					NOT = { continent = north_america }
					NOT = { continent = south_america }
					region_for_scope_province = {
						type = all
						owner = {
							NOT = { is_subject_of = FROM }
						}
					}
				}
			}
		}
	}
}

cancel_protectorate = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = protectorate
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = protectorate
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		NOT = { truce_with = FROM }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = protectorate
				}
				is_at_war = no
				FROM = { is_at_war = no }
				NOT = { truce_with = FROM }
			}
			if = {
				limit = {
					NOT = { full_idea_group = diplomatic_ideas }
				}
				add_stability = -1
			}
			FROM = {
				grant_independence = yes
				country_event = { id = subjects_expanded_protectorate_events.2 }
				add_opinion = {
					who = ROOT
					modifier = released_protectorate
				}
			}
		}
	}
	ai_will_do = {
		OR = {
			stability = 2
			adm_power = 300
			full_idea_group = diplomatic_ideas
			FROM = {
				liberty_desire = 100
				years_in_vassalage_under = {
					who = ROOT
					years = 50
					all_subject_country = yes
				}
			}
		}
		OR = {
			AND = {
				FROM = {
					all_owned_province = {
						all_neighbor_province = {
							OR = {
								owned_by = FROM
								owned_by = ROOT
								owner = {
									is_subject_of = ROOT
									NOT = { liberty_desire = 50 }
								}
							}
						}
					}
				}
				has_casus_belli_against = FROM
			}
			AND = {
				FROM = { liberty_desire = 80 }
				NOT = {
					calc_true_if = {
						all_province = {
							OR = {
								owned_by = ROOT
								owner = {
									NOT = { tag = FROM }
									is_subject_of = ROOT
								}
							}
							same_continent = FROM
						}
						amount = 15
					}
				}
				OR = {
					is_year = 1800
					current_age = age_of_revolutions
				}
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_puppet_state
establish_puppet_state = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_puppet_state_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = puppet_state
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = puppet_state
		}
		prestige = 0
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = {
			capital_scope = { trade_range = ROOT }
		}
		FROM = {
			NOT = { total_development = 300 }
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = puppet_state
				}
				prestige = 0
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
				FROM = {
					NOT = { total_development = 300 }
				}
			}
			create_subject = {
				subject = FROM
				subject_type = puppet_state
			}
			FROM = {
				country_event = { id = subjects_expanded_puppet_state_events.1 }
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = puppet_state
				}
				prestige = 0
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
				FROM = {
					NOT = { total_development = 300 }
				}
			}
			FROM = {
				clr_country_flag = declined_establish_puppet_state_@ROOT
				set_country_flag = declined_establish_puppet_state_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_puppet_state_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_IS_SUBJECT_AT_RIVAL_BORDER
			limit = {
				FROM = {
					is_subject_of = ROOT
				}
				OR = {
					any_rival_country = {
						is_neighbor_of = FROM
					}
					any_enemy_country = {
						is_neighbor_of = FROM
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_MONARCHY
			limit = {
				FROM = {
					government = monarchy
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_OTHER_IDEOLOGY
			limit = {
				OR = {
					# Fascist Government Type
					AND = {
						OR = {
							#has_reform = fascist_government
							#has_reform = military_government
							has_reform = presidential_despot_reform
						}
						FROM = {
							#NOT = { has_reform = fascist_government }
							#NOT = { has_reform = military_government }
							NOT = { has_reform = presidential_despot_reform }
						}
					}
					# Communist Government Type
					AND = {
						OR = {
							has_reform = peasants_republic
							#has_reform = communist_government
						}
						FROM = {
							NOT = { has_reform = peasants_republic }
							#NOT = { has_reform = communist_government }
						}
					}
					# Capitalist Government Type
					AND = {
						OR = {
							has_reform = administrative_monarchy
							has_reform = constitutional_monarchy
							has_reform = merchants_reform
							has_reform = oligarchy_reform
							has_reform = administrative_republic
							has_reform = constitutional_republic
							has_reform = bureaucratic_despotism
							has_reform = english_monarchy
							has_reform = scottish_monarchy
							has_reform = trading_city
							has_reform = dutch_republic
							has_reform = american_republic
							has_reform = federal_republic
						}
						FROM = {
							NOT = { has_reform = administrative_monarchy }
							NOT = { has_reform = constitutional_monarchy }
							NOT = { has_reform = merchants_reform }
							NOT = { has_reform = oligarchy_reform }
							NOT = { has_reform = administrative_republic }
							NOT = { has_reform = constitutional_republic }
							NOT = { has_reform = bureaucratic_despotism }
							NOT = { has_reform = english_monarchy }
							NOT = { has_reform = scottish_monarchy }
							NOT = { has_reform = trading_city }
							NOT = { has_reform = dutch_republic }
							NOT = { has_reform = american_republic }
							NOT = { has_reform = federal_republic }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NOT_RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 200
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 200
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 190
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 200
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 190
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 180
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 190
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 180
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 170
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 180
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 170
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 160
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 170
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 160
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 150
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 160
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 150
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 140
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 150
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 140
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 130
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 140
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 130
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 120
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 130
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 120
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 110
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 120
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 110
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 100
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 110
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 90
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 100
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 80
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 90
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 80
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 70
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 80
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 70
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 60
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 70
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 50
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 60
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 40
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 30
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 40
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 20
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 10
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 20
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 10
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1
			}
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = FROM_HAS_AT_LEAST_HALF_OF_ROOT_TOTAL_DEVELOPMENT
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					divide_variable = { which = our_total_development value = 2 }

					check_variable = { which = their_total_development which = our_total_development }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				any_country = {
					is_subject_of = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			multiply_variable = { which = ai_value value = -0.5 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					NOT = { check_variable = { which = military_power value = -49 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = -49 }
					NOT = { check_variable = { which = military_power value = 50 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = -49 }
					NOT = { check_variable = { which = eco_power value = 50 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					NOT = { check_variable = { which = eco_power value = -49 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }

					check_variable = { which = eco_power value = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				FROM = {
					has_reform = free_city
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		num_of_free_diplomatic_relations = 1
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_establish_puppet_state_@ROOT }
				had_country_flag = { flag = declined_establish_puppet_state_@ROOT days = 1825 }
			}
			NOT = { is_subject_of = ROOT }
		}
		is_revolution_target = no
		OR = {
			is_neighbor_of = FROM
			any_rival_country = {
				is_neighbor_of = FROM
			}
		}
		OR = {
			AND = {
				is_great_power = yes
				NOT = { great_power_rank = 4 }
			}
			tag = USA
			tag = ENG
			tag = GBR
			tag = RUS
			# Fascist Government Type
			#has_reform = fascist_government
			#has_reform = military_government
			has_reform = presidential_despot_reform
			# Communist Government Type
			has_reform = peasants_republic
			#has_reform = communist_government
			# Capitalist Government Type
			has_reform = administrative_monarchy
			has_reform = constitutional_monarchy
			has_reform = merchants_reform
			has_reform = oligarchy_reform
			has_reform = administrative_republic
			has_reform = constitutional_republic
			has_reform = bureaucratic_despotism
			has_reform = english_monarchy
			has_reform = scottish_monarchy
			has_reform = trading_city
			has_reform = dutch_republic
			has_reform = american_republic
			has_reform = federal_republic
		}
	}
}

cancel_puppet_state = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = puppet_state
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = puppet_state
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		NOT = { truce_with = FROM }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = puppet_state
				}
				is_at_war = no
				FROM = { is_at_war = no }
				NOT = { truce_with = FROM }
			}
			if = {
				limit = {
					NOT = { full_idea_group = diplomatic_ideas }
				}
				add_stability = -1
			}
			add_prestige = -20
			FROM = {
				grant_independence = yes
				country_event = { id = subjects_expanded_puppet_state_events.2 }
				add_opinion = {
					who = ROOT
					modifier = released_puppet_state
				}
			}
			add_truce_with = FROM
		}
	}

	ai_will_do = {
		OR = {
			stability = 1
			adm_power = 300
			full_idea_group = diplomatic_ideas
		}
		NOT = {
			OR = {
				total_development = 300
				AND = {
					is_great_power = yes
					NOT = { great_power_rank = 4 }
				}
				tag = USA
				tag = ENG
				tag = GBR
				tag = RUS
				# Fascist Government Type
				#has_reform = fascist_government
				#has_reform = military_government
				has_reform = presidential_despot_reform
				# Communist Government Type
				has_reform = peasants_republic
				#has_reform = communist_government
				# Capitalist Government Type
				has_reform = administrative_monarchy
				has_reform = constitutional_monarchy
				has_reform = merchants_reform
				has_reform = oligarchy_reform
				has_reform = administrative_republic
				has_reform = constitutional_republic
				has_reform = bureaucratic_despotism
				has_reform = english_monarchy
				has_reform = scottish_monarchy
				has_reform = trading_city
				has_reform = dutch_republic
				has_reform = american_republic
				has_reform = federal_republic
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_religious_march
establish_religious_march = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_subject = no
		can_create_subject_type = {
			subject = FROM
			subject_type = religious_march
		}
	}

	is_allowed = {
		is_subject = no
		can_create_subject_type = {
			subject = FROM
			subject_type = religious_march
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}

	on_accept = {
		if = {
			limit = {
				is_subject = no
				can_create_subject_type = {
					subject = FROM
					subject_type = religious_march
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			create_subject = {
				subject = FROM
				subject_type = religious_march
			}
		}
	}

	ai_will_do = {
		FROM = {
			NOT = { liberty_desire = 50 }
			NOT = { is_different_march_subject = yes }
			NOT = { development_of_overlord_fraction = 0.25 }
			num_of_missionaries = 1
			any_neighbor_country = {
				OR = {
					is_rival = ROOT
					is_enemy = ROOT
				}
				NOT = { religion_group = ROOT }
			}
			NOT = { religious_unity = 0.7 }
			NOT = {
				can_create_subject_type = {
					subject = FROM
					subject_type = crusader_state_vassal
				}
			}
			NOT = {
				can_create_subject_type = {
					subject = FROM
					subject_type = iqta_vassal
				}
			}
			NOT = {
				num_of_owned_provinces_with = {
					value = 10
					is_permanent_claim = ROOT
				}
			}
		}
	}
}

ask_to_become_religious_march = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_to_become_religious_march_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			is_subject = no
			can_create_subject_type = {
				subject = ROOT
				subject_type = religious_march
			}
		}
	}

	is_allowed = {
		FROM = {
			is_subject = no
			can_create_subject_type = {
				subject = ROOT
				subject_type = religious_march
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					can_create_subject_type = {
						subject = ROOT
						subject_type = religious_march
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = religious_march
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					can_create_subject_type = {
						subject = ROOT
						subject_type = religious_march
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			FROM = {
				clr_country_flag = declined_become_religious_march_@ROOT
				set_country_flag = declined_become_religious_march_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_religious_march
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = ROOT_IS_VASSAL_FOR_AT_LEAST_10_YEARS
			limit = {
				years_in_vassalage_under = {
					who = FROM
					years = 10
					all_subject_country = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_NOT_A_NEIGHBOR_OF_FROMS_RIVALS
			limit = {
				NOT = {
					any_neighbor_country = {
						OR = {
							is_rival = FROM
							is_enemy = FROM
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_MORE_THAN_25_PERCENT_OF_OVERLORD_DEVELOPMENT
			limit = {
				development_of_overlord_fraction = 0.25
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_TOO_FEW_PRODUCTION_INCOME
			limit = {
				OR = {
					NOT = { monthly_income = 20 }
					NOT = { production_income_percentage = 0.35 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_HAS_TOO_HIGH_RELIGIOUS_UNITY
			limit = {
				religious_unity = 0.75
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		NOT = { liberty_desire = 50 }
		NOT = { is_different_march_subject = yes }
		NOT = { religious_unity = 0.6 }
		num_of_missionaries = 1
		any_neighbor_country = {
			OR = {
				is_rival = FROM
				is_enemy = FROM
			}
			NOT = { religion_group = FROM }
		}
		FROM = {
			NOT = {
				can_create_subject_type = {
					subject = ROOT
					subject_type = crusader_state_vassal
				}
			}
			NOT = {
				can_create_subject_type = {
					subject = ROOT
					subject_type = iqta_vassal
				}
			}
			OR = {
				NOT = { has_country_flag = declined_become_religious_march_@ROOT }
				had_country_flag = { flag = declined_become_religious_march_@ROOT days = 1825 }
			}
		}
		NOT = {
			num_of_owned_provinces_with = {
				value = 10
				is_permanent_claim = FROM
			}
		}
	}
}

religious_march_enable_increased_conversion_efforts = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = religious_march
			NOT = { has_country_flag = religious_march_increased_conversion_efforts }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = religious_march
				NOT = { has_country_flag = religious_march_increased_conversion_efforts }
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			any_owned_province = {
				has_owner_religion = no
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = religious_march
					NOT = { has_country_flag = religious_march_increased_conversion_efforts }
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					any_owned_province = {
						has_owner_religion = no
					}
				}
			}
			FROM = {
				set_country_flag = religious_march_increased_conversion_efforts
			}
		}
	}

	ai_will_do = {
		FROM = {
			is_at_war = no
			NOT = { liberty_desire = 35 }
			NOT = { religious_unity = 0.5 }
		}
	}
}

religious_march_disable_increased_conversion_efforts = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = religious_march
			has_country_flag = religious_march_increased_conversion_efforts
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = religious_march
				has_country_flag = religious_march_increased_conversion_efforts
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = religious_march
					has_country_flag = religious_march_increased_conversion_efforts
				}
				is_at_war = no
				FROM = { is_at_war = no }
			}
			add_prestige = -10
			FROM = {
				clr_country_flag = religious_march_increased_conversion_efforts
			}
		}
	}

	ai_will_do = {
		FROM = {
			OR = {
				is_at_war = yes
				liberty_desire = 55
				religious_unity = 0.8
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_revolution_subject
cancel_revolution_subject = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		NOT = { has_dlc = "Rights of Man" }
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = revolution_subject
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			NOT = { has_dlc = "Rights of Man" }
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = revolution_subject
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}
	
	on_accept = {
		if = {
			limit = {
				NOT = { has_dlc = "Rights of Man" }
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = revolution_subject
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}
	
	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 25
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_roman_client_kingdom
establish_roman_client_kingdom = {
	category = influence

	require_acceptance = no

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = roman_client_kingdom
		}
		FROM = {
			is_subject_of = PREV
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = roman_client_kingdom
		}
		FROM = {
			is_subject_of = PREV
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = roman_client_kingdom
				}
				FROM = {
					is_subject_of = PREV
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			create_subject = {
				subject = FROM
				subject_type = roman_client_kingdom
			}
		}
	}

	ai_will_do = {
		OR = {
			num_of_free_diplomatic_relations = 1
			FROM = {
				any_neighbor_country = {
					OR = {
						is_rival = FROM
						is_enemy = FROM
					}
				}
			}
		}
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
	}
}

place_roman_ruler_on_subject_throne = {
	category = influence

	require_acceptance = no

	is_visible = {
		OR = {
			tag = ROM
			#tag = ROW
			tag = BYZ
		}
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = roman_client_kingdom
			government = monarchy
			has_regency = no
		}
	}

	is_allowed = {
		hidden_trigger = {
			OR = {
				tag = ROM
				#tag = ROW
				tag = BYZ
			}
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = roman_client_kingdom
				government = monarchy
				has_regency = no
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_REPLACE_CURRENT_RULER
				NOT = { has_ruler_flag = placed_on_throne_by_@ROOT }
			}
		}
		custom_trigger_tooltip = {
			tooltip = DID_NOT_REPLACE_RULER_WITHIN_LAST_50_YEARS
			NOT = { has_country_modifier = cooldown_placed_roman_ruler_on_subject_throne }
		}
	}

	on_accept = {
		if = {
			limit = {
				OR = {
					tag = ROM
					#tag = ROW
					tag = BYZ
				}
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = roman_client_kingdom
					government = monarchy
					has_regency = no
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					NOT = { has_ruler_flag = placed_on_throne_by_@ROOT }
				}
				NOT = { has_country_modifier = cooldown_placed_roman_ruler_on_subject_throne }
			}
			FROM = {
				define_ruler = {
					culture = ROOT
					religion = ROOT
					male = yes
				}
				if = {
					limit = {
						has_heir = yes
					}
					kill_heir = {}
				}
				add_liberty_desire = 10
				set_ruler_flag = placed_on_throne_by_@ROOT
				add_opinion = {
					who = ROOT
					modifier = roman_client_kingdom_replaced_ruler
				}
			}
			add_country_modifier = {
				name = cooldown_placed_roman_ruler_on_subject_throne
				duration = 18250
				hidden = yes
			}
		}
	}

	ai_will_do = {
		FROM = {
			months_of_ruling = 60
			NOT = { marriage_with = ROOT }
			NOT = { dynasty = ROOT }
			NOT = { ruler_culture = ROOT }
			OR = {
				AND = {
					has_heir = no
					NOT = { legitimacy = 50 }
				}
				AND = {
					is_female = yes
					ROOT = { is_female = no }
				}
			}
		}
	}
}

demand_additional_tribute_from_roman_client_kingdom = {
	category = influence

	require_acceptance = no

	is_visible = {
		OR = {
			tag = ROM
			#tag = ROW
			tag = BYZ
		}
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = roman_client_kingdom
		}
	}

	is_allowed = {
		hidden_trigger = {
			OR = {
				tag = ROM
				#tag = ROW
				tag = BYZ
			}
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = roman_client_kingdom
			}
		}
		FROM = { NOT = { liberty_desire = 50 } }
	}

	on_accept = {
		if = {
			limit = {
				OR = {
					tag = ROM
					#tag = ROW
					tag = BYZ
				}
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = roman_client_kingdom
				}
				FROM = { NOT = { liberty_desire = 50 } }
			}
			FROM = {
				country_event = { id = subjects_expanded_roman_client_kingdom_events.3 }
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

cancel_roman_client_kingdom = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = roman_client_kingdom
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = roman_client_kingdom
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = roman_client_kingdom
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 30
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_sister_republic
establish_sister_republic = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_sister_republic_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = sister_republic
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = sister_republic
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		has_opinion = {
			who = FROM
			value = 150
		}
		reverse_has_opinion = {
			who = FROM
			value = 150
		}
		total_development = FROM
		FROM = {
			variable_arithmetic_trigger = {
				custom_tooltip = HAS_AT_LEAST_ONE_THIRD_OF_PREV_TOTAL_DEVELOPMENT
				export_to_variable = {
					which = our_total_development
					value = trigger_value:total_development
				}
				#subtract_variable = { which = our_total_development value = 1 }
				export_to_variable = {
					which = their_total_development
					value = trigger_value:total_development
					who = PREV
				}
				#subtract_variable = { which = their_total_development value = 1 }
				divide_variable = { which = their_total_development value = 3 }
				check_variable = { which = our_total_development which = their_total_development }
			}
		}
		if = {
			limit = {
				has_dlc = "The Cossacks"
				OR = {
					ai = yes
					FROM = {
						ai = yes
					}
				}
			}
			trust = {
				who = FROM
				value = 60
			}
			FROM = {
				trust = {
					who = ROOT
					value = 60
				}
			}
		}
		if = {
			limit = {
				FROM = {
					NOT = { is_subject_of = ROOT }
				}
			}
			alliance_with = FROM
		}
		else = {
			FROM = {
				NOT = { liberty_desire = 50 }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = sister_republic
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				has_opinion = {
					who = FROM
					value = 150
				}
				reverse_has_opinion = {
					who = FROM
					value = 150
				}
				total_development = FROM
				FROM = {
					variable_arithmetic_trigger = {
						custom_tooltip = HAS_AT_LEAST_ONE_THIRD_OF_PREV_TOTAL_DEVELOPMENT
						export_to_variable = {
							which = our_total_development
							value = trigger_value:total_development
						}
						#subtract_variable = { which = our_total_development value = 1 }
						export_to_variable = {
							which = their_total_development
							value = trigger_value:total_development
							who = PREV
						}
						#subtract_variable = { which = their_total_development value = 1 }
						divide_variable = { which = their_total_development value = 3 }
						check_variable = { which = our_total_development which = their_total_development }
					}
				}
				if = {
					limit = {
						has_dlc = "The Cossacks"
						OR = {
							ai = yes
							FROM = {
								ai = yes
							}
						}
					}
					trust = {
						who = FROM
						value = 60
					}
					FROM = {
						trust = {
							who = ROOT
							value = 60
						}
					}
				}
				if = {
					limit = {
						FROM = {
							NOT = { is_subject_of = ROOT }
						}
					}
					alliance_with = FROM
				}
				else = {
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			create_subject = {
				subject = FROM
				subject_type = sister_republic
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = sister_republic
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				has_opinion = {
					who = FROM
					value = 150
				}
				reverse_has_opinion = {
					who = FROM
					value = 150
				}
				total_development = FROM
				FROM = {
					variable_arithmetic_trigger = {
						custom_tooltip = HAS_AT_LEAST_ONE_THIRD_OF_PREV_TOTAL_DEVELOPMENT
						export_to_variable = {
							which = our_total_development
							value = trigger_value:total_development
						}
						#subtract_variable = { which = our_total_development value = 1 }
						export_to_variable = {
							which = their_total_development
							value = trigger_value:total_development
							who = PREV
						}
						#subtract_variable = { which = their_total_development value = 1 }
						divide_variable = { which = their_total_development value = 3 }
						check_variable = { which = our_total_development which = their_total_development }
					}
				}
				if = {
					limit = {
						has_dlc = "The Cossacks"
						OR = {
							ai = yes
							FROM = {
								ai = yes
							}
						}
					}
					trust = {
						who = FROM
						value = 60
					}
					FROM = {
						trust = {
							who = ROOT
							value = 60
						}
					}
				}
				if = {
					limit = {
						FROM = {
							NOT = { is_subject_of = ROOT }
						}
					}
					alliance_with = FROM
				}
				else = {
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			FROM = {
				clr_country_flag = declined_establish_sister_republic_@ROOT
				set_country_flag = declined_establish_sister_republic_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_sister_republic_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = base_values
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_VASSAL_OF_ROOT
			limit = {
				overlord_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				overlord_of = FROM
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_DIFF_OF_GOV_RANKS
			export_to_variable = {
				which = ai_value
				value = trigger_value:government_rank
			}
			export_to_variable = {
				which = ai_value_2
				value = trigger_value:government_rank
				who = FROM
			}
			subtract_variable = { 
				which = ai_value 
				which = ai_value_2 
			}
			multiply_variable = { 
				which = ai_value 
				value = 10 
			}
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				NOT = { overlord_of = FROM }
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 75
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				NOT = { overlord_of = FROM }
				is_part_of_hre = yes
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					tag = PAP
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MORE_THAN_200_TOTAL_DEVELOPMENT
			limit = {
				FROM = {
					total_development = 200
				}
			}
			export_to_variable = {
				which = ai_value
				value = 75
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				NOT = { overlord_of = FROM }
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				FROM = {
					has_reform = free_city
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_A_THEOCRACY
			limit = {
				FROM = {
					government = theocracy
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MUTUAL_OPINION_ABOVE_150
			limit = {
				has_opinion = {
					who = FROM
					value = 150
				}
				reverse_has_opinion = {
					who = FROM
					value = 150
				}
			}
			export_to_variable = {
				which = ai_value
				value = opinion
				who = ROOT
				with = FROM
			}
			export_to_variable = {
				which = ai_value_2
				value = opinion
				who = FROM
				with = ROOT
			}
			change_variable = { which = ai_value which = ai_value_2 }
			divide_variable = { which = ai_value value = 2 }
			subtract_variable = { which = ai_value value = 150 }
			divide_variable = { which = ai_value value = 3.3 }
		}
	}

	ai_will_do = {
		FROM = {
			NOT = { is_subject_of = ROOT }
			is_neighbor_of = ROOT
			OR = {
				NOT = { has_country_flag = declined_establish_sister_republic_@ROOT }
				had_country_flag = { flag = declined_establish_sister_republic_@ROOT days = 1825 }
			}
		}
	}
}

ask_for_sister_republic = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_for_sister_republic_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = sister_republic
			}
		}
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = sister_republic
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		has_opinion = {
			who = FROM
			value = 150
		}
		reverse_has_opinion = {
			who = FROM
			value = 150
		}
		FROM = {
			total_development = ROOT
		}
		FROM = {
			ROOT = {
				variable_arithmetic_trigger = {
					custom_tooltip = HAS_AT_LEAST_ONE_THIRD_OF_PREV_TOTAL_DEVELOPMENT
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					#subtract_variable = { which = our_total_development value = 1 }
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = PREV
					}
					#subtract_variable = { which = their_total_development value = 1 }
					divide_variable = { which = their_total_development value = 3 }
					check_variable = { which = our_total_development which = their_total_development }
				}
			}
		}
		if = {
			limit = {
				has_dlc = "The Cossacks"
			}
			trust = {
				who = FROM
				value = 60
			}
			FROM = {
				trust = {
					who = ROOT
					value = 60
				}
			}
		}
		if = {
			limit = {
				NOT = { is_subject_of = FROM }
			}
			alliance_with = FROM
		}
		else = {
			NOT = { liberty_desire = 50 }
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = sister_republic
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				has_opinion = {
					who = FROM
					value = 150
				}
				reverse_has_opinion = {
					who = FROM
					value = 150
				}
				FROM = {
					total_development = ROOT
				}
				FROM = {
					ROOT = {
						variable_arithmetic_trigger = {
							custom_tooltip = HAS_AT_LEAST_ONE_THIRD_OF_PREV_TOTAL_DEVELOPMENT
							export_to_variable = {
								which = our_total_development
								value = trigger_value:total_development
							}
							#subtract_variable = { which = our_total_development value = 1 }
							export_to_variable = {
								which = their_total_development
								value = trigger_value:total_development
								who = PREV
							}
							#subtract_variable = { which = their_total_development value = 1 }
							divide_variable = { which = their_total_development value = 3 }
							check_variable = { which = our_total_development which = their_total_development }
						}
					}
				}
				if = {
					limit = {
						has_dlc = "The Cossacks"
					}
					trust = {
						who = FROM
						value = 60
					}
					FROM = {
						trust = {
							who = ROOT
							value = 60
						}
					}
				}
				if = {
					limit = {
						NOT = { is_subject_of = FROM }
					}
					alliance_with = FROM
				}
				else = {
					NOT = { liberty_desire = 50 }
				}
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = sister_republic
				}
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = sister_republic
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				has_opinion = {
					who = FROM
					value = 150
				}
				reverse_has_opinion = {
					who = FROM
					value = 150
				}
				FROM = {
					total_development = ROOT
				}
				FROM = {
					ROOT = {
						variable_arithmetic_trigger = {
							custom_tooltip = HAS_AT_LEAST_ONE_THIRD_OF_PREV_TOTAL_DEVELOPMENT
							export_to_variable = {
								which = our_total_development
								value = trigger_value:total_development
							}
							#subtract_variable = { which = our_total_development value = 1 }
							export_to_variable = {
								which = their_total_development
								value = trigger_value:total_development
								who = PREV
							}
							#subtract_variable = { which = their_total_development value = 1 }
							divide_variable = { which = their_total_development value = 3 }
							check_variable = { which = our_total_development which = their_total_development }
						}
					}
				}
				if = {
					limit = {
						has_dlc = "The Cossacks"
					}
					trust = {
						who = FROM
						value = 60
					}
					FROM = {
						trust = {
							who = ROOT
							value = 60
						}
					}
				}
				if = {
					limit = {
						NOT = { is_subject_of = FROM }
					}
					alliance_with = FROM
				}
				else = {
					NOT = { liberty_desire = 50 }
				}
			}
			clr_country_flag = declined_establish_sister_republic_@FROM
			set_country_flag = declined_establish_sister_republic_@FROM
			add_opinion = {
				who = FROM
				modifier = declined_ask_for_sister_republic_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = STRATEGIC_VALUE
			limit = {
				NOT = {
					AND = {
						NOT = { is_subject_of = FROM }
						is_neighbor_of = FROM
						OR = {
							NOT = { has_country_flag = declined_establish_sister_republic_@FROM }
							had_country_flag = { flag = declined_establish_sister_republic_@FROM days = 1825 }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = base_values
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_VASSAL_OF_FROM
			limit = {
				is_subject_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = ROOT_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				is_subject_of = FROM
				liberty_desire = 50
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = mil_tech
				who = FROM
			}
			export_to_variable = {
				which = their_mil_tech
				value = mil_tech
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
				who = FROM
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = mil_tech
						who = FROM
					}
					export_to_variable = {
						which = their_mil_tech
						value = mil_tech
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					change_variable = { which = our_mil_tech which = their_mil_tech }
					multiply_variable = { which = our_mil_tech value = 3 }
					change_variable = { which = military_power which = our_army_size }
					change_variable = { which = military_power which = our_mil_tech }
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_HAS_MORE_THAN_200_TOTAL_DEVELOPMENT
			limit = {
				total_development = 200
			}
			export_to_variable = {
				which = ai_value
				value = 75
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				NOT = { is_subject_of = FROM }
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = MUTUAL_OPINION_ABOVE_150
			limit = {
				has_opinion = {
					who = FROM
					value = 150
				}
				reverse_has_opinion = {
					who = FROM
					value = 150
				}
			}
			export_to_variable = {
				which = ai_value
				value = opinion
				who = ROOT
				with = FROM
			}
			export_to_variable = {
				which = ai_value_2
				value = opinion
				who = FROM
				with = ROOT
			}
			change_variable = { which = ai_value which = ai_value_2 }
			divide_variable = { which = ai_value value = 2 }
			subtract_variable = { which = ai_value value = 150 }
			divide_variable = { which = ai_value value = 3.3 }
		}
	}

	ai_will_do = {
		NOT = { has_reform = free_city }
		NOT = { num_of_subjects = 1 }
		OR = {
			is_subject_of = FROM
			AND = {
				is_part_of_hre = no
				FROM = { is_part_of_hre = no }
			}
			AND = {
				is_part_of_hre = yes
				FROM = { is_part_of_hre = yes }
			}
		}
		OR = {
			AND = {
				NOT = { government_rank = 3 }
				FROM = { government_rank = 3 }
			}
			AND = {
				NOT = { government_rank = 2 }
				FROM = { government_rank = 2 }
			}
		}
		government = republic
		NOT = { total_development = 200 }
		is_neighbor_of = FROM
		historical_friend_with = FROM
		NOT = { army_size = FROM }
		OR = {
			NOT = { has_country_flag = declined_establish_sister_republic_@FROM }
			had_country_flag = { flag = declined_establish_sister_republic_@FROM days = 1825 }
		}
	}
}

sister_republic_ask_overlord_to_join_war = {
	category = alliance

	alert_index = 6
	alert_tooltip = sister_republic_ask_overlord_to_join_war_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			is_subject = no
			overlord_of = ROOT
		}
		is_subject_of_type = sister_republic
		any_country = {
			is_subject = no
			is_in_war = {
				defender_leader = THIS
				attacker_leader = ROOT
			}
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject = no
				overlord_of = ROOT
			}
			is_subject_of_type = sister_republic
			any_country = {
				is_subject = no
				is_in_war = {
					defender_leader = THIS
					attacker_leader = ROOT
				}
			}
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_DECLINE_A_CALL_TO_ARMS_OF_A_SUBJECT_WITHIN_LAST_1_YEAR
				OR = {
					NOT = { has_country_flag = declined_sister_republic_offensive_call_to_arms }
					had_country_flag = { flag = declined_sister_republic_offensive_call_to_arms days = 365 }
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					overlord_of = ROOT
				}
				is_subject_of_type = sister_republic
				any_country = {
					is_subject = no
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
				}
				FROM = {
					OR = {
						NOT = { has_country_flag = declined_sister_republic_offensive_call_to_arms }
						had_country_flag = { flag = declined_sister_republic_offensive_call_to_arms days = 365 }
					}
				}
			}
			FROM = {
				join_all_offensive_wars_of = ROOT
				clr_country_flag = accepted_sister_republic_offensive_call_to_arms
				set_country_flag = accepted_sister_republic_offensive_call_to_arms
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					is_subject = no
					overlord_of = ROOT
				}
				is_subject_of_type = sister_republic
				any_country = {
					is_subject = no
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
				}
				FROM = {
					OR = {
						NOT = { has_country_flag = declined_sister_republic_offensive_call_to_arms }
						had_country_flag = { flag = declined_sister_republic_offensive_call_to_arms days = 365 }
					}
				}
			}
			FROM = {
				clr_country_flag = declined_sister_republic_offensive_call_to_arms
				set_country_flag = declined_sister_republic_offensive_call_to_arms
			}
			add_liberty_desire = 10
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_RULER_MIL_SKILL
			export_to_variable = {
				which = ai_value
				value = MIL
				who = FROM
			}
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_defensive }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_threatened }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 120
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_hostile }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 150
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_ATTITUDE_TOWARDS_FROM
			limit = {
				ai_attitude = { who = FROM attitude = attitude_loyal }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				liberty_desire = 50
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					FROM = {
						ai_attitude = { who = PREV attitude = atittude_rivalry }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					FROM = {
						ai_attitude = { who = PREV attitude = attitude_hostile }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					FROM = {
						ai_attitude = { who = PREV attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					FROM = {
						ai_attitude = { who = PREV attitude = attitude_friendly }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_ALREADY_FIGHTING_IN_A_WAR
			limit = {
				FROM = {
					is_at_war = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALREADY_PARTICIPANT_IN_WAR_WITH_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					is_in_war = {
						participants = FROM
						participants = THIS
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_TRUCE_WITH_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					truce_with = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALLIED_TO_COALITION_TARGET
			limit = {
				any_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
					alliance_with = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ALREADY_JOINED_A_WAR_AGAINST_A_COALITION_TARGET_OF_ROOT_WITHIN_LAST_365_DAYS
			limit = {
				FROM = {
					has_country_flag = accepted_sister_republic_offensive_call_to_arms
					NOT = { had_country_flag = { flag = accepted_sister_republic_offensive_call_to_arms days = 365 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_WOULD_GET_STABILITY_HIT
			limit = {
				OR = {
					any_country = {
						is_in_war = {
							defender_leader = THIS
							attacker_leader = ROOT
						}
						OR = {
							marriage_with = FROM
							truce_with = FROM
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_IN_DEBT
			limit = {
				FROM = {
					num_of_loans = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:num_of_loans
				who = FROM
			}
			multiply_variable = { which = ai_value value = -10 }
		}
		add_entry = {
			name = FROM_WAR_EXHAUSTION
			export_to_variable = {
				which = ai_value
				value = trigger_value:war_exhaustion
				who = FROM
			}
			multiply_variable = { which = ai_value value = -10 }
		}
	}

	ai_will_do = {
		overlord = {
			is_at_war = no
		}
		any_country = {
			is_subject = no
			is_in_war = {
				defender_leader = THIS
				attacker_leader = ROOT
			}
			war_score_against = { who = ROOT value = 25 }
		}
		NOT = {
			calc_true_if = {
				all_country = {
					is_in_war = {
						defender_leader = THIS
						attacker_leader = ROOT
					}
				}
				amount = 3
			}
		}
	}
}

cancel_sister_republic = {
	category = influence

	require_acceptance = no

	is_visible = {
		NOT = { has_dlc = "Rights of Man" }
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = sister_republic
		}
	}

	is_allowed = {
		hidden_trigger = {
			NOT = { has_dlc = "Rights of Man" }
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = sister_republic
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				NOT = { has_dlc = "Rights of Man" }
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = sister_republic
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 90
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_stato_da_mar_vassal
establish_stato_da_mar_vassal = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_stato_da_mar_vassal_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = stato_da_mar_vassal
		}
		FROM = {
			OR = {
				is_subject_of = ROOT
				NOT = { num_of_cities = 2 }
			}
			capital_scope = {
				NOT = {
					any_trade_node_member_country = {
						is_subject_of_type_with_overlord = {
							who = ROOT
							type = stato_da_mar_vassal
						}
					}
				}
			}
		}
		capital_scope = {
			FROM = {
				capital_scope = {
					NOT = { region = PREV_PREV }
				}
			}
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				OR = {
					is_subject_of = ROOT
					NOT = { num_of_cities = 2 }
				}
				capital_scope = {
					NOT = {
						any_trade_node_member_country = {
							is_subject_of_type_with_overlord = {
								who = ROOT
								type = stato_da_mar_vassal
							}
						}
					}
				}
			}
			capital_scope = {
				FROM = {
					capital_scope = {
						NOT = { region = PREV_PREV }
					}
				}
			}
		}
		can_create_subject_type = {
			subject = FROM
			subject_type = stato_da_mar_vassal
		}
		FROM = {
			capital_scope = { trade_range = ROOT }
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
				}
			}
			FROM = {
				NOT = { liberty_desire = 50 }
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					OR = {
						is_subject_of = ROOT
						NOT = { num_of_cities = 2 }
					}
					capital_scope = {
						NOT = {
							any_trade_node_member_country = {
								is_subject_of_type_with_overlord = {
									who = ROOT
									type = stato_da_mar_vassal
								}
							}
						}
					}
				}
				capital_scope = {
					FROM = {
						capital_scope = {
							NOT = { region = PREV_PREV }
						}
					}
				}
				can_create_subject_type = {
					subject = FROM
					subject_type = stato_da_mar_vassal
				}
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				if = {
					limit = {
						FROM = {
							is_subject_of = ROOT
						}
					}
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			create_subject = {
				subject = FROM
				subject_type = stato_da_mar_vassal
			}
			add_truce_with = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					OR = {
						is_subject_of = ROOT
						NOT = { num_of_cities = 2 }
					}
					capital_scope = {
						NOT = {
							any_trade_node_member_country = {
								is_subject_of_type_with_overlord = {
									who = ROOT
									type = stato_da_mar_vassal
								}
							}
						}
					}
				}
				capital_scope = {
					FROM = {
						capital_scope = {
							NOT = { region = PREV_PREV }
						}
					}
				}
				can_create_subject_type = {
					subject = FROM
					subject_type = stato_da_mar_vassal
				}
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				if = {
					limit = {
						FROM = {
							is_subject_of = ROOT
						}
					}
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			FROM = {
				clr_country_flag = declined_establish_stato_da_mar_vassal_@ROOT
				set_country_flag = declined_establish_stato_da_mar_vassal_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_stato_da_mar_vassal_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = FROM_IS_VASSAL_OF_ROOT
			limit = {
				overlord_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				overlord_of = FROM
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				NOT = { overlord_of = FROM }
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPEROR
			limit = {
				FROM = {
					is_emperor = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -4 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_IMPERIAL_CITY
			limit = {
				FROM = {
					has_reform = free_city
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_ACCEPT_VASSALIZATION_REASONS
			export_to_variable = {
				which = ai_value
				value = modifier:accept_vassalization_reasons
			}
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_HIGH_TRADE_POWER_IN_THEIR_HOME_NODE
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					capital_scope = {
						trade_share = {
							country = PREV
							share = 30
						}
						NOT = {
							trade_share = {
								country = PREV
								share = 50
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_HIGH_TRADE_POWER_IN_THEIR_HOME_NODE
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					capital_scope = {
						trade_share = {
							country = PREV
							share = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			multiply_variable = { which = ai_value value = -1.5 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			limit = {
				overlord_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_ALLIES
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					any_ally = {
						NOT = { tag = ROOT }
						army_size = 20
					}
					NOT = {
						calc_true_if = {
							all_ally = {
								NOT = { tag = ROOT }
								army_size = 20
							}
							amount = 2
						}
					}
					NOT = {
						any_ally = {
							NOT = { tag = ROOT }
							OR = {
								army_size = 100
								military_strength = { who = ROOT value = 2 }
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_ALLIES
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					calc_true_if = {
						all_ally = {
							NOT = { tag = ROOT }
							army_size = 20
						}
						amount = 2
					}
					NOT = {
						any_ally = {
							NOT = { tag = ROOT }
							OR = {
								army_size = 100
								military_strength = { who = ROOT value = 2 }
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_ALLIES
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					any_ally = {
						NOT = { tag = ROOT }
						OR = {
							army_size = 100
							military_strength = { who = ROOT value = 2 }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_GUARANTEES
			limit = {
				NOT = { overlord_of = FROM }
				any_country = {
					NOT = { tag = ROOT }
					FROM = {
						guaranteed_by = PREV
					}
					army_size = 20
				}
				NOT = {
					calc_true_if = {
						all_country = {
							NOT = { tag = ROOT }
							FROM = {
								guaranteed_by = PREV
							}
							army_size = 20
						}
						amount = 2
					}
				}
				NOT = {
					any_country = {
						NOT = { tag = ROOT }
						FROM = {
							guaranteed_by = PREV
						}
						OR = {
							army_size = 100
							military_strength = { who = ROOT value = 2 }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_GUARANTEES
			limit = {
				NOT = { overlord_of = FROM }
				calc_true_if = {
					all_country = {
						NOT = { tag = ROOT }
						FROM = {
							guaranteed_by = PREV
						}
						army_size = 20
					}
					amount = 2
				}
				NOT = {
					any_country = {
						NOT = { tag = ROOT }
						FROM = {
							guaranteed_by = PREV
						}
						OR = {
							army_size = 100
							military_strength = { who = ROOT value = 2 }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_STRONG_GUARANTEES
			limit = {
				NOT = { overlord_of = FROM }
				any_country = {
					NOT = { tag = ROOT }
					FROM = {
						guaranteed_by = PREV
					}
					OR = {
						army_size = 100
						military_strength = { who = ROOT value = 2 }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		OR = {
			tag = VEN
			primary_culture = venetian
		}
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_establish_stato_da_mar_vassal_@ROOT }
				had_country_flag = { flag = declined_establish_stato_da_mar_vassal_@ROOT days = 1825 }
			}
			NOT = { is_subject_of = ROOT }
			capital_scope = {
				has_merchant = ROOT
				OR = {
					continent = europe
					continent = africa
					continent = asia
				}
			}
			NOT = {
				any_owned_province = {
					OR = {
						is_core = ROOT
						is_permanent_claim = ROOT
					}
				}
			}
		}
	}
}

ask_to_become_stato_da_mar_vassal = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_to_become_stato_da_mar_vassal_alert_tooltip

	require_acceptance = yes

	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = stato_da_mar_vassal
			}
		}
		OR = {
			is_subject_of = FROM
			NOT = { num_of_cities = 2 }
		}
		capital_scope = {
			NOT = {
				any_trade_node_member_country = {
					is_subject_of_type_with_overlord = {
						who = FROM
						type = stato_da_mar_vassal
					}
				}
			}
		}
		capital_scope = {
			FROM = {
				capital_scope = {
					NOT = { region = PREV_PREV }
				}
			}
		}
	}

	is_allowed = {
		hidden_trigger = {
			OR = {
				is_subject_of = FROM
				NOT = { num_of_cities = 2 }
			}
			capital_scope = {
				NOT = {
					any_trade_node_member_country = {
						is_subject_of_type_with_overlord = {
							who = FROM
							type = stato_da_mar_vassal
						}
					}
				}
			}
			capital_scope = {
				FROM = {
					capital_scope = {
						NOT = { region = PREV_PREV }
					}
				}
			}
		}
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = stato_da_mar_vassal
			}
		}
		capital_scope = { trade_range = FROM }
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		if = {
			limit = {
				is_subject_of = FROM
			}
			NOT = { liberty_desire = 50 }
		}
	}

	on_accept = {
		if = {
			limit = {
				OR = {
					is_subject_of = FROM
					NOT = { num_of_cities = 2 }
				}
				capital_scope = {
					NOT = {
						any_trade_node_member_country = {
							is_subject_of_type_with_overlord = {
								who = FROM
								type = stato_da_mar_vassal
							}
						}
					}
				}
				capital_scope = {
					FROM = {
						capital_scope = {
							NOT = { region = PREV_PREV }
						}
					}
				}
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = stato_da_mar_vassal
					}
				}
				capital_scope = { trade_range = FROM }
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				if = {
					limit = {
						is_subject_of = FROM
					}
					NOT = { liberty_desire = 50 }
				}
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = stato_da_mar_vassal
				}
				add_truce_with = ROOT
			}
		}
	}

	on_decline = {
		if = {
			limit = {
				OR = {
					is_subject_of = FROM
					NOT = { num_of_cities = 2 }
				}
				capital_scope = {
					NOT = {
						any_trade_node_member_country = {
							is_subject_of_type_with_overlord = {
								who = FROM
								type = stato_da_mar_vassal
							}
						}
					}
				}
				capital_scope = {
					FROM = {
						capital_scope = {
							NOT = { region = PREV_PREV }
						}
					}
				}
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = stato_da_mar_vassal
					}
				}
				capital_scope = { trade_range = FROM }
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				if = {
					limit = {
						is_subject_of = FROM
					}
					NOT = { liberty_desire = 50 }
				}
			}
			clr_country_flag = declined_establish_stato_da_mar_vassal_@FROM
			set_country_flag = declined_establish_stato_da_mar_vassal_@FROM
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_stato_da_mar_vassal
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = ROOT_IS_VASSAL_OF_FROM
			limit = {
				is_subject_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				is_subject_of = FROM
				liberty_desire = 50
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -4 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = FROM_ROOT_ARE_RIVALS
			limit = {
				OR = {
					is_rival = FROM
					is_enemy = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			divide_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = STRATEGIC_VALUE
			limit = {
				NOT = {
					AND = {
						FROM = {
							OR = {
								tag = VEN
								primary_culture = venetian
							}
						}
						OR = {
							NOT = { has_country_flag = declined_establish_stato_da_mar_vassal_@FROM }
							had_country_flag = { flag = declined_establish_stato_da_mar_vassal_@FROM days = 1825 }
						}
						NOT = { is_subject_of = FROM }
						capital_scope = {
							has_merchant = FROM
							OR = {
								continent = europe
								continent = africa
								continent = asia
							}
						}
						NOT = {
							any_owned_province = {
								OR = {
									is_core = FROM
									is_permanent_claim = FROM
								}
							}
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		is_subject = no
		NOT = { total_development = 50 }
		NOT = { government_rank = 2 }
		alliance_with = FROM
		religion = FROM
		OR = {
			is_part_of_hre = no
			FROM = {
				is_part_of_hre = yes
			}
		}
		is_elector = no
		is_emperor = no
		NOT = { num_of_subjects = 1 }
		NOT = { has_reform = free_city }
		capital_scope = {
			NOT = {
				trade_share = {
					country = PREV
					share = 30
				}
			}
		}
		FROM = {
			NOT = {
				any_owned_province = {
					is_core = ROOT
				}
			}
		}
		NOT = {
			any_ally = {
				NOT = { tag = FROM }
				OR = {
					army_size = 50
					military_strength = { who = FROM value = 1.5 }
				}
			}
		}
		NOT = {
			any_country = {
				NOT = { tag = FROM }
				ROOT = {
					guaranteed_by = PREV
				}
				OR = {
					army_size = 50
					military_strength = { who = FROM value = 1.5 }
				}
			}
		}
	}
}

enable_stato_da_mar_vassal_seize_merchant_fleets = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = stato_da_mar_vassal
			NOT = { has_country_flag = stato_da_mar_vassal_seize_merchant_fleets }
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = stato_da_mar_vassal
				NOT = { has_country_flag = stato_da_mar_vassal_seize_merchant_fleets }
			}
		}
		FROM = {
			NOT = { liberty_desire = 50 }
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = stato_da_mar_vassal
					NOT = { has_country_flag = stato_da_mar_vassal_seize_merchant_fleets }
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
			}
			FROM = {
				set_country_flag = stato_da_mar_vassal_seize_merchant_fleets
			}
		}
	}

	ai_will_do = {
		FROM = {
			NOT = { liberty_desire = 35 }
		}
	}
}

disable_stato_da_mar_vassal_seize_merchant_fleets = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = stato_da_mar_vassal
			has_country_flag = stato_da_mar_vassal_seize_merchant_fleets
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = stato_da_mar_vassal
				has_country_flag = stato_da_mar_vassal_seize_merchant_fleets
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = stato_da_mar_vassal
					has_country_flag = stato_da_mar_vassal_seize_merchant_fleets
				}
			}
			FROM = {
				clr_country_flag = stato_da_mar_vassal_seize_merchant_fleets
			}
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 55
		}
	}
}

#subjects_expanded_diplomatic_actions_trade_outpost
establish_trade_outpost = {
	category = influence

	alert_index = 6
	alert_tooltip = establish_trade_outpost_alert_tooltip

	require_acceptance = yes

	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = trade_outpost
		}
	}

	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = trade_outpost
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = {
			capital_scope = { trade_range = ROOT }
		}
	}

	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = trade_outpost
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
			}
			create_subject = {
				subject = FROM
				subject_type = trade_outpost
			}
			add_truce_with = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = trade_outpost
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
			}
			FROM = {
				clr_country_flag = declined_establish_trade_outpost_@ROOT
				set_country_flag = declined_establish_trade_outpost_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_trade_outpost_opinion
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = NUM_OF_TRADE_OUTPOSTS
			limit = {
				has_subject_of_type = trade_outpost
				NOT = {
					calc_true_if = {
						all_subject_country = {
							is_subject_of_type = trade_outpost
						}
						amount = 2
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_TRADE_OUTPOSTS
			limit = {
				calc_true_if = {
					all_subject_country = {
						is_subject_of_type = trade_outpost
					}
					amount = 2
				}
				NOT = {
					calc_true_if = {
						all_subject_country = {
							is_subject_of_type = trade_outpost
						}
						amount = 3
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_TRADE_OUTPOSTS
			limit = {
				calc_true_if = {
					all_subject_country = {
						is_subject_of_type = trade_outpost
					}
					amount = 3
				}
				NOT = {
					calc_true_if = {
						all_subject_country = {
							is_subject_of_type = trade_outpost
						}
						amount = 4
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_TRADE_OUTPOSTS
			limit = {
				calc_true_if = {
					all_subject_country = {
						is_subject_of_type = trade_outpost
					}
					amount = 4
				}
				NOT = {
					calc_true_if = {
						all_subject_country = {
							is_subject_of_type = trade_outpost
						}
						amount = 5
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_TRADE_OUTPOSTS
			limit = {
				calc_true_if = {
					all_subject_country = {
						is_subject_of_type = trade_outpost
					}
					amount = 5
				}
				NOT = {
					calc_true_if = {
						all_subject_country = {
							is_subject_of_type = trade_outpost
						}
						amount = 6
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_TRADE_OUTPOSTS
			limit = {
				calc_true_if = {
					all_subject_country = {
						is_subject_of_type = trade_outpost
					}
					amount = 6
				}
				NOT = {
					calc_true_if = {
						all_subject_country = {
							is_subject_of_type = trade_outpost
						}
						amount = 7
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_TRADE_OUTPOSTS
			limit = {
				calc_true_if = {
					all_subject_country = {
						is_subject_of_type = trade_outpost
					}
					amount = 7
				}
				NOT = {
					calc_true_if = {
						all_subject_country = {
							is_subject_of_type = trade_outpost
						}
						amount = 8
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 70
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_TRADE_OUTPOSTS
			limit = {
				calc_true_if = {
					all_subject_country = {
						is_subject_of_type = trade_outpost
					}
					amount = 8
				}
				NOT = {
					calc_true_if = {
						all_subject_country = {
							is_subject_of_type = trade_outpost
						}
						amount = 9
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 80
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_TRADE_OUTPOSTS
			limit = {
				calc_true_if = {
					all_subject_country = {
						is_subject_of_type = trade_outpost
					}
					amount = 9
				}
				NOT = {
					calc_true_if = {
						all_subject_country = {
							is_subject_of_type = trade_outpost
						}
						amount = 10
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_TRADE_OUTPOSTS
			limit = {
				calc_true_if = {
					all_subject_country = {
						is_subject_of_type = trade_outpost
					}
					amount = 10
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				NOT = { overlord_of = FROM }
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				NOT = { overlord_of = FROM }
				any_country = {
					is_subject_of = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			multiply_variable = { which = ai_value value = -0.5 }
		}
		add_entry = {
			name = FROM_IS_KINGDOM_RANK
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					government_rank = 2
					NOT = { government_rank = 3 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_EMPIRE_RANK
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					government_rank = 3
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				NOT = { overlord_of = FROM }
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				NOT = { overlord_of = FROM }
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					historical_friend_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_RIVALS
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					historical_rival_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_AI_PERSONALITY
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					personality = ai_militarist
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_AI_PERSONALITY
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					personality = ai_capitalist
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_IS_VASSAL_OF_ROOT
			limit = {
				overlord_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				overlord_of = FROM
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		OR = {
			NOT = { overlord_of = FROM }
			FROM = {
				NOT = {
					years_in_vassalage_under = {
						who = ROOT
						years = 5
						all_subject_country = yes
					}
				}
			}
		}
		FROM = {
			NOT = { total_development = 100 }
			OR = {
				NOT = { has_country_flag = declined_establish_trade_outpost_@ROOT }
				had_country_flag = { flag = declined_establish_trade_outpost_@ROOT days = 1825 }
			}
			capital_scope = {
				has_merchant = ROOT
			}
		}
		OR = {
			AND = {
				NOT = { has_dlc = "Wealth of Nations" }
				NOT = { has_dlc = "Dharma" }
			}
			FROM = {
				capital_scope = {
					NOT = { superregion = india_superregion }
					NOT = { superregion = china_superregion }
					NOT = { region = japan_region }
					NOT = { continent = oceania }
					NOT = { superregion = east_indies_superregion }
					NOT = { continent = africa }
				}
			}
		}
	}
}

ask_to_become_trade_outpost = {
	category = influence

	alert_index = 6
	alert_tooltip = ask_to_become_trade_outpost_alert_tooltip

	require_acceptance = yes

	is_visible = {
		is_subject = no
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = trade_outpost
			}
		}
	}

	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = trade_outpost
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		capital_scope = { trade_range = FROM }
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = trade_outpost
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
				capital_scope = { trade_range = FROM }
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = trade_outpost
				}
			}
			add_truce_with = FROM
		}
	}

	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = trade_outpost
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
				capital_scope = { trade_range = FROM }
			}
			clr_country_flag = declined_establish_trade_outpost_@FROM
			set_country_flag = declined_establish_trade_outpost_@FROM
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_trade_outpost
			}
		}
	}

	ai_acceptance = {
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			multiply_variable = { which = ai_value value = -0.5 }
		}
		add_entry = {
			name = FROM_DEVELOPMENT
			export_to_variable = {
				which = ai_value
				value = trigger_value:total_development
				who = FROM
			}
			#subtract_variable = { which = ai_value value = 1 }
			divide_variable = { which = ai_value value = -3 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ARE_ALLIED
			limit = {
				alliance_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 15
			}
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_FRIENDS
			limit = {
				FROM = {
					historical_friend_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = ROOT_FROM_ARE_HISTORICAL_RIVALS
			limit = {
				FROM = {
					historical_rival_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_AI_PERSONALITY
			limit = {
				FROM = {
					personality = ai_militarist
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_AI_PERSONALITY
			limit = {
				FROM = {
					personality = ai_capitalist
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = STATEGIC_VALUE
			limit = {
				NOT = {
					OR = {
						FROM = {
							NOT = { overlord_of = ROOT }
						}
						NOT = {
							years_in_vassalage_under = {
								who = FROM
								years = 5
								all_subject_country = yes
							}
						}
					}
					NOT = { total_development = 100 }
					OR = {
						AND = {
							NOT = { has_dlc = "Wealth of Nations" }
							NOT = { has_dlc = "Dharma" }
						}
						capital_scope = {
							NOT = { superregion = india_superregion }
							NOT = { superregion = china_superregion }
							NOT = { region = japan_region }
							NOT = { continent = oceania }
							NOT = { superregion = east_indies_superregion }
							NOT = { continent = africa }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_NO_MERCHANT_IN_OUR_HOME_TRADE_NODE
			limit = {
				capital_scope = {
					NOT = { has_merchant = FROM }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}

	ai_will_do = {
		NOT = { num_of_subjects = 1 }
		OR = {
			NOT = { has_country_flag = declined_establish_trade_outpost_@FROM }
			had_country_flag = { flag = declined_establish_trade_outpost_@FROM days = 1825 }
		}
		FROM = {
			OR = {
				is_great_power = yes
				total_development = 300
			}
		}
		OR = {
			AND = {
				government = monarchy
				FROM = { government = monarchy }
			}
			AND = {
				government = republic
				FROM = { government = republic }
			}
			AND = {
				government = theocracy
				FROM = { government = theocracy }
			}
		}
		has_opinion = {
			who = FROM
			value = 100
		}
	}
}

improve_trade_outpost = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = trade_outpost
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = trade_outpost
			}
		}
		is_at_war = no
		treasury = 500
		adm_power = 25
		dip_power = 50
		FROM = { is_at_war = no }
		FROM = {
			NOT = { liberty_desire = 75 }
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_IMPROVE_TRADE_OUTPOST_WITHIN_LAST_5_YEARS
				OR = {
					NOT = { has_country_flag = improved_trade_outpost_flag }
					had_country_flag = { flag = improved_trade_outpost_flag days = 1825 }
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = trade_outpost
				}
				is_at_war = no
				treasury = 500
				adm_power = 25
				dip_power = 50
				FROM = { is_at_war = no }
				FROM = {
					NOT = { liberty_desire = 75 }
				}
				FROM = {
					custom_trigger_tooltip = {
						tooltip = DID_NOT_IMPROVE_TRADE_OUTPOST_WITHIN_LAST_5_YEARS
						NOT = { has_country_modifier = improved_trade_outpost_modifier }
					}
				}
			}
			add_treasury = -500
			add_adm_power = -25
			add_dip_power = -50
			FROM = {
				add_liberty_desire = -10
				add_country_modifier = {
					name = improved_trade_outpost_modifier
					duration = 730
				}
				capital_scope = {
					add_base_tax = 2
					add_base_production = 4
					add_trade_modifier = {
						who = ROOT
						power = 10
						key = improved_trade_outpost_trade_modifier
						duration = 730
					}
				}
				clr_country_flag = improved_trade_outpost_flag
				set_country_flag = improved_trade_outpost_flag
			}
		}
	}

	ai_will_do = {
		treasury = 2000
		adm_power = 100
		dip_power = 100
		FROM = {
			NOT = { liberty_desire = 40 }
			capital_scope = {
				has_merchant = ROOT
			}
		}
		NOT = {
			calc_true_if = {
				all_subject_country = {
					is_subject_of_type = trade_outpost
					has_country_modifier = improved_trade_outpost_modifier
				}
				amount = 3
			}
		}
	}
}

end_trade_outpost = {
	category = influence

	require_acceptance = no

	is_visible = {
		is_subject_of = FROM
		is_subject_of_type = trade_outpost
	}

	is_allowed = {
		is_subject_of = FROM
		is_subject_of_type = trade_outpost
		NOT = { truce_with = FROM }
		is_at_war = no
	}

	on_accept = {
		if = {
			limit = {
				is_subject_of = FROM
				is_subject_of_type = trade_outpost
				NOT = { truce_with = FROM }
				is_at_war = no
			}
			FROM = {
				ROOT = { grant_independence = yes }
				country_event = { id = subjects_expanded_trade_outpost_events.4 }
			}
			add_stability = -1
		}
	}

	ai_will_do = {
		liberty_desire = 70
	}
}

cancel_trade_outpost = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = trade_outpost
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = trade_outpost
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = trade_outpost
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}

	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 25
				all_subject_country = yes
			}
		}
	}
}

#subjects_expanded_diplomatic_actions_viking_settlement
viking_settlement_demand_raid_loot = {
	category = influence

	require_acceptance = no

	is_visible = {
		can_be_overlord = viking_settlement
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = viking_settlement
		}
	}

	is_allowed = {
		hidden_trigger = {
			can_be_overlord = viking_settlement
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = viking_settlement
				NOT = { has_country_flag = viking_settlement_demanding_raid_loot }
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = { years_of_income = 0.5 }
		FROM = { sailors_percentage = 0.1 }
		FROM = {
			has_opinion = {
				who = ROOT
				value = 0
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				can_be_overlord = viking_settlement
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = viking_settlement
					NOT = { has_country_flag = viking_settlement_demanding_raid_loot }
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = { years_of_income = 0.5 }
				FROM = { sailors_percentage = 0.1 }
				FROM = {
					has_opinion = {
						who = ROOT
						value = 0
					}
				}
			}
			FROM = {
				country_event = { id = subjects_expanded_viking_settlement_events.4 }
			}
		}
	}

	ai_will_do = {
		NOT = { had_recent_war = 2 }
		OR = {
			AND = {
				NOT = { treasury = 10000 }
				NOT = { years_of_income = 2 }
			}
			NOT = { sailors_percentage = 0.1 }
		}
		FROM = {
			has_opinion = {
				who = ROOT
				value = 50
			}
			years_of_income = 1
			sailors_percentage = 0.2
			NOT = { liberty_desire = 30 }
		}
	}
}

#subjects_expanded_diplomatic_actions_voivodeship
establish_voivodeship = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = voivodeship
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = voivodeship
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = voivodeship
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			create_subject = {
				subject = FROM
				subject_type = voivodeship
			}
			if = {
				limit = {
					NOT = {
						OR = {
							culture_group = FROM
							accepted_culture = FROM
							FROM = {
								accepted_culture = ROOT
							}
						}
					}
				}
				add_stability = -1
				add_prestige = -10
			}
		}
	}
	
	ai_will_do = {
		is_emperor = no
		OR = {
			culture_group = FROM
			accepted_culture = FROM
			FROM = {
				accepted_culture = ROOT
			}
		}
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
	}
}

cancel_voivodeship = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = voivodeship
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = voivodeship
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = voivodeship
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}
	
	ai_will_do = {
		FROM = {
			liberty_desire = 100
			years_in_vassalage_under = {
				who = ROOT
				years = 25
				all_subject_country = yes
			}
		}
	}
}

#zzz_subjects_expanded_diplomatic_actions
disallow_subject_from_annexing_subjects = {
	category = influence

	require_acceptance = no

	is_visible = {
		ai = no
		FROM = {
			is_subject_of = ROOT
			NOT = { is_tributary_or_similar_subject = yes }
			num_of_subjects = 1
			NOT = { has_country_modifier = disallow_subject_from_annexing_subjects_modifier }
		}
	}

	is_allowed = {
		hidden_trigger = {
			ai = no
			FROM = {
				is_subject_of = ROOT
				NOT = { is_tributary_or_similar_subject = yes }
				num_of_subjects = 1
				NOT = { has_country_modifier = disallow_subject_from_annexing_subjects_modifier }
			}
		}
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		FROM = {
			has_opinion = {
				who = ROOT
				value = 50
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				ai = no
				FROM = {
					is_subject_of = ROOT
					NOT = { is_tributary_or_similar_subject = yes }
					num_of_subjects = 1
					NOT = { has_country_modifier = disallow_subject_from_annexing_subjects_modifier }
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 50
					}
				}
			}
			FROM = {
				add_liberty_desire = 20
				add_country_modifier = {
					name = disallow_subject_from_annexing_subjects_modifier
					duration = 7300
				}
				country_event = { id = subjects_expanded_general_events.1 }
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

transfer_vassal_to_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = transfer_vassal_to_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		ai = no
		is_free_or_tributary_trigger = yes
		NOT = { has_country_flag = uses_transfer_vassal_to_subject }
		FROM = {
			is_subject_of = ROOT
			NOT = { is_tributary_or_similar_subject = yes }
			is_subject_type_that_can_have_subjects = yes
		}
		any_subject_country = {
			NOT = { tag = FROM }
			is_neighbor_of = FROM
			OR = {
				is_subject_of_type = vassal
				is_subject_of_type = client_vassal
				is_subject_of_type = march
				is_subject_of_type = client_march
				is_subject_of_type = naval_march
				is_subject_of_type = defensive_march
				is_subject_of_type = agricultural_march
				is_subject_of_type = religious_march
			}
		}
	}

	is_allowed = {
		hidden_trigger = {
			ai = no
			is_free_or_tributary_trigger = yes
			NOT = { has_country_flag = uses_transfer_vassal_to_subject }
			FROM = {
				is_subject_of = ROOT
				NOT = { is_tributary_or_similar_subject = yes }
				is_subject_type_that_can_have_subjects = yes
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		any_subject_country = {
			NOT = { tag = FROM }
			is_neighbor_of = FROM
			OR = {
				is_subject_of_type = vassal
				is_subject_of_type = client_vassal
				is_subject_of_type = march
				is_subject_of_type = client_march
				is_subject_of_type = naval_march
				is_subject_of_type = defensive_march
				is_subject_of_type = agricultural_march
				is_subject_of_type = religious_march
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				ai = no
				is_free_or_tributary_trigger = yes
				NOT = { has_country_flag = uses_transfer_vassal_to_subject }
				FROM = {
					is_subject_of = ROOT
					NOT = { is_tributary_or_similar_subject = yes }
					is_subject_type_that_can_have_subjects = yes
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				any_subject_country = {
					NOT = { tag = FROM }
					is_neighbor_of = FROM
					OR = {
						is_subject_of_type = vassal
						is_subject_of_type = client_vassal
						is_subject_of_type = march
						is_subject_of_type = client_march
						is_subject_of_type = naval_march
						is_subject_of_type = defensive_march
						is_subject_of_type = agricultural_march
						is_subject_of_type = religious_march
					}
				}
			}
			FROM = {
				save_event_target_as = transfer_to_subject_target_overlord_target
			}
			set_country_flag = uses_transfer_vassal_to_subject
			country_event = { id = subjects_expanded_general_events.2 }
		}
	}

	on_decline = {
	}

	ai_acceptance = {
		add_entry = {
			name = SE_REASON_BASE_VALUE
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

release_subject_from_subject = {
	category = influence

	alert_index = 6
	alert_tooltip = release_subject_from_subject_alert_tooltip

	require_acceptance = yes

	is_visible = {
		ai = no
		is_free_or_tributary_trigger = yes
		NOT = { has_country_flag = uses_release_subject_from_subject }
		FROM = {
			is_subject_of = ROOT
			NOT = { is_tributary_or_similar_subject = yes }
			is_subject_type_that_can_have_subjects = yes
			any_subject_country = {
				OR = {
					is_subject_of_type = tributary_state
					is_subject_of_type = protectorate
					is_subject_of_type = imperial_tributary_state
					is_subject_of_type = papal_sanctuary_subject
					is_subject_of_type = imperial_feud_subject
					is_subject_of_type = trade_outpost
				}
			}
		}
	}

	is_allowed = {
		hidden_trigger = {
			ai = no
			is_free_or_tributary_trigger = yes
			NOT = { has_country_flag = uses_release_subject_from_subject }
			FROM = {
				is_subject_of = ROOT
				NOT = { is_tributary_or_similar_subject = yes }
				is_subject_type_that_can_have_subjects = yes
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		FROM = {
			any_subject_country = {
				OR = {
					is_subject_of_type = tributary_state
					is_subject_of_type = protectorate
					is_subject_of_type = imperial_tributary_state
					is_subject_of_type = papal_sanctuary_subject
					is_subject_of_type = imperial_feud_subject
					is_subject_of_type = trade_outpost
				}
			}
		}
	}

	on_accept = {
		if = {
			limit = {
				ai = no
				is_free_or_tributary_trigger = yes
				NOT = { has_country_flag = uses_release_subject_from_subject }
				FROM = {
					is_subject_of = ROOT
					NOT = { is_tributary_or_similar_subject = yes }
					is_subject_type_that_can_have_subjects = yes
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					any_subject_country = {
						OR = {
							is_subject_of_type = tributary_state
							is_subject_of_type = protectorate
							is_subject_of_type = imperial_tributary_state
							is_subject_of_type = papal_sanctuary_subject
							is_subject_of_type = imperial_feud_subject
							is_subject_of_type = trade_outpost
						}
					}
				}
			}
			FROM = {
				save_event_target_as = subject_to_force_release_subject_target
			}
			set_country_flag = uses_release_subject_from_subject
			country_event = { id = subjects_expanded_general_events.5 }
		}
	}

	on_decline = {
	}

	ai_acceptance = {
		add_entry = {
			name = SE_REASON_BASE_VALUE
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

return_subject_to_vassal = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			NOT = { is_subject_of_type = daimyo_vassal }
			OR = {
				is_similar_vassal_subject = yes
				AND = {
					is_similar_march_subject = yes
					NOT = { is_different_march_subject = yes }
				}
			}
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				NOT = { is_subject_of_type = daimyo_vassal }
				OR = {
					is_similar_vassal_subject = yes
					AND = {
						is_similar_march_subject = yes
						NOT = { is_different_march_subject = yes }
					}
				}
			}
		}
		prestige = 0
		if = {
			limit = {
				OR = {
					NOT = { religion = nahuatl }
					is_religion_reformed = yes
				}
				FROM = {
					is_subject_of_type = nahuatl_vassal
				}
			}
			FROM = {
				NOT = { liberty_desire = 90 }
			}
		}
		else = {
			FROM = {
				NOT = { liberty_desire = 50 }
			}
		}
		FROM = {
			has_opinion = {
				who = ROOT
				value = 100
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					NOT = { is_subject_of_type = daimyo_vassal }
					OR = {
						is_similar_vassal_subject = yes
						AND = {
							is_similar_march_subject = yes
							NOT = { is_different_march_subject = yes }
						}
					}
				}
				prestige = 0
				if = {
					limit = {
						OR = {
							NOT = { religion = nahuatl }
							is_religion_reformed = yes
						}
						FROM = {
							is_subject_of_type = nahuatl_vassal
						}
					}
					FROM = {
						NOT = { liberty_desire = 90 }
					}
				}
				else = {
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 100
					}
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
			}
			FROM = {
				add_opinion = {
					who = ROOT
					modifier = returned_to_vassal
				}
				grant_independence = yes
			}
			vassalize = FROM
			add_prestige = -10
			FROM = {
				add_liberty_desire = 25
			}
		}
	}

	ai_will_do = {
		NOT = { truce_with = FROM }
		OR = {
			AND = {
				OR = {
					is_year = 1700
					current_age = age_of_absolutism
					NOT = { religion = catholic }
				}
				FROM = {
					OR = {
						ROOT = { NOT = { religion = catholic } }
						NOT = { liberty_desire = 33 }
					}
					is_subject_of_type = crusader_state_vassal
				}
			}
			AND = {
				OR = {
					NOT = { religion = nahuatl }
					is_religion_reformed = yes
				}
				FROM = {
					is_subject_of_type = nahuatl_vassal
				}
			}
			AND = {
				europe = {
					type = all
					country_or_non_sovereign_subject_holds = ROOT
				}
				FROM = {
					is_subject_of_type = muslim_tributary_vassal
				}
			}
			FROM = {
				is_subject_of_type = pagan_chiefdom
				OR = {
					AND = {
						liberty_desire = 70
						years_in_vassalage_under = {
							who = ROOT
							years = 5
							all_subject_country = yes
						}
					}
					NOT = {
						any_neighbor_country = {
							is_subject = no
							NOT = { tag = ROOT }
							OR = {
								is_great_power = yes
								total_development = 300
								is_rival = ROOT
								is_enemy = ROOT
							}
						}
					}
				}
			}
			FROM = {
				is_subject_of_type = palatinate_vassal
				is_elector = no
			}
			FROM = {
				is_lesser_in_union = no
				liberty_desire = 100
				years_in_vassalage_under = {
					who = ROOT
					years = 25
					all_subject_country = yes
				}
			}
			FROM = {
				is_lesser_in_union = yes
				liberty_desire = 100
				years_in_vassalage_under = {
					who = ROOT
					years = 60
					all_subject_country = yes
				}
			}
		}
	}
}

make_custom_march_subject_to_march = {
	category = influence

	require_acceptance = no

	is_visible = {
		ai = no
		FROM = {
			is_subject_of = ROOT
			is_different_march_subject = yes
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_different_march_subject = yes
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_different_march_subject = yes
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
			}
			FROM = {
				grant_independence = yes
			}
			create_subject = {
				subject = FROM
				subject_type = march
			}
		}
	}

	ai_will_do = {
		always = no
	}
}

revoke_custom_march_subject = {
	category = influence

	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_different_march_subject = yes
		}
	}

	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_different_march_subject = yes
			}
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
	}

	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_different_march_subject = yes
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
			}
			if = {
				limit = {
					NOT = { full_idea_group = diplomatic_ideas }
				}
				add_stability = -1
			}
			FROM = {
				add_opinion = {
					who = ROOT
					modifier = broke_march
				}
				grant_independence = yes
			}
			vassalize = FROM
		}
	}

	ai_will_do = {
		NOT = { truce_with = FROM }
		FROM = {
			OR = {
				development_of_overlord_fraction = 0.3
				num_of_owned_provinces_with = {
					value = 10
					is_permanent_claim = ROOT
				}
				AND = {
					liberty_desire = 100
					years_in_vassalage_under = {
						who = ROOT
						years = 25
						all_subject_country = yes
					}
				}
				NOT = {
					any_neighbor_country = {
						is_subject = no
						NOT = { tag = ROOT }
						OR = {
							is_great_power = yes
							total_development = 300
							is_rival = ROOT
							is_enemy = ROOT
							army_strength = { who = ROOT value = 2.5 }
						}
					}
				}
				AND = {
					is_subject_of_type = religious_march
					religious_unity = 0.95
				}
			}
		}
	}
}