#_subjects_expanded_annexable_colony_scripted_effects
set_disabled_colonial_nation_spawning_for_region = {
	set_country_flag = no_colonial_nations_in_$colonial_region$
}

unset_disabled_colonial_nation_spawning_for_region = {
	custom_tooltip = UNSET_DISABLED_COLONIAL_NATION_SPAWNING_FOR_REGION_TT
	clr_country_flag = no_colonial_nations_in_$colonial_region$
}

set_disabled_colonial_nation_spawning_for_region_for_overlord = {
	if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_alaska
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_alaska
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_canada
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_canada
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_eastern_america
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_eastern_america
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_louisiana
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_louisiana
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_california
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_california
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_mexico
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_mexico
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_the_carribean
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_the_carribean
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_colombia
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_colombia
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_peru
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_peru
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_la_plata
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_la_plata
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_brazil
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_brazil
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_australia
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_australia
			}
		}
	}
	# Extended Timeline:
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_papua
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_papua
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_solomons
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_solomons
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_vanuatu
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_vanuatu
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_new_caledonia
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_new_caledonia
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_fiji
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_fiji
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_polynesia
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_polynesia
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_cape
			}
		}
		overlord = {
			set_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_cape
			}
		}
	}
}

unset_disabled_colonial_nation_spawning_for_region_for_overlord = {
	if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_alaska
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_alaska
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_canada
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_canada
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_eastern_america
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_eastern_america
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_louisiana
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_louisiana
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_california
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_california
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_mexico
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_mexico
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_the_carribean
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_the_carribean
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_colombia
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_colombia
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_peru
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_peru
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_la_plata
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_la_plata
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_brazil
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_brazil
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_australia
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_australia
			}
		}
	}
	# Extended Timeline:
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_papua
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_papua
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_solomons
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_solomons
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_vanuatu
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_vanuatu
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_new_caledonia
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_new_caledonia
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_fiji
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_fiji
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_polynesia
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_polynesia
			}
		}
	}
	else_if = {
		limit = {
			capital_scope = {
				colonial_region = colonial_cape
			}
		}
		overlord = {
			unset_disabled_colonial_nation_spawning_for_region = {
				colonial_region = colonial_cape
			}
		}
	}
}

#_subjects_expanded_dutch_provinces_scripted_effects
AI_dutch_province_select_elected_overlord = {
	every_country = {
		limit = {
			has_country_flag = elected_as_dutch_province_overlord_by_@ROOT
		}
		clr_country_flag = elected_as_dutch_province_overlord_by_@ROOT
	}
	every_country = {
		limit = {
			OR = {
				has_country_flag = election_value_of_dutch_province_1_@ROOT
				has_country_flag = election_value_of_dutch_province_2_@ROOT
				has_country_flag = election_value_of_dutch_province_3_@ROOT
				has_country_flag = election_value_of_dutch_province_4_@ROOT
				has_country_flag = election_value_of_dutch_province_5_@ROOT
				has_country_flag = election_value_of_dutch_province_6_@ROOT
			}
		}
		clr_country_flag = election_value_of_dutch_province_1_@ROOT
		clr_country_flag = election_value_of_dutch_province_2_@ROOT
		clr_country_flag = election_value_of_dutch_province_3_@ROOT
		clr_country_flag = election_value_of_dutch_province_4_@ROOT
		clr_country_flag = election_value_of_dutch_province_5_@ROOT
		clr_country_flag = election_value_of_dutch_province_6_@ROOT
	}
	if = {
		limit = {
			has_subject_of_type = dutch_province_subject
		}
		set_country_flag = election_value_of_dutch_province_1_@ROOT
		random_subject_country = {
			limit = {
				is_subject_of_type = dutch_province_subject
				NOT = { has_country_flag = election_value_of_dutch_province_1_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_2_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_3_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_4_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_5_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_6_@ROOT }
			}
			set_country_flag = election_value_of_dutch_province_2_@ROOT
		}
		random_subject_country = {
			limit = {
				is_subject_of_type = dutch_province_subject
				NOT = { has_country_flag = election_value_of_dutch_province_1_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_2_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_3_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_4_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_5_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_6_@ROOT }
			}
			set_country_flag = election_value_of_dutch_province_3_@ROOT
		}
		random_subject_country = {
			limit = {
				is_subject_of_type = dutch_province_subject
				NOT = { has_country_flag = election_value_of_dutch_province_1_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_2_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_3_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_4_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_5_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_6_@ROOT }
			}
			set_country_flag = election_value_of_dutch_province_4_@ROOT
		}
		random_subject_country = {
			limit = {
				is_subject_of_type = dutch_province_subject
				NOT = { has_country_flag = election_value_of_dutch_province_1_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_2_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_3_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_4_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_5_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_6_@ROOT }
			}
			set_country_flag = election_value_of_dutch_province_5_@ROOT
		}
		random_subject_country = {
			limit = {
				is_subject_of_type = dutch_province_subject
				NOT = { has_country_flag = election_value_of_dutch_province_1_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_2_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_3_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_4_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_5_@ROOT }
				NOT = { has_country_flag = election_value_of_dutch_province_6_@ROOT }
			}
			set_country_flag = election_value_of_dutch_province_6_@ROOT
		}
	}
	else = {
		overlord = {
			set_country_flag = election_value_of_dutch_province_1_@ROOT
			random_subject_country = {
				limit = {
					is_subject_of_type = dutch_province_subject
					NOT = { has_country_flag = election_value_of_dutch_province_1_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_2_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_3_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_4_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_5_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_6_@ROOT }
				}
				set_country_flag = election_value_of_dutch_province_2_@ROOT
			}
			random_subject_country = {
				limit = {
					is_subject_of_type = dutch_province_subject
					NOT = { has_country_flag = election_value_of_dutch_province_1_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_2_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_3_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_4_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_5_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_6_@ROOT }
				}
				set_country_flag = election_value_of_dutch_province_3_@ROOT
			}
			random_subject_country = {
				limit = {
					is_subject_of_type = dutch_province_subject
					NOT = { has_country_flag = election_value_of_dutch_province_1_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_2_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_3_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_4_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_5_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_6_@ROOT }
				}
				set_country_flag = election_value_of_dutch_province_4_@ROOT
			}
			random_subject_country = {
				limit = {
					is_subject_of_type = dutch_province_subject
					NOT = { has_country_flag = election_value_of_dutch_province_1_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_2_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_3_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_4_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_5_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_6_@ROOT }
				}
				set_country_flag = election_value_of_dutch_province_5_@ROOT
			}
			random_subject_country = {
				limit = {
					is_subject_of_type = dutch_province_subject
					NOT = { has_country_flag = election_value_of_dutch_province_1_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_2_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_3_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_4_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_5_@ROOT }
					NOT = { has_country_flag = election_value_of_dutch_province_6_@ROOT }
				}
				set_country_flag = election_value_of_dutch_province_6_@ROOT
			}
		}
	}

	set_dutch_province_value_for_target = { target = 1 }
	set_dutch_province_value_for_target = { target = 2 }
	set_dutch_province_value_for_target = { target = 3 }
	set_dutch_province_value_for_target = { target = 4 }
	set_dutch_province_value_for_target = { target = 5 }
	set_dutch_province_value_for_target = { target = 6 }

	select_dutch_province_country_to_vote_for = yes
}

set_dutch_province_value_for_target = {
	# Marriage: +10
	# Same Dynasty: +20
	# One Province Minor: -50
	# Between 10 and 20 Provinces: +25
	# More than 20 Provinces: +50
	# Same Culture: +10
	# Different Culture: -10
	# Same Religion: +15
	# Different Religion: -30
	# Different Religion Group: -100
	# Prestige: Amount / 2 (-50 to + 50)
	# Legitimcay: Amount - 50 (-50 to +50)
	# Diplomatic Reputation: Amount * 5
	# Corruption: Amount * -5
	# Allied to Rival: -25
	# Overextension: -5 (50%), -10 (100%), -15 (125%), -20 (150%)
	# Stability: Amount * 10
	# Neighbors: +5
	# Has any Disaster: -100
	# Opinion: Amount / 4
	# Power Projection: Amount / 4
	# Is subject and LD over 50: -1000
	# Is subject and LD under 50: +5
	# Is overlord themselves: +25

	set_variable = { which = election_value_of_dutch_province_$target$ value = 0 }
	every_country = {
		limit = {
			has_country_flag = election_value_of_dutch_province_$target$_@ROOT
		}
		ROOT = {
			# Marriage
			if = {
				limit = {
					marriage_with = PREV
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 10 }
			}
			# Same Dynasty
			if = {
				limit = {
					NOT = { tag = PREV }
					dynasty = PREV
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 20 }
			}
			# One Province Minor
			if = {
				limit = {
					PREV = {
						NOT = { num_of_cities = 2 }
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -50 }
			}
			# Between 10 and 20 Provinces
			if = {
				limit = {
					PREV = {
						num_of_cities = 10
						NOT = { num_of_cities = 20 }
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 25 }
			}
			# More than 20 Provinces
			if = {
				limit = {
					PREV = {
						num_of_cities = 20
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 50 }
			}
			# Same Culture
			if = {
				limit = {
					NOT = { tag = PREV }
					primary_culture = PREV
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 10 }
			}
			# Different Culture
			if = {
				limit = {
					NOT = { primary_culture = PREV }
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -10 }
			}
			# Same Religion
			if = {
				limit = {
					NOT = { tag = PREV }
					religion = PREV
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 15 }
			}
			# Different Religion
			if = {
				limit = {
					NOT = { tag = PREV }
					religion_group = PREV
					NOT = { religion = PREV }
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -30 }
			}
			# Different Religion Group
			if = {
				limit = {
					NOT = { religion_group = PREV }
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -100 }
			}
			# Prestige
			export_to_variable = {
				which = their_prestige
				value = trigger_value:prestige
				who = PREV
			}
			divide_variable = { which = their_prestige value = 2 }
			change_variable = { which = election_value_of_dutch_province_$target$ which = their_prestige }
			set_variable = { which = their_prestige value = 0 }
			# Legitimcay
			export_to_variable = {
				which = their_legitimacy
				value = trigger_value:legitimacy_equivalent
				who = PREV
			}
			subtract_variable = { which = their_legitimacy value = 51 }
			change_variable = { which = election_value_of_dutch_province_$target$ which = their_legitimacy }
			set_variable = { which = their_legitimacy value = 0 }
			# Diplomatic Reputation
			export_to_variable = {
				which = their_diplo_rep
				value = modifier:diplomatic_reputation
				who = PREV
			}
			multiply_variable = { which = their_diplo_rep value = 5 }
			change_variable = { which = election_value_of_dutch_province_$target$ which = their_diplo_rep }
			set_variable = { which = their_diplo_rep value = 0 }
			# Corruption
			export_to_variable = {
				which = their_corruption
				value = trigger_value:corruption
				who = PREV
			}
			if = {
				limit = {
					NOT = { check_variable = { which = their_corruption value = 0 } }
				}
				set_variable = { which = their_corruption value = 0 }
			}
			multiply_variable = { which = their_corruption value = -5 }
			change_variable = { which = election_value_of_dutch_province_$target$ which = their_corruption }
			set_variable = { which = their_corruption value = 0 }
			# Allied to Rival
			if = {
				limit = {
					PREV = {
						any_ally = {
							is_rival = ROOT
						}
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -25 }
			}
			# Overextension
			if = {
				limit = {
					PREV = {
						overextension_percentage = 0.5
						NOT = { overextension_percentage = 1 }
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -5 }
			}
			if = {
				limit = {
					PREV = {
						overextension_percentage = 1
						NOT = { overextension_percentage = 1.25 }
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -10 }
			}
			if = {
				limit = {
					PREV = {
						overextension_percentage = 1.25
						NOT = { overextension_percentage = 1.5 }
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -15 }
			}
			if = {
				limit = {
					PREV = {
						overextension_percentage = 1.5
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -20 }
			}
			# Stability
			if = {
				limit = {
					PREV = {
						NOT = { stability = -2 }
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -30 }
			}
			else_if = {
				limit = {
					PREV = {
						NOT = { stability = -1 }
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -20 }
			}
			else_if = {
				limit = {
					PREV = {
						NOT = { stability = 0 }
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -10 }
			}
			else_if = {
				limit = {
					PREV = {
						stability = 1
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 10 }
			}
			else_if = {
				limit = {
					PREV = {
						stability = 2
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 20 }
			}
			else_if = {
				limit = {
					PREV = {
						stability = 3
					}
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 30 }
			}
			# Neighbors
			if = {
				limit = {
					NOT = { tag = PREV }
					is_neighbor_of = PREV
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 5 }
			}
			# Has any Disaster
			if = {
				limit = {
					has_any_disaster = yes
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -100 }
			}
			# Opinion
			if = {
				limit = {
					NOT = { tag = PREV }
				}
				export_to_variable = {
					which = our_opinion
					value = opinion
					who = ROOT
					with = PREV
				}
				divide_variable = { which = our_opinion value = 4 }
				change_variable = { which = election_value_of_dutch_province_$target$ which = our_opinion }
				set_variable = { which = our_opinion value = 0 }
			}
			# Power Projection
			export_to_variable = {
				which = their_power_projection
				value = trigger_value:power_projection
				who = PREV
			}
			divide_variable = { which = their_power_projection value = 4 }
			change_variable = { which = election_value_of_dutch_province_$target$ which = their_power_projection }
			set_variable = { which = their_power_projection value = 0 }
			# Is subject and LD over 50
			if = {
				limit = {
					is_subject_of = PREV
					liberty_desire = 50
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = -1000 }
			}
			# Is subject and LD under 50
			if = {
				limit = {
					is_subject_of = PREV
					NOT = { liberty_desire = 50 }
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 5 }
			}
			# Is overlord themselves
			if = {
				limit = {
					tag = PREV
					has_subject_of_type = dutch_province_subject
				}
				change_variable = { which = election_value_of_dutch_province_$target$ value = 25 }
			}
		}
	}
	change_variable = { which = election_value_of_dutch_province_$target$ value = 0.5 }
	divide_variable = { which = election_value_of_dutch_province_$target$ value = 1000 }
	multiply_variable = { which = election_value_of_dutch_province_$target$ value = 1000 }
}

select_dutch_province_country_to_vote_for = {
	set_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_1 }
	if = {
		limit = {
			NOT = { check_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_2 } }
		}
		set_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_2 }
	}
	if = {
		limit = {
			NOT = { check_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_3 } }
		}
		set_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_3 }
	}
	if = {
		limit = {
			NOT = { check_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_4 } }
		}
		set_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_4 }
	}
	if = {
		limit = {
			NOT = { check_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_5 } }
		}
		set_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_5 }
	}
	if = {
		limit = {
			NOT = { check_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_6 } }
		}
		set_variable = { which = dutch_province_election_variable which = election_value_of_dutch_province_6 }
	}

	set_variable = { which = dutch_province_dutch_province_election_variable_rival value = 0 }
	if = {
		limit = {
			check_variable = { which = election_value_of_dutch_province_1 which = dutch_province_dutch_province_election_variable_rival }
			NOT = { is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_1 } }
		}
		set_variable = { which = dutch_province_dutch_province_election_variable_rival which = election_value_of_dutch_province_1 }
	}
	if = {
		limit = {
			check_variable = { which = election_value_of_dutch_province_2 which = dutch_province_dutch_province_election_variable_rival }
			NOT = { is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_2 } }
		}
		set_variable = { which = dutch_province_dutch_province_election_variable_rival which = election_value_of_dutch_province_2 }
	}
	if = {
		limit = {
			check_variable = { which = election_value_of_dutch_province_3 which = dutch_province_dutch_province_election_variable_rival }
			NOT = { is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_3 } }
		}
		set_variable = { which = dutch_province_dutch_province_election_variable_rival which = election_value_of_dutch_province_3 }
	}
	if = {
		limit = {
			check_variable = { which = election_value_of_dutch_province_4 which = dutch_province_dutch_province_election_variable_rival }
			NOT = { is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_4 } }
		}
		set_variable = { which = dutch_province_dutch_province_election_variable_rival which = election_value_of_dutch_province_4 }
	}
	if = {
		limit = {
			check_variable = { which = election_value_of_dutch_province_5 which = dutch_province_dutch_province_election_variable_rival }
			NOT = { is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_5 } }
		}
		set_variable = { which = dutch_province_dutch_province_election_variable_rival which = election_value_of_dutch_province_5 }
	}
	if = {
		limit = {
			check_variable = { which = election_value_of_dutch_province_6 which = dutch_province_dutch_province_election_variable_rival }
			NOT = { is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_6 } }
		}
		set_variable = { which = dutch_province_dutch_province_election_variable_rival which = election_value_of_dutch_province_6 }
	}

	if = {
		limit = {
			NOT = { check_variable = { which = dutch_province_election_variable value = 0 } }
		}
		elect_this_as_dutch_province_overlord = yes
	}
	else_if = {
		limit = {
			is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_1 }
		}
		every_country = {
			limit = {
				has_country_flag = election_value_of_dutch_province_1_@ROOT
			}
			elect_this_as_dutch_province_overlord = yes
		}
	}
	else_if = {
		limit = {
			is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_2 }
		}
		every_country = {
			limit = {
				has_country_flag = election_value_of_dutch_province_2_@ROOT
			}
			elect_this_as_dutch_province_overlord = yes
		}
	}
	else_if = {
		limit = {
			is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_3 }
		}
		every_country = {
			limit = {
				has_country_flag = election_value_of_dutch_province_3_@ROOT
			}
			elect_this_as_dutch_province_overlord = yes
		}
	}
	else_if = {
		limit = {
			is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_4 }
		}
		every_country = {
			limit = {
				has_country_flag = election_value_of_dutch_province_4_@ROOT
			}
			elect_this_as_dutch_province_overlord = yes
		}
	}
	else_if = {
		limit = {
			is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_5 }
		}
		every_country = {
			limit = {
				has_country_flag = election_value_of_dutch_province_5_@ROOT
			}
			elect_this_as_dutch_province_overlord = yes
		}
	}
	else_if = {
		limit = {
			is_variable_equal = { which = dutch_province_election_variable which = election_value_of_dutch_province_6 }
		}
		every_country = {
			limit = {
				has_country_flag = election_value_of_dutch_province_6_@ROOT
			}
			elect_this_as_dutch_province_overlord = yes
		}
	}
	else = {
		elect_this_as_dutch_province_overlord = yes
	}
}

elect_this_as_dutch_province_overlord = {
	custom_tooltip = ELECT_THIS_AS_DUTCH_PROVINCE_OVERLORD_TT
	hidden_effect = {
		set_country_flag = elected_as_dutch_province_overlord_by_@ROOT
	}
}

find_new_dutch_province_overlord = {
	set_variable = { which = num_of_dutch_province_votes_for_this value = 0 }
	if = {
		limit = {
			calc_true_if = {
				all_countries_including_self = {
					PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
				}
				amount = 6
			}
		}
		set_variable = { which = num_of_dutch_province_votes_for_this value = 6 }
	}
	else_if = {
		limit = {
			calc_true_if = {
				all_countries_including_self = {
					PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
				}
				amount = 5
			}
		}
		set_variable = { which = num_of_dutch_province_votes_for_this value = 5 }
	}
	else_if = {
		limit = {
			calc_true_if = {
				all_countries_including_self = {
					PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
				}
				amount = 4
			}
		}
		set_variable = { which = num_of_dutch_province_votes_for_this value = 4 }
	}
	else_if = {
		limit = {
			calc_true_if = {
				all_countries_including_self = {
					PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
				}
				amount = 3
			}
		}
		set_variable = { which = num_of_dutch_province_votes_for_this value = 3 }
	}
	else_if = {
		limit = {
			calc_true_if = {
				all_countries_including_self = {
					PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
				}
				amount = 2
			}
		}
		set_variable = { which = num_of_dutch_province_votes_for_this value = 2 }
	}
	else_if = {
		limit = {
			calc_true_if = {
				all_countries_including_self = {
					PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
				}
				amount = 1
			}
		}
		set_variable = { which = num_of_dutch_province_votes_for_this value = 1 }
	}

	every_subject_country = {
		limit = {
			is_subject_of_type = dutch_province_subject
		}
		set_variable = { which = num_of_dutch_province_votes_for_this value = 0 }
		if = {
			limit = {
				calc_true_if = {
					all_countries_including_self = {
						PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
					}
					amount = 6
				}
			}
			set_variable = { which = num_of_dutch_province_votes_for_this value = 6 }
		}
		else_if = {
			limit = {
				calc_true_if = {
					all_countries_including_self = {
						PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
					}
					amount = 5
				}
			}
			set_variable = { which = num_of_dutch_province_votes_for_this value = 5 }
		}
		else_if = {
			limit = {
				calc_true_if = {
					all_countries_including_self = {
						PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
					}
					amount = 4
				}
			}
			set_variable = { which = num_of_dutch_province_votes_for_this value = 4 }
		}
		else_if = {
			limit = {
				calc_true_if = {
					all_countries_including_self = {
						PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
					}
					amount = 3
				}
			}
			set_variable = { which = num_of_dutch_province_votes_for_this value = 3 }
		}
		else_if = {
			limit = {
				calc_true_if = {
					all_countries_including_self = {
						PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
					}
					amount = 2
				}
			}
			set_variable = { which = num_of_dutch_province_votes_for_this value = 2 }
		}
		else_if = {
			limit = {
				calc_true_if = {
					all_countries_including_self = {
						PREV = { has_country_flag = elected_as_dutch_province_overlord_by_@PREV }
					}
					amount = 1
				}
			}
			set_variable = { which = num_of_dutch_province_votes_for_this value = 1 }
		}
	}

	if = {
		limit = {
			num_of_subjects = 1
			all_subject_country = {
				OR = {
					NOT = { is_subject_of_type = dutch_province_subject }
					PREV = {
						check_variable = { which = num_of_dutch_province_votes_for_this which = PREV }
					}
				}
			}
		}
		set_country_flag = new_overlord_of_dutch_provinces
	}
	else_if = {
		limit = {
			any_subject_country = {
				is_subject_of_type = dutch_province_subject
				all_country = {
					OR = {
						NOT = { is_subject_of = ROOT }
						NOT = { is_subject_of_type = dutch_province_subject }
						PREV = {
							check_variable = { which = num_of_dutch_province_votes_for_this which = PREV }
						}
					}
				}
			}
		}
		random_subject_country = {
			limit = {
				is_subject_of_type = dutch_province_subject
				all_country = {
					OR = {
						NOT = { is_subject_of = ROOT }
						NOT = { is_subject_of_type = dutch_province_subject }
						PREV = {
							check_variable = { which = num_of_dutch_province_votes_for_this which = PREV }
						}
					}
				}
			}
			set_country_flag = new_overlord_of_dutch_provinces
		}
	}
	else = {
		set_country_flag = new_overlord_of_dutch_provinces
	}
}

make_new_overlord_of_dutch_provinces = {
	ROOT = {
		PREV = { grant_independence = yes }
		every_subject_country = {
			limit = {
				NOT = { tag = PREV }
				NOT = { tag = ROOT }
				is_subject_of_type = dutch_province_subject
			}
			set_country_flag = dutch_province_get_passed_to_new_overlord
			ROOT = {
				PREV = { grant_independence = yes }
			}
		}
	}
	every_country = {
		limit = {
			has_country_flag = dutch_province_get_passed_to_new_overlord
		}
		clr_country_flag = dutch_province_get_passed_to_new_overlord
		PREV = {
			create_subject = {
				subject = PREV
				subject_type = dutch_province_subject
			}
		}
	}
	create_subject = {
		subject = ROOT
		subject_type = dutch_province_subject
	}
	add_country_modifier = {
		name = cooldown_dutch_provinces_election
		duration = 50
		hidden = yes
	}
}

#_subjects_expanded_integrated_personal_union_scripted_effects
random_chance_to_annex_integrated_personal_union = {
	random = {
		chance = $chance$
		overlord = {
			country_event = { id = subjects_expanded_integrated_personal_union_events.2 }
		}
	}
}

#_subjects_expanded_trade_outpost_scripted_effects
set_selected_trade_outpost_region_or_area = {
	hidden_effect = {
		set_country_flag = is_releasing_trade_outpost
		[[area]
			if = {
				limit = {
					always = $area$
				}
				set_country_flag = selected_trade_outpost_area_$name$
			}
		]
		[[region]
			if = {
				limit = {
					always = $region$
				}
				set_country_flag = selected_trade_outpost_region_$name$
			}
		]
	}
}

clear_selected_trade_outpost_region_or_area = {
	if = {
		limit = {
			has_country_flag = is_releasing_trade_outpost
		}
		clr_country_flag = is_releasing_trade_outpost
	}
	if = {
		limit = {
			has_country_flag = selected_trade_outpost_region_south_china_region
		}
		clr_country_flag = selected_trade_outpost_region_south_china_region
	}
	if = {
		limit = {
			has_country_flag = selected_trade_outpost_region_north_china_region
		}
		clr_country_flag = selected_trade_outpost_region_north_china_region
	}
	if = {
		limit = {
			has_country_flag = selected_trade_outpost_region_korea_region
		}
		clr_country_flag = selected_trade_outpost_region_korea_region
	}
	if = {
		limit = {
			has_country_flag = selected_trade_outpost_region_japan_region
		}
		clr_country_flag = selected_trade_outpost_region_japan_region
	}
	if = {
		limit = {
			has_country_flag = selected_trade_outpost_area_liaoning_area
		}
		clr_country_flag = selected_trade_outpost_area_liaoning_area
	}
}

# Audax Validator "!" Ignore_1006
set_overlord_idea_groups = {
	# Tech Group and Unit Type
	if = {
		limit = {
			overlord = {
			    technology_group = western
			}
		}
		change_technology_group = western
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = dutch_tech_group
			}
		}
		change_technology_group = dutch_tech_group
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = english_tech_group
			}
		}
		change_technology_group = english_tech_group
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = french_tech_group
			}
		}
		change_technology_group = french_tech_group
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = german_tech_group
			}
		}
		change_technology_group = german_tech_group
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = italian_tech_group
			}
		}
		change_technology_group = italian_tech_group
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = portuguese_tech_group
			}
		}
		change_technology_group = portuguese_tech_group
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = roman_tech_group
			}
		}
		change_technology_group = roman_tech_group
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = scandinavian_tech_group
			}
		}
		change_technology_group = scandinavian_tech_group
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = spanish_tech_group
			}
		}
		change_technology_group = spanish_tech_group
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = swiss_tech_group
			}
		}
		change_technology_group = swiss_tech_group
		change_unit_type = western
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = high_american
			}
		}
		change_technology_group = high_american
		change_unit_type = high_american
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = andean
			}
		}
		change_technology_group = andean
		change_unit_type = south_american
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = south_american
			}
		}
		change_technology_group = south_american
		change_unit_type = south_american
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = mesoamerican
			}
		}
		change_technology_group = mesoamerican
		change_unit_type = mesoamerican
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = north_american
			}
		}
		change_technology_group = north_american
		change_unit_type = north_american
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = sub_saharan
			}
		}
		change_technology_group = sub_saharan
		change_unit_type = sub_saharan
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = nomad_group
			}
		}
		change_technology_group = nomad_group
		change_unit_type = nomad_group
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = chinese
			}
		}
		change_technology_group = chinese
		change_unit_type = chinese
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = central_african
			}
		}
		change_technology_group = central_african
		change_unit_type = sub_saharan
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = east_african
			}
		}
		change_technology_group = east_african
		change_unit_type = sub_saharan
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = indian
			}
		}
		change_technology_group = indian
		change_unit_type = indian
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = muslim
			}
		}
		change_technology_group = muslim
		change_unit_type = muslim
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = ottoman
			}
		}
		change_technology_group = ottoman
		change_unit_type = ottoman
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = persian_tech_group
			}
		}
		change_technology_group = persian_tech_group
		change_unit_type = ottoman
	}
	else_if = {
		limit = {
			overlord = {
			    technology_group = eastern
			}
		}
		change_technology_group = eastern
		change_unit_type = eastern
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = bohemian_tech_group
			}
		}
		change_technology_group = bohemian_tech_group
		change_unit_type = eastern
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = byzantine_tech_group
			}
		}
		change_technology_group = byzantine_tech_group
		change_unit_type = eastern
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = hungarian_tech_group
			}
		}
		change_technology_group = hungarian_tech_group
		change_unit_type = eastern
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = polish_tech_group
			}
		}
		change_technology_group = polish_tech_group
		change_unit_type = eastern
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = russian_tech_group
			}
		}
		change_technology_group = russian_tech_group
		change_unit_type = eastern
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = bulgarian_tech_group
			}
		}
		change_technology_group = bulgarian_tech_group
		change_unit_type = eastern
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = aboriginal_tech
			}
		}
		change_technology_group = aboriginal_tech
		change_unit_type = aboriginal_tech
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = polynesian_tech
			}
		}
		change_technology_group = polynesian_tech
		change_unit_type = polynesian_tech
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = muslim
			}
		}
		change_technology_group = muslim
		change_unit_type = muslim
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = indian
			}
		}
		change_technology_group = indian
		change_unit_type = indian
	}
	else_if = {
		limit = {
			overlord = {
				technology_group = nomad_group
			}
		}
		change_technology_group = nomad_group
		change_unit_type = nomad_group
	}
	else = {
		change_technology_group = western
		change_unit_type = western
	}

	# National Ideas
	swap_free_idea_group = yes

	# Power
	add_adm_power = 999
	add_dip_power = 999
	add_mil_power = 999

	# Ideas
	if = {
		limit = {
			is_year = 1300
			NOT = { has_global_flag = idea_variation_voting_started }
			NOT = { has_global_flag = idea_changing_mod_active }
			NOT = { is_expanded_mod_active = { mod = idea_groups } }
		}
		add_idea_group = expansion_ideas
		remove_idea_group = expansion_ideas
		add_idea_group = expansion_ideas
		add_idea = additional_colonists
		add_idea = additional_merchants
		add_idea = faster_colonists
		add_idea = factories
		add_idea = additional_diplomats
		add_idea = general_colonization_law
		add_idea = competetive_merchants
		add_idea_group = trade_ideas
		remove_idea_group = trade_ideas
		add_idea_group = trade_ideas
		add_idea = shrewd_commerce_practise
		add_idea = free_trade
		add_idea = merchant_adventures
		add_idea = national_trade_policy
		add_idea = overseas_merchants
		add_idea = trade_manipulation
		add_idea = fast_negotiations
		add_idea_group = quantity_ideas
		remove_idea_group = quantity_ideas
		add_idea_group = quantity_ideas
		add_idea = mass_army
		add_idea = the_young_can_serve
		add_idea = enforced_service
		add_idea = the_old_and_infirm
		add_idea = camp_followers
		#add_idea = garrison_conscription
		add_idea = expanded_supply_trains
	}
}

# to make sure the ET flag is set, we use this scripted effect
# empty definition here, in case ET is not active
#et_setup_effect = {
#}